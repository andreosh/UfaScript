// Библиотека Уфа-Скрипт версия 3.8 от 17.07.2017 
// предназначена для языка программирования OneScript 
// (c) Ошнуров Андрей Михайлович г.Уфа  UfaScript@mail.ru

// -------------  переменные --------------------------------------------------------
//  Экран - массив сегментов на экране
//  АктОбъекты  - Активные объекты на экране.
//  НомАктОбъекта - Номер текущего объекта
//  Консоль - указатель на текущую консоль
//  ГлобПерем - для пользователей библиотеокой. Определяйте свои переменные ГлобПерем.Вставить("НовПерем", 0)
//  Кл - Структура с кодами клавиш для удобства (Кл.Влево, Кл.Вправо, Кл.Вверх и т.д.)

Перем Экран экспорт;  Перем АктОбъекты; Перем НомАктОбъекта;  Перем РежимГруппы;
Перем Консоль экспорт;  Перем МассивКоординат;  Перем ГлобПерем; Перем Кл;
Перем КаталогЗапуска экспорт; Перем КаталогВременныхФайлов экспорт;  Перем PHPФункции экспорт;
//---- Переменные для формирования index.php -----------------------------------
Перем Запись экспорт; 
//---- Переменные для сервера-транслятора -----------------------------------
Перем МассивОтветовКлиентам экспорт; Перем МассивЗапросовОтКлиентов экспорт; Перем МассивОтложенныхЗапросовОтКлиентов экспорт; Перем МассивАктивныхКлиентов экспорт;
Перем ЗадержкаВOneScript экспорт; Перем ЗадержкаВPHPСервере экспорт; Перем ЗадержкаВJSКлиенте экспорт;


//?Вызов: ВерсияUfascript(Вид)
//?Параметры: Вид (ч) =1 Возвращает номер версии, =2 Возвращает дату версии, =3 - Номер и дата версии библиотеки UfaScript.osb
//?Описание: Возврат строки версии библиотеки UfaScript.osb
//?Поиск: Инфо 
Функция ВерсияUfascript(Вид)  экспорт
   Версия = "3.8"; ДатаВерсии="17.07.2017";
   Если      Вид=1 Тогда Возврат Версия;   ИначеЕсли Вид=2 Тогда Возврат ДатаВерсии;
   ИначеЕсли Вид=3 Тогда Возврат Версия+" от "+ДатаВерсии;   КонецЕсли;   Возврат Версия+" от "+ДатаВерсии;
КонецФункции

//Имя: Консоль_Вывести(Знач Т, Знач В, Знач Ш)
//Описание: Вывод в консольный интерфейс текста Т по координатам В и Ш
//Категория: Консоль Вывод 
Процедура Консоль_Вывести(Знач Т, Знач В, Знач Ш)   экспорт
	Консоль.КурсорВерх = В;	Консоль.КурсорЛево = Ш;	Консоль.Вывести(Т);
КонецПроцедуры

//Имя: Консоль_УстановитьЦветФонаИТекста(Знач Ф, Знач Т)
//Описание: Установит цвет фона и цвет текста в консольном интерфейсе
//Категория: Консоль Вывод 
Процедура Консоль_УстановитьЦветФонаИТекста(Знач Ф, Знач Т)  экспорт
    Консоль.ЦветФона = Ф;     Консоль.ЦветТекста = Т;
КонецПроцедуры

//Имя: СоздатьСтрокуСимволов(Знач С = " ", К)
//Описание: Создать Строку Символов С длинной K
//Категория: Строка 
Функция СоздатьСтрокуСимволов(Знач С = " ", К)  экспорт
     Стр = "";    Для сч1 = 1 По К Цикл   Стр = Стр+С;   КонецЦикла; 	    Возврат Стр;	  
КонецФункции

//Имя: ОбновитьЭкран()
//Описание: Вывод всех зарегистрированных на экране сегментов 
//Категория: Консоль Вывод Устарело 
Процедура ОбновитьЭкран()  экспорт
   	Для Сч = 0 По Экран.Количество() - 1 Цикл    ВывестиСегмент(Экран[Сч]); 	КонецЦикла;
КонецПроцедуры

//Имя: СегментОбъект(Знач Н = 0, Знач В = 0, Знач Л = 0,  Знач С = " ")
//Описание: Создание сегмента для вывода на экран консоли 
//Категория: Консоль Вывод Устарело 
Функция СегментОбъект(Знач Н = 0, Знач В = 0, Знач Л = 0,  Знач С = " ")  экспорт
	О = Новый Структура();
	О.Вставить("Направление", Н);	О.Вставить("Лево", Л);	О.Вставить("Верх", В);
	О.Вставить("Символ", С); 	О.Вставить("ЦветФона", 0);	О.Вставить("ЦветТекста", 0);
	О.Вставить("Длина", СтрДлина(О.Символ)); 
	Возврат О;
КонецФункции

//Имя: ПолучитьАктивныйСегментПоНомеру(Знач Ном)
//Описание: Получить ссылку на Активный Сегмент По указанному Номеру 
//Категория: Консоль Вывод Устарело 
Функция ПолучитьАктивныйСегментПоНомеру(Знач Ном)   экспорт
   Возврат Экран[АктОбъекты[Ном]];
КонецФункции

//Имя: УстановитьЦветФонаИТекстаАктОбъекта(Знач Ф, Знач Т)
//Описание: Установить Цвет Фона Ф и цвет Текста Т Активного Объекта 
//Категория: Консоль Вывод Устарело 
Процедура УстановитьЦветФонаИТекстаАктОбъекта(Знач Ф, Знач Т)   экспорт
    УстановитьЦветФонаИТекстаСегмента(Экран[АктОбъекты[НомАктОбъекта]], Ф, Т)
КонецПроцедуры

//Имя: УстановитьЦветФонаИТекстаСегмента(Знач С, Знач Ф, Знач Т)
//Описание: Установить Цвет Фона Ф, цвет Текста Т Сегмента и вывести сегмент на экран  
//Категория: Консоль Вывод Устарело 
Процедура УстановитьЦветФонаИТекстаСегмента(Знач С, Знач Ф, Знач Т)   экспорт
    С.ЦветФона = Ф;     С.ЦветТекста = Т;
	ВывестиСегмент(С);
КонецПроцедуры

//Имя: Отладка(Y,X,С)
//Описание: Вывести текст С в консоль по координатам X и Y   
//Категория: Консоль Вывод Устарело 
Процедура Отладка(Y,X,С)   экспорт
	Консоль.КурсорВерх = Y;	Консоль.КурсорЛево = X;   Консоль.Вывести(С); 
КонецПроцедуры

//Имя: ВывестиСегмент(Знач С)
//Описание: Вывести сегмент С на экран   
//Категория: Консоль Вывод Устарело 
Процедура ВывестиСегмент(Знач С)   экспорт
	Консоль.КурсорВерх = С.Верх;	Консоль.КурсорЛево = С.Лево;
    Если С.ЦветФона <> 0 Тогда	ЦФ = Консоль.ЦветФона;	Консоль.ЦветФона = С.ЦветФона;	КонецЕсли;
    Если С.ЦветТекста <> 0 Тогда  ЦТ = Консоль.ЦветТекста;   Консоль.ЦветТекста = С.ЦветТекста;	КонецЕсли;
    Если С.Направление > -1 Тогда Консоль.Вывести(С.Символ); КонецЕсли;
    Если С.ЦветФона <> 0 Тогда	   Консоль.ЦветФона = ЦФ;	КонецЕсли;
    Если С.ЦветТекста <> 0 Тогда   Консоль.ЦветТекста = ЦТ;	КонецЕсли;
КонецПроцедуры

//Имя: ДобавитьСегментВМассив(Знач Сегмент)
//Описание: Добавить Сегмент В Массив Экрана (регистрация сегмента на экране)  
//Категория: Консоль Вывод Устарело 
Функция ДобавитьСегментВМассив(Знач Сегмент)  
    Для Сч = 1 По Экран.Количество() - 1 Цикл
	  Если Экран[Сч].Направление < 0 Тогда  Экран[Сч] = Сегмент; Возврат Сч;   КонецЕсли;		 
    КонецЦикла;    ВывестиСегмент(Сегмент);
    Экран.Добавить(Сегмент);     Возврат Сч; 	  // Номер добавленной строки в экране
КонецФункции

//Имя: ПолучитьЦветФонаОбъекта(Знач K)
//Описание: Получить Цвет Фона Объекта по порядковому номеру регистрации на экране  
//Категория: Консоль Вывод Устарело 
Функция ПолучитьЦветФонаОбъекта(Знач K)
   Возврат Экран[ГлобПерем.Координаты[K][0]].ЦветФона;
КонецФункции

//Имя: УстановитьЦветФонаИТекстаВЦикле(Знач НомераСтрок, Знач Ф, Знач Т)
//Описание: Установить цвет фона и цвет текста в цикле для группы сегментов с номерами перечисленными в массиве НомераСтрок
//Категория: Консоль Вывод Устарело 
Процедура УстановитьЦветФонаИТекстаВЦикле(Знач НомераСтрок, Знач Ф, Знач Т)
   Для сч = 0 По НомераСтрок.Количество()-1 Цикл Экран[НомераСтрок[сч]].ЦветФона = Ф; 
   Экран[НомераСтрок[сч]].ЦветТекста = Т; ВывестиСегмент(Экран[НомераСтрок[сч]]); КонецЦикла;	  
КонецПроцедуры

//Имя: ДобавитьМногоСтрокВМассивСегментов(Знач МассивТекста, Знач Сегмент)
//Описание: Создать группу сегментов из массива МассивТекста, Начальные координаты заданы в Сегмент 
//Категория: Консоль Вывод Устарело 
Функция ДобавитьМногоСтрокВМассивСегментов(Знач МассивТекста, Знач Сегмент);
    Н = Новый Массив;   
	Для Сч = 0 По МассивТекста.Количество() - 1 Цикл
	   Об = СегментОбъект(Сегмент.Направление, Сегмент.Верх+Сч, Сегмент.Лево, МассивТекста[Сч]); 
	   Н.Добавить(ДобавитьСегментВМассив(Об));
    КонецЦикла;    
    Возврат	Н;   // Массив номеров строк в экране
КонецФункции

//Имя: ВЭкранМассивСтрокВЦвете(Знач М, Знач В, Знач Ш, Знач ЦФ, Знач ЦТ)
//Описание: Вывести на экран сегменты сформированные из массива М по координате В Ш в цвете ЦФ ЦТ 
//Категория: Консоль Вывод Устарело 
Функция ВЭкранМассивСтрокВЦвете(Знач М, Знач В, Знач Ш, Знач ЦФ, Знач ЦТ) экспорт
     С = СегментОбъект(0, В, Ш, " ");	
	 Н = ДобавитьМногоСтрокВМассивСегментов(М, С);
	УстановитьЦветФонаИТекстаВЦикле(Н, ЦФ, ЦТ);   
 Возврат Н; // Массив номеров строк
КонецФункции

//Имя: УдалитьОбъект(Знач Об)
//Описание: Скрыть объект с экрана, пометив его на удаление (Направление = -1)
//Категория: Консоль Вывод Устарело 
Процедура УдалитьОбъект(Знач Об)
   Для сч=0 По Об.Количество()-1 Цикл
      Экран[Об[сч]].Направление = -1;
   КонецЦикла;
КонецПроцедуры

//Имя: ПоменятьЦветФонаОбъекта(Знач МассивНом, Знач Ф)
//Описание: Поменять цвет фона списка сегментов, номера которых указаны в массиве МассивНом 
//Категория: Консоль Вывод Устарело 
Процедура ПоменятьЦветФонаОбъекта(Знач МассивНом, Знач Ф)
   Для сч = 0 По МассивНом.Количество()-1 Цикл
      Экран[МассивНом[сч]].ЦветФона = Ф;	   ВывестиСегмент(Экран[МассивНом[сч]]);
   КонецЦикла;
КонецПроцедуры

//Имя: ПоменятьЦветТекстаОбъекта(Знач МассивНом, Знач Ф)
//Описание: Поменять цвет текста списка сегментов, номера которых указаны в массиве МассивНом 
//Категория: Консоль Вывод Устарело 
Процедура ПоменятьЦветТекстаОбъекта(Знач МассивНом, Знач Ф)  экспорт
   Для сч = 0 По МассивНом.Количество()-1 Цикл
       Экран[МассивНом[сч]].ЦветТекста = Ф;	   ВывестиСегмент(Экран[МассивНом[сч]]);
   КонецЦикла;
КонецПроцедуры

//Имя: НарисоватьРамкуНаВесьЭкран()
//Описание: Задать желтый фон экрана консоли и нарисовать рамку из звездочек 
//Категория: Консоль Вывод Устарело 
Процедура НарисоватьРамкуНаВесьЭкран() экспорт
    С = СоздатьСтрокуСимволов("*",Консоль.Ширина);    С2 = "*"+СоздатьСтрокуСимволов(" ",Консоль.Ширина-2)+"*";
	М = Новый Массив;    М.Добавить(С);
   	Для Сч = 1 По Консоль.Высота - 4 Цикл      М.Добавить(С2);	КонецЦикла;
    М.Добавить(С);    
    Т = ВЭкранМассивСтрокВЦвете(М, 0, 0, ЦветКонсоли.Желтый, ЦветКонсоли.Красный);
КонецПроцедуры

//Имя: ФлагРоссии(Знач Сегмент)
//Описание: Нарисовать флаг России 
//Категория: Консоль Вывод Устарело 
Функция ФлагРоссии(Знач Сегмент)  экспорт
    C = СегментОбъект(0,3,3,"        "); C.ЦветФона = ЦветКонсоли.Белый; ДобавитьСегментВМассив(C);
    C = СегментОбъект(0,4,3," РОССИЯ "); C.ЦветФона = ЦветКонсоли.Синий; C.ЦветТекста = ЦветКонсоли.Красный;  ДобавитьСегментВМассив(C);
    C = СегментОбъект(0,5,3,"        "); C.ЦветФона = ЦветКонсоли.Красный;  ДобавитьСегментВМассив(C);
КонецФункции

//Имя: ВопросДаНетВыходИзПрограммы()
//Описание: Высветить в консоль модальное окно ДаНет для выхода из программы  
//Категория: Консоль Вывод Устарело 
Функция ВопросДаНетВыходИзПрограммы()  экспорт
   M = Новый Массив;    В = Консоль.Высота/2-10;  Ш = Консоль.Ширина/2-20;
                      M.Добавить("+------------------------------+");
                      M.Добавить("|Вы хотите выйти из программы ?|");
   Для сч=0 По 2 Цикл M.Добавить("|                              |"); КонецЦикла;
                      M.Добавить("+------------------------------+");
    Если МодальноеОкноСВопросомДаНет(M, В, Ш) Тогда Возврат Истина; КонецЕсли;
	Возврат Ложь;
КонецФункции

Функция МодальноеОкноСВопросомДаНет(Знач M, В, Ш)  экспорт
   K = M.Количество();
   Текст = ВЭкранМассивСтрокВЦвете(M, В, Ш, ЦветКонсоли.Зеленый, ЦветКонсоли.Синий);
   СДа = СегментОбъект(0, В+K-2, Ш+5, "<Да>");    
   УстановитьЦветФонаИТекстаСегмента(СДа,  ЦветКонсоли.Желтый, ЦветКонсоли.Синий);
   СНет = СегментОбъект(0, В+K-2, Ш+15, "<Нет>");    
   УстановитьЦветФонаИТекстаСегмента(СНет,  ЦветКонсоли.Серый, ЦветКонсоли.Синий);
	Клавиша = Консоль.Прочитать();   Рез = 0;
	Пока Клавиша <> Кл.Ввод Цикл 
	   Если      Клавиша = Кл.Влево Тогда 
	      УстановитьЦветФонаИТекстаСегмента(СНет, ЦветКонсоли.Серый,  ЦветКонсоли.Синий);
	      УстановитьЦветФонаИТекстаСегмента(СДа,  ЦветКонсоли.Желтый, ЦветКонсоли.Синий);
		  Рез = 0;
       ИначеЕсли Клавиша = Кл.Вправо Тогда
	      УстановитьЦветФонаИТекстаСегмента(СНет, ЦветКонсоли.Желтый, ЦветКонсоли.Синий);
	      УстановитьЦветФонаИТекстаСегмента(СДа,  ЦветКонсоли.Серый,  ЦветКонсоли.Синий);
		  Рез = 1;
	   КонецЕсли;
	  Клавиша = Консоль.Прочитать();	
    КонецЦикла;
    Если Рез=1 Тогда УдалитьОбъект(Текст);  ОбновитьЭкран(); Возврат Истина; КонецЕсли;
    ОбновитьЭкран();    Возврат Ложь;
КонецФункции

//Имя: ДобавитьПолеРедактирования(Знач Текст, Знач Высота, Знач Лево, Знач Группа)
//Описание: Высветить поле редактирования в консоле  
//Категория: Консоль Вывод Устарело 
Процедура ДобавитьПолеРедактирования(Знач Текст, Знач Высота, Знач Лево, Знач Группа)  экспорт
   С = СегментОбъект(0, Высота, Лево, Текст);    
   УстановитьЦветФонаИТекстаСегмента(С,  ЦветКонсоли.Белый, ЦветКонсоли.Серый);
   АктОбъекты_Добавить(Группа,ДобавитьСегментВМассив(С));
КонецПроцедуры

//Имя: АктОбъекты
//Описание: Набор процедур для работы с активными (реагирующими на нажатия) сегментами (использовалось до создания ООП в OneScript)  
//Категория: Консоль Вывод Устарело 
Функция АктОбъектыНайтиГруппу(Знач ИмяГруп)
   Для сч = 0 По 27 Цикл
       Если АктОбъекты[сч] = ИмяГруп  Тогда
	      Возврат сч;
       КонецЕсли;   
   КонецЦикла;
   Возврат -1;
КонецФункции

Функция АктОбъектыКонецГруппы()
   Для сч = 3 По 27 Цикл
       Если АктОбъекты[сч] = "КонецСпискаГрупп"  Тогда
	      Возврат сч;
       КонецЕсли;   
   КонецЦикла;
   Возврат 0;
КонецФункции

Процедура СоздатьАктГруппу(Знач Наим)
   Если АктОбъекты.Количество() < 1 Тогда
        АктОбъекты.Добавить(Наим);
		Для сч = 1 По 30 Цикл  АктОбъекты.Добавить(0);  КонецЦикла;
		АктОбъекты[1] = 0;        // Количество в группе
	    АктОбъекты[2] = 31;      // Начальная позиция группы
		АктОбъекты[3] = "КонецСпискаГрупп";
   ИначеЕсли АктОбъекты.Количество() > 0 Тогда
      K = АктОбъектыКонецГруппы();
      Если K > 2  Тогда
        АктОбъекты[K] = Наим;
	    АктОбъекты[K+1] = 0;
	    АктОбъекты[K+2] = АктОбъекты[K-2]+АктОбъекты[K-1];
	    АктОбъекты[K+3] = "КонецСпискаГрупп";
      КонецЕсли;
    КонецЕсли;	 
КонецПроцедуры


Функция АктОбъекты_Добавить(Знач ИмяГруп, Знач Объект)
   K = АктОбъектыНайтиГруппу(ИмяГруп);
   Если K<0 Тогда
      Сообщить("Группа <"+ИмяГруп+"> при добавлении в АктОбъекты не найдена");
	  Клавиша = Консоль.Прочитать();
	  Возврат 0;
   КонецЕсли;
   Если АктОбъекты[K+3] = "КонецСпискаГрупп" Тогда
      АктОбъекты.Добавить(Объект);
      АктОбъекты[K+1] = АктОбъекты[K+1]+1;
	  Возврат АктОбъекты.Количество()-1;
   КонецЕсли;   
   Сообщить("Группа "+ИмяГруп+" является не последней. Добавлять объекты нельзя.");
   Возврат 0;
КонецФункции

Функция АктОбъекты_Позиция(Знач ИмяГруп)
   K = АктОбъектыНайтиГруппу(ИмяГруп);
   Если K<0 Тогда
      Сообщить("Группа <"+ИмяГруп+"> при считывании Позиции в АктОбъекты не найдена");
	  Клавиша = Консоль.Прочитать();	  Возврат -1;
   КонецЕсли;
   Возврат АктОбъекты[K+2];
КонецФункции

Функция АктОбъекты_Количество(Знач ИмяГруп)
   K = АктОбъектыНайтиГруппу(ИмяГруп);
   Если K<0 Тогда
      Сообщить("Группа <"+ИмяГруп+"> при считывании Количество в АктОбъекты не найдена");
	  Клавиша = Консоль.Прочитать();	  Возврат -1;
   КонецЕсли;
   Возврат АктОбъекты[K+1];
КонецФункции

Функция АктОбъекты_УдалитьПоследнююЗапись()
   Если АктОбъекты.Количество() < 1 Тогда      Возврат 0;   КонецЕсли;
   K = АктОбъектыКонецГруппы();
   Если АктОбъекты[K-2]>0 Тогда
      АктОбъекты.Удалить(АктОбъекты.Количество()-1);
      АктОбъекты[K-2] = АктОбъекты[K-2]-1;   Возврат АктОбъекты[K-2];
   КонецЕсли;
КонецФункции

Функция АктОбъекты_ВПоследнейЗаписиОставитьNЗаписей(Знач N)
   Если АктОбъекты.Количество() < 1 Тогда      Возврат 0;   КонецЕсли;
   K = АктОбъектыКонецГруппы();
   Пока АктОбъекты[K-2]>N Цикл
      АктОбъекты_УдалитьПоследнююЗапись();
   КонецЦикла;
КонецФункции

Функция ПроверкаКнопокНаКрайние(Знач Груп, Знач Напр)   экспорт
   П = АктОбъекты_Позиция(Груп);
   Если НомАктОбъекта = П+АктОбъекты_Количество(Груп)-1 И Напр = 1 Тогда Напр = 0;  КонецЕсли;
   Если НомАктОбъекта = П И Напр = -1 Тогда Напр = 0;  КонецЕсли;  Возврат Напр;
КонецФункции

Процедура ДляОтладки_ПрисвоитьСимволВОбъект(Объект,Сим)    экспорт
   Экран[Объект[0]].Символ = Сим;     ВывестиСегмент(Экран[Объект[0]]); 
КонецПроцедуры

//?Вызов: БазовыеУстановкиСистемыUfaScript()
//?Параметры: отсутствуют
//?Описание: БазовыеУстановкиСистемы для прочих неконсольных приложений
//?Поиск: 
Процедура БазовыеУстановкиСистемыUfaScript() экспорт
   КаталогЗапуска = ТекущийКаталог();  КаталогВременныхФайлов=КаталогЗапуска; 
КонецПроцедуры

//?Вызов: НачальныеУстановкиСистемыUfaScript(Знач В, Знач Ш) 
//?Параметры: В - минимально допустимая высота консоли, Ш - минимально допустимая ширина консоли для
//?Далее:         корректного вывода экрана
//?Описание: Инициализация библиотеки UfaScript. Задание минимального размера консоли В-высота Ш-ширина
//?Далее:       для консольных приложений
//?Поиск: Консоль Вывод
Процедура НачальныеУстановкиСистемыUfaScript(Знач В, Знач Ш) экспорт
   Экран = Новый Массив;      НомАктОбъекта = 0;   АктОбъекты = Новый Массив;   Консоль = Новый Консоль();
   Консоль.ВидимостьКурсора(Ложь);   ГлобПерем = Новый Структура();  БазовыеУстановкиСистемыUfaScript();
   Если Консоль.Ширина < Ш Тогда
       Сообщить("Данная программа не может правильно отображать данные при ширине консоли < "+Ш+
	       ". Текущая ширина консоли "+Консоль.Ширина+" Текущая высота консоли "+Консоль.Высота);
      Консоль.Прочитать();  ЗавершитьРаботу(1);
   КонецЕсли;
   Если Консоль.Высота < В Тогда
       Сообщить("Данная программа не может правильно отображать данные работать при высоте консоли < "+В+
	     ". Текущая высота консоли "+Консоль.Высота+" Текущая ширина консоли "+Консоль.Ширина);
	  Консоль.Прочитать();	    ЗавершитьРаботу(1);
   КонецЕсли;
   Кл = Новый Структура(); Кл.Вставить("Влево",37); Кл.Вставить("Вправо",39); Кл.Вставить("Вниз",40);
   Кл.Вставить("Вверх",38); Кл.Вставить("Ввод",13);  Кл.Вставить("Таб",9);
   Кл.Вставить("Q",81);  Кл.Вставить("A",65);  Кл.Вставить("Z",90); Кл.Вставить("W",87); Кл.Вставить("S",83);
   Кл.Вставить("X",88);  Кл.Вставить("E",69);  Кл.Вставить("R",82); Кл.Вставить("T",84); Кл.Вставить("D",68);
   Кл.Вставить("F",70);  Кл.Вставить("G",71);  Кл.Вставить("Y",89); Кл.Вставить("U",85); Кл.Вставить("I",73);
   Кл.Вставить("H",72);  Кл.Вставить("J",74);  Кл.Вставить("K",75); Кл.Вставить("ESC",27); 
КонецПроцедуры

//?Вызов: ГенерацияСлучайногоЧисла(Знач Макс, Знак) 
//?Параметры: Макс - максимальное значение числа, Знак
//?Описание: Генерация случайного числа. Взято из примера игры "Змейка"
//?Поиск: Системная 
Функция ГенерацияСлучайногоЧисла(Знач Макс, Знак)  экспорт
	Медиана = Цел(Макс/2);	Секунда = Секунда(ТекущаяДата());
	Результат = Медиана + (Секунда * Знак);
	Если Результат < 0 Тогда	Результат = Результат * -1; 	КонецЕсли;
	Если Результат > Макс Тогда		Результат = Результат - Макс;	КонецЕсли;
	Знак = -Знак;	Возврат Результат;
КонецФункции

//?Вызов: СоздатьСтруктуруСПеременнымиСреды()
//?Параметры: отсутствуют
//?Описание: Считывает переменные системного окружения в структуру
//?Поиск: Системная 
Функция СоздатьСтруктуруСПеременнымиСреды()
   С = Новый Структура();   СИ = Новый СистемнаяИнформация();
   Для Каждого Переменная Из СИ.ПеременныеСреды() Цикл
      С.Вставить(Переменная.Ключ, Переменная.Значение);
   КонецЦикла;   Возврат С;
КонецФункции

//?Вызов: СоздатьМассивСПеременнымиСреды()
//?Параметры: отсутствуют
//?Описание: Создает текстовый массив с переменными системного окружения
//?Поиск: Системная 
Функция СоздатьМассивСПеременнымиСреды()  экспорт
   М = Новый Массив;   СИ = Новый СистемнаяИнформация();
   Для Каждого Переменная Из СИ.ПеременныеСреды() Цикл
      М.Добавить(Переменная.Ключ+" ="+Переменная.Значение);
   КонецЦикла;      Возврат М;
КонецФункции

//?Вызов: ВывестиФайл(Знач ИмяФайла)
//?Параметры: ИмяФайла
//?Описание: Выводит на экран содержимое текстового файла.
//?Поиск: Файл 
Процедура ВывестиФайл(Знач ИмяФайла)   экспорт
	Файл = Новый Файл(ИмяФайла);
	Если Файл.Существует() Тогда
		Чтение = Новый ЧтениеТекста(Файл.ПолноеИмя);
		Сообщение = Чтение.Прочитать();		Сообщить(Сообщение);		Чтение.Закрыть();
	КонецЕсли;
КонецПроцедуры

//?Вызов: ФайлСуществует(Знач ИмяФайла)
//?Параметры: ИмяФайла
//?Описание: Проверяет существует ли файл.
//?Поиск: Файл 
Функция ФайлСуществует(Знач ИмяФайла)  экспорт
	Файл = Новый Файл(ИмяФайла);
	Если Файл.Существует() Тогда Возврат Истина; КонецЕсли;
    Возврат Ложь;
КонецФункции

//?Вызов: СоздатьИЗаписатьФайл(ИмяФайла,Знач М = Неопределено)
//?Параметры: ИмяФайла, М - массив строк
//?Описание: Создать файл и записать в него строки из массива разделенные пробелом  
//?Поиск: Файл Текст Массив
Процедура СоздатьИЗаписатьФайл(ИмяФайла,Знач М = Неопределено)   экспорт
  Ф = Новый ЗаписьТекста;  Ф.Открыть(ИмяФайла);
  Если НЕ М = Неопределено Тогда
     Для сч=0 По М.Количество()-1 Цикл   Ф.ЗаписатьСтроку(М[сч]+" "); КонецЦикла;  
  КонецЕсли;    Ф.Закрыть();  
КонецПроцедуры

//?Вызов: ЗаменитьТабНаПробелы(М)
//?Параметры: М - массив строк
//?Описание: Заменить в массиве символы табуляции на 4 пробела.  
//?Поиск: Текст Массив
Функция ЗаменитьТабНаПробелы(М)
  Для сч=0 По М.Количество()-1 Цикл М[сч]=СтрЗаменить(М[сч],Символ(9),"        "); КонецЦикла;
  Длина=ОпределитьМаксДлинуСтрокиВМассиве(М);
  Для сч=0 По М.Количество()-1 Цикл Д=Длина-СтрДлина(М[сч]);  Если Д>0 Тогда
    	М[сч]=М[сч]+СоздатьСтрокуСимволов(" ",Д);  КонецЕсли;  КонецЦикла;  Возврат М;  
КонецФункции

//?Вызов: ОпределитьМаксДлинуСтрокиВМассиве(М)
//?Параметры: М - массив строк
//?Описание: Определить максимальную длину в массиве строк.  
//?Поиск: Текст Массив
Функция ОпределитьМаксДлинуСтрокиВМассиве(М) экспорт
   Длина = 0;   Для сч=0 По М.Количество()-1 Цикл  Д=СтрДлина(СтрЗаменить(М[сч],Символ(9),"        ")); 
   Если Д>Длина Тогда   Длина=Д;  КонецЕсли;  КонецЦикла;  Возврат Длина;
КонецФункции

//?Вызов: ЗагрузитьСтрокиИзФайлаВМассив(Имя)
//?Параметры: Имя - имя текстового файла
//?Описание: Загрузить Строки Из Файла В Массив. 
//?Поиск: Текст Массив
Функция ЗагрузитьСтрокиИзФайлаВМассив(Имя)  экспорт
  М = Новый Массив;  Чтение = Новый ЧтениеТекста(Имя,КодировкаТекста.UTF8);  Стр=Чтение.ПрочитатьСтроку();  Пока Стр <> Неопределено  Цикл   
     М.Добавить(Стр);  Стр=Чтение.ПрочитатьСтроку(); КонецЦикла; Чтение.Закрыть();	Возврат М;  
КонецФункции

//?Вызов: ЗаписатьТекстВФайл(ИмяФайла,Текст1)
//?Параметры: ИмяФайла - имя текстового файла, Текст1 - записываемый текст
//?Описание: Записать Текст В Файл. 
//?Поиск: Текст
Функция ЗаписатьТекстВФайл(ИмяФайла,Текст1) Экспорт
   Текст=Новый ЗаписьТекста(ИмяФайла);   Текст.Записать(Текст1);   Текст.Закрыть();
КонецФункции

//?Вызов: ЧитатьТекстИзФайла(ИмяФайла)
//?Параметры: ИмяФайла - имя текстового файла
//?Описание: Считать содержимое файла в текстовое поле
//?Поиск: Текст
Функция ЧитатьТекстИзФайла(ИмяФайла)  экспорт
   Чтение=Новый ЧтениеТекста(ИмяФайла); 
   Если НЕ Чтение.Существует() Тогда ВызватьИсключение "Файл не найден. Имя файла "+ИмяФайла; КонецЕсли;    
   Текст1 = Чтение.Прочитать();   Чтение.Закрыть();  Возврат Текст1;
КонецФункции

//?Вызов: ВызватьФункцию(Функ,Где)
//?Параметры: Функ - имя вызываемой функции, Где - ссылка на модуль в котором находится вызываемая функция
//?Описание: Вызвать внешнюю функцию с именем Функ, которая находится в модуле Где.
//?Поиск: OneScript ООП
Функция ВызватьФункцию(Функ,Где) экспорт
 	 М = Новый Массив;    М.Добавить("Возврат ТотОбъект."+Функ+";");  	 Возврат ВыполнитьКодИзМассива(М,Где);
КонецФункции

//?Вызов: ВыполнитьКодИзМассива(М,Где)
//?Параметры: М-массив строк методов и переменных объекта (массив-образ), Где - ссылка на модуль в котором выполнять сценарий
//?Описание: Выполнить записанный в строковом массиве код OneScript 
//?Поиск: OneScript ООП
Функция ВыполнитьКодИзМассива(М,Где)   экспорт
   М1 = Новый Массив;   
   М1.Добавить("Перем ТотОбъект;");
   М1.Добавить("Функция Результат() экспорт ");
   Для сч=0 По М.Количество()-1 Цикл      М1.Добавить(М[сч]);   КонецЦикла;
   М1.Добавить("КонецФункции");
   М1.Добавить("Функция ТомуОбъекту(Тот) экспорт ТотОбъект=Тот; КонецФункции");
   СоздатьИЗаписатьФайл(КаталогВременныхФайлов+"\Выполнение.osm",М1);
   С = ЗагрузитьСценарий(КаталогВременныхФайлов+"\Выполнение.osm");   С.ТомуОбъекту(Где);
   Возврат С; 
КонецФункции

//Имя: СоздатьООПОбъект(ИмяОбъекта,М)
//Описание: Создать объект из массив-образа объекта. 
//Категория: ООП
Функция СоздатьООПОбъект(ИмяОбъекта,М)   экспорт
   КонструкторЕсть = Ложь;  ДеструкторЕсть = Ложь;  БиблиотекаЕсть = Ложь;  М1=Новый Массив;   
   Если ИмяОбъекта="" Тогда А = КаталогВременныхФайлов+"\object.osm" ИначеЕсли  СтрДлина(ИмяОбъекта)>0 Тогда 
         А = КаталогВременныхФайлов+"\"+ИмяОбъекта+".osm"; КонецЕсли;   
   Если НЕ СтрНайти(М[0],"Перем ИмяОбъекта экспорт; Перем Родитель  Экспорт") Тогда  
       М1.Добавить("Перем ИмяОбъекта экспорт; Перем Родитель  Экспорт; Перем UfaScript экспорт; Перем НашОбъект экспорт;"+
	         " Перем ГлМодуль;"); 
   КонецЕсли;
   Для сч=0 По М.Количество()-1 Цикл
      Если СтрНачинаетсяС(М[сч],"Функция Конструктор(")     Тогда   КонструкторЕсть = Истина;
      ИначеЕсли СтрНачинаетсяС(М[сч],"Функция Деструктор(") Тогда	ДеструкторЕсть = Истина;  КонецЕсли; 	  
      Если СокрЛП(М[сч])<>""  Тогда     М1.Добавить(М[сч]);      КонецЕсли;	  
   КонецЦикла;
	М1 = ПереместитьПеременВперед(М1);		 
   СоздатьИЗаписатьФайл(А,М1);  
   С=ЗагрузитьСценарий(А);     С.ИмяОбъекта = ИмяОбъекта;     С.НашОбъект = С;  С.UfaScript = ЭтотОбъект;
   Если КонструкторЕсть  Тогда С.Конструктор(); КонецЕсли;   Возврат С;
КонецФункции

//Имя: СоздатьНаследникаООПОбъекта(Об,Об2,М)
//Описание: Создать наследника Об2 из созданного объекта Об. 
//Категория: ООП
Функция СоздатьНаследникаООПОбъекта(Об,Об2,М)    экспорт
    Имя = КаталогВременныхФайлов+"\"+Об+".osm";
	Файл = Новый Файл(Имя);
	Если Файл.Существует() Тогда
	    М1 = ЗагрузитьСтрокиИзФайлаВМассив(Имя);  
        M2 = СобратьУправляющиеКоманды(М);
		М = ОчиститьУправляющиеКоманды(М);
        М1 = ОбработкаУправляющихКоманд(М1,M2);
		М2 = Новый Массив;		М2.Добавить(М1[0]);  
		Для сч=1 По М1.Количество()-1 Цикл  //---------- сначала все переменные   
		   Если СтрНайти(М1[сч],"Перем ") Тогда  М2.Добавить(М1[сч]);  КонецЕсли;
        КонецЦикла;
		Для сч=0 По М.Количество()-1 Цикл
		   Если СтрНайти(М[сч],"Перем ") Тогда  М2.Добавить(М[сч]);  КонецЕсли;
        КонецЦикла;
		Для сч=1 По М1.Количество()-1 Цикл     //----- потом функции кроме переменных
		    стр = СокрЛП(М1[сч]);
           Если стр<>"" И НЕ СтрНайти(М1[сч],"Перем ") Тогда М2.Добавить(стр); КонецЕсли;
        КонецЦикла;
		Для сч=1 По М.Количество()-1 Цикл
		    стр = СокрЛП(М[сч]);
           Если стр<>"" И НЕ СтрНайти(М[сч],"Перем ") Тогда М2.Добавить(стр); КонецЕсли; 
        КонецЦикла;
		Объект = СоздатьООПОбъект(Об2,М2);		Объект.Родитель = Об;
		Возврат Объект;
	КонецЕсли;
       Сообщить(" Родитель "+Имя+" отсутствует ");
       Возврат -1; 	   
КонецФункции

//Имя: СобратьУправляющиеКоманды(М)
//Описание: Создать массив с управляющими командами из массив-образа объекта. 
//Категория: ООП
Функция СобратьУправляющиеКоманды(М)
	 М2 = Новый Массив;
    Для сч=0 По М.Количество()-1 Цикл Если СтрНачинаетсяС(М[сч],"#") Тогда М2.Добавить(М[сч]); КонецЕсли;
	КонецЦикла;  	Возврат М2;
КонецФункции

//Имя: ОчиститьУправляющиеКоманды(М)
//Описание: Убрать управляющие команды из массив-образа объекта. 
//Категория: ООП
Функция ОчиститьУправляющиеКоманды(М)
    Для сч=0 По М.Количество()-1 Цикл   Если СтрНачинаетсяС(М[сч],"#") Тогда М[сч] = " "; КонецЕсли;	КонецЦикла;
    Возврат М;
КонецФункции
		
//Имя: ОбработкаУправляющихКоманд(М,М2)
//Описание: Обработать массив М управляющими командами из массива М2. 
//Категория: ООП
Функция ОбработкаУправляющихКоманд(М,М2)
        Для сч=0 По М2.Количество()-1 Цикл
		   Если СтрНачинаетсяС(М2[сч],"#Переименовать") Тогда
		      сч1 = СтрНайти(М2[сч]," "); СтароеИмя = СокрЛП(Сред(М2[сч],сч1));
			  сч1 = СтрНайти(СтароеИмя," ");  НовоеИмя = СокрЛП(Сред(СтароеИмя,сч1));  СтароеИмя = СокрЛП(Лев(СтароеИмя,сч1));
			  Для сч2=0 По М.Количество()-1 Цикл 
			     Если СтрНайти(М[сч2],"Функция "+СтароеИмя+"(") Тогда   
				      М[сч2] = СтрЗаменить(М[сч2],СтароеИмя+"(",НовоеИмя+"("); М2[сч] = " "; Прервать; КонецЕсли;
			  КонецЦикла	 
		   ИначеЕсли СтрНачинаетсяС(М2[сч],"#Удалить") Тогда
		      сч1 = СтрНайти(М2[сч]," "); ИмяФункц = СокрЛП(Сред(М2[сч],сч1)); 
              Для сч2=0 По М.Количество()-1 Цикл 
                 Если СтрНайти(М[сч2],"Функция "+ИмяФункц+"(") Тогда  М[сч2] = " "; М2[сч] = " "; Прервать; КонецЕсли;
			  КонецЦикла	 
		   КонецЕсли;
		КонецЦикла;
   Возврат М
КонецФункции

//?Вызов: СоздатьООПОбъектИзМассива(Об,М)
//?Параметры: М-массив строк методов и переменных объекта (массив-образ), Об - имя объекта
//?Описание: Создать объект из массив-образа объекта 
//?Поиск: OneScript ООП
Функция СоздатьООПОбъектИзМассива(Об,М)    экспорт
    М2 = СобратьУправляющиеКоманды(М);	    М = ОчиститьУправляющиеКоманды(М);
    М = ОбработкаУправляющихКоманд(М,М2);	М2 = ПереместитьПеременВперед(М);		 
	Объект = СоздатьООПОбъект(Об,М2);		Возврат Объект;
КонецФункции

//Имя: ПереместитьПеременВперед(М)
//Описание: Разместить описание переменных в первых строках массив-образа объекта 
//Категория: ООП
Функция ПереместитьПеременВперед(М)
	М2 = Новый Массив;		 
	Для сч=0 По М.Количество()-1 Цикл  //---------- сначала все переменные   
	   Если СтрНайти(М[сч],"Перем ") Тогда  М2.Добавить(М[сч]);  КонецЕсли;
    КонецЦикла;
	Для сч=1 По М.Количество()-1 Цикл     //----- потом функции кроме переменных
	    стр = СокрЛП(М[сч]);    Если стр<>"" И НЕ СтрНайти(стр,"Перем ") Тогда М2.Добавить(стр); КонецЕсли;
    КонецЦикла;
	Возврат М2;
КонецФункции

//?Вызов: ВысветитьОбъектВЦвете(М,В,Ш,ЦФ,ЦТ)
//?Параметры: М-массив строк объекта,В-высота,Ш-ширина,ЦФ-цвет фона,ЦТ-цвет текста
//?Описание: Высветить массив в заданном цвете ЦФ,ЦТ по указанным координатам В,Ш для 
//?Далее:           консоли (функция используется в методах объекта) 
//?Поиск: OneScript Консоль 
Процедура ВысветитьОбъектВЦвете(М,В,Ш,ЦФ,ЦТ) экспорт
     Консоль.ЦветФона = ЦФ;  Консоль.ЦветТекста = ЦТ;    
	Для Сч = 0 По М.Количество() - 1 Цикл
      Консоль.КурсорЛево = Ш;   Консоль.КурсорВерх = В+Сч;  Консоль.Вывести(М[сч]);   
    КонецЦикла;    
КонецПроцедуры

//?Вызов: ОбновитьЭкранОбъектов()
//?Параметры: Отсутствуют
//?Описание: Заново прорисовывает все объекты на экране консоли
//?Поиск: OneScript Консоль 
Процедура ОбновитьЭкранОбъектов()  экспорт
   Кол = Экран.Количество();  
   Для сч=0 По Кол-1 Цикл Если НЕ Экран[сч]=0 И НЕ Экран[сч].Скрытый Тогда Экран[сч].Нарисовать(); КонецЕсли; КонецЦикла;
КонецПроцедуры      

//?Вызов: СоздатьМодальноеОкноВопросДаНет(Y,X,М,ФДТ,U)
//?Параметры: Y,X- нач.координата, М-массив строк изображения, U - указатель на UfaScript 
//?Далее:        ФДТ - Фукция действие при нажатии кнопок
//?Описание: Модальное окно в консоле с вопросом ДаНет
//?Поиск: OneScript Консоль Окно 
Функция СоздатьМодальноеОкноВопросДаНет(Y,X,М,ФДТ,U) экспорт
    В=СоздатьПрямоугольник(Y, X,"",U, М);   В.ЦветФона = ЦветКонсоли.Бирюза; В.Нарисовать();  
    Гp=СоздатьГруппуОбъектов(2,U);  К=М.Количество()-2;
    Гp.ДобавитьПассивныйЭлементВГруппу(В);		
	М = Новый Массив;  М.Добавить("|  Да   |"); Кн=СоздатьКнопку(Y+К, X+5,"",ФДТ+"(1)",U, М);
	Гp.ДобавитьЭлементВГруппу(Кн);
	М = Новый Массив;  М.Добавить("|  Нет  |"); Кн=СоздатьКнопку(Y+К, X+15,"",ФДТ+"(2)",U, М);
	Гp.ДобавитьЭлементВГруппу(Кн);
    Возврат Гp;	
КонецФункции

//Имя: ОбработатьНажатияМодальногоОкна(Гp)
//Описание: Обработка нажатий клавиш модального окна в консоле с вопросом ДаНет 
//Категория: ООП Консоль Окно
Функция ОбработатьНажатияМодальногоОкна(Гp)  экспорт
  Гp.Нарисовать();  ПродолжитьРаботу=Истина;  
  Гp.АктивироватьЭлемент(0);
  Клавиша = Консоль.Прочитать();   
  Пока ПродолжитьРаботу Цикл
	ПродолжитьРаботу=Гp.ОбработатьНажатия(Клавиша);
    Клавиша = Консоль.Прочитать();
  КонецЦикла;  
  Гp.Скрытый=Истина; ОбновитьЭкранОбъектов();  Возврат Истина;
КонецФункции

//Имя: ОбразОбъектБазовый(М)
//Описание: Создание массива-образа для объекта Базовый родителя всех объектов 
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектБазовый(М) экспорт                           // -----------   Базовый
   М.Добавить("Перем Экран Экспорт; Перем Индекс Экспорт;  Перем ТипОбъекта Экспорт; Перем Скрытый Экспорт; ");
   М.Добавить("Функция РегистрацияНаЭкране(UfaS,Гл) экспорт UfaScript=UfaS; Индекс=UfaScript.Экран.Количество();  "
      +"  UfaScript.Экран.Добавить(НашОбъект);  ГлМодуль=Гл;   КонецФункции ");
   Возврат М;
КонецФункции   // ИмяОбъекта=""Базовый"";   

//?Вызов: СоздатьСтрокуТекста(Y1,X1,Текст1,ЦФ,ЦТ,Имя,U)
//?Параметры: Y1,X1- нач.координата, Текст1 - текст строки пояснения, U - указатель на UfaScript 
//?Далее:       ЦФ - Цвет фона символов консоли, ЦТ - цвет текста символов в консоле. 
//?Описание: Создать объект экрана для высвечивания строки в консоле
//?Поиск: OneScript Консоль 
Функция СоздатьСтрокуТекста(Y1,X1,Текст1,ЦФ,ЦТ,Имя,U) экспорт    //  ТипОбъекта = 1   ------------------  Экрана
  П1=СоздатьООПОбъектИзМассива(Имя,ОбразОбъектЭкрана(Новый Массив));
  П1.Y = Y1;    П1.X = X1;  П1.Текст = Текст1; П1.ЦветФона=ЦФ; П1.ЦветТекста=ЦТ;  
  П1.РегистрацияНаЭкране(ЭтотОбъект,U);   Возврат П1;
КонецФункции

//Имя: ОбразОбъектЭкрана(М)
//Описание: Создать массивОбъект для создания объекта ТекстЭкрана
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектЭкрана(М) экспорт      
   М=ОбразОбъектБазовый(М);
   М.Добавить("Перем Y экспорт; Перем X экспорт; Перем Текст Экспорт; "+
         "Перем ЦветФона Экспорт; Перем ЦветТекста Экспорт;   ");
    М.Добавить("Функция Конструктор() экспорт Y=1; X=1; ТипОбъекта=1; Текст=ИмяОбъекта; ЦветФона = ЦветКонсоли.Зеленый; "+
       "ЦветТекста = ЦветКонсоли.Черный;  ИмяОбъекта=""ЭлементЭкрана"";  Скрытый=Ложь; КонецФункции ");
	М.Добавить("Функция Нарисовать() экспорт UfaScript.Консоль.ЦветФона = ЦветФона; UfaScript.Консоль.КурсорВерх = Y; "+
        "UfaScript.Консоль.КурсорЛево = X;  UfaScript.Консоль.ЦветТекста = ЦветТекста;  UfaScript.Консоль.Вывести(Текст); "+
		 " КонецФункции ");
   Возврат М;
КонецФункции

//?Вызов: СоздатьПолеВвода(Y1,X1,Текст1,Имя,U)
//?Параметры: Y1,X1- нач.координата, Текст1 - текст строки пояснения, U - указатель на UfaScript 
//?Описание: Создать Объект для ввода строки пользователем
//?Поиск: OneScript Консоль 
Функция СоздатьПолеВвода(Y1,X1,Текст1,Имя,U) экспорт    //  ТипОбъекта = 10   ----------------  ПолеВвода
  П1=СоздатьООПОбъектИзМассива(Имя,ОбразОбъектПолеВвода(Новый Массив));
  П1.Y = Y1;    П1.X = X1;  П1.Текст = Текст1;  П1.РегистрацияНаЭкране(ЭтотОбъект,U);    Возврат П1;
КонецФункции

//Имя: ПереходВРедактированиеСтроки(Стр,Длина)
//Описание: Функция при переходе в режим редактирования объекта для ввода данный из строки пользователем Стр - строка для редактирования, Длина - макс.длина строки
//Категория: ООП Консоль Объект 
Функция  ПереходВРедактированиеСтроки(Стр,Длина)  экспорт
    Нач = Консоль.КурсорЛево;    Консоль.Вывести(СоздатьСтрокуСимволов(" ",Длина));  Консоль.КурсорЛево=Нач;
    Клавиша = Консоль.Прочитать();  Д=Длина;
    Пока НЕ (Клавиша = 40 ИЛИ Клавиша = 38 ИЛИ Клавиша = 13 ИЛИ Клавиша = 27) Цикл
  	   Если ((Клавиша >= 32 И Клавиша <= 123) ИЛИ (Клавиша >= 192 И Клавиша <= 255)) ИЛИ 
	      (Клавиша  >= 16 И Клавиша <= 18) И Д>0 И Д<Длина Тогда 
  	       X=Консоль.КурсорЛево; С1=Символ(Клавиша);	Консоль.Вывести(С1+СоздатьСтрокуСимволов(" ",Д));
		   Консоль.КурсорЛево=X+1;    Стр=Стр+С1;	 Д=Д-1;
       ИначеЕсли Клавиша=8 И Д<Длина Тогда Стр=Лев(Стр,СтрДлина(Стр)-1);  Консоль.КурсорЛево = Консоль.КурсорЛево-1; 
	        Консоль.Вывести(" ");    Д=Д+1; Консоль.КурсорЛево = Консоль.КурсорЛево-1;
	   КонецЕсли;
       Клавиша = Консоль.Прочитать();
	КонецЦикла;  Возврат  Стр+СоздатьСтрокуСимволов(" ",Д);   
КонецФункции

//Имя: ОбразОбъектПолеВвода(М)
//Описание: Создать массивОбъект для создания объекта Ввода текста пользователем
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектПолеВвода(М) экспорт    
   М=ОбразОбъектЭкрана(М);   М.Добавить("Перем ДлинаТекста Экспорт;");
   М.Добавить("#Переименовать Конструктор РодитКонструктор");
    М.Добавить("Функция Конструктор() экспорт   РодитКонструктор(); Y=10; X=10; ТипОбъекта=2;  ДлинаТекста = 25; "+
     "	ЦветФона = ЦветКонсоли.Белый; ЦветТекста = ЦветКонсоли.Черный; Скрытый=Ложь;  КонецФункции ");
    М.Добавить("Функция Действие() экспорт UfaScript.Консоль.ЦветФона = ЦветКонсоли.Белый;  UfaScript.Консоль.КурсорЛево = X; "+
         " ВвестиСтроку(Текст,30);   Возврат Истина;  КонецФункции ");   
	 Возврат М;
КонецФункции                        

//?Вызов: СоздатьСтрокуВыбора(Y1,X1,Текст1,Имя,ФД,U)
//?Параметры: Y1,X1- нач.координата, Текст1 - текст строки, ФД - имя функции при выборе, U - указатель на UfaScript 
//?Описание: Строка выбора. При активной строке нажатие клавиши Ввод - вызов заданной функции (типа кнопки в одну строку)
//?Поиск: OneScript Консоль 
Функция СоздатьСтрокуВыбора(Y1,X1,Текст1,Имя,ФД,U) экспорт    //  ТипОбъекта = 11   ----------  СтрокаВыбора
  П1=СоздатьООПОбъектИзМассива(Имя,ОбразОбъектСтрокаВыбора(Новый Массив)); ТипОбъекта = 11;
  П1.РегистрацияДанных(Y1,X1,Текст1,ФД,ЭтотОбъект,U);    Возврат П1;
КонецФункции

//Имя: ОбразОбъектСтрокаВыбора(М)
//Описание: МассивОбъект для объекта типа кнопки в одну строку
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектСтрокаВыбора(М) экспорт    
  М=ОбразОбъектЭкрана(М);     М.Добавить("Перем Функц;"); 
  М.Добавить("Функция РегистрацияДанных(Y1,X1,Текст1,ФД,U,Гл) экспорт  Y=Y1; X=X1; Текст=Текст1; "+
	"  ТипОбъекта=11; РегистрацияНаЭкране(U,Гл); Функц=ФД; КонецФункции ");
   М.Добавить("Функция Действие() экспорт возврат  UfaScript.ВызватьФункцию(Функц,ГлМодуль).Результат();  КонецФункции ");    
   Возврат М;
КонецФункции  

//?Вызов: СоздатьСтрокиВыбора(Y1,X1,М,T,ФДТ,U)
//?Параметры: Y1,X1- нач.координата, М - массив со строками, ФДТ - имя функции при выборе, U - указатель на UfaScript 
//?Описание: Создать вертикальный массив строк выбора.
//?Поиск: OneScript Консоль 
Функция СоздатьСтрокиВыбора(Y1,X1,М,T,ФДТ,U) экспорт
   М2 = Новый Массив;     М2.Добавить(T);  
   Для сч=0 По М.Количество() - 1 Цикл  М2.Добавить("|"+СоздатьСтрокуСимволов(" ",СтрДлина(T)-2)+"|");   КонецЦикла;
   М2.Добавить("|"+СоздатьСтрокуСимволов("=",СтрДлина(T)-2)+"|"); 
   СоздатьПрямоугольник(Y1, X1,"",U, М2);	Гp3=СоздатьГруппуОбъектов(1,U); 
	Для сч = 0 По М.Количество() - 1 Цикл
       Гp3.ДобавитьЭлементВГруппу(СоздатьСтрокуВыбора(Y1+1+сч,X1+2,М[сч],"",ФДТ+"("+сч+")",U));
    КонецЦикла;   Возврат Гp3;
КонецФункции

//?Вызов: СоздатьПрямоугольник(Y,X,Имя,U,МТ)
//?Параметры: Y,X - координаты в консоле, МТ - массив строк изображения прямоугольника. U - указатель на UfaScript 
//?Описание: Создать прямоугольник из текстовых строк. 
//?Поиск: OneScript Консоль 
Функция СоздатьПрямоугольник(Y,X,Имя,U,МТ) экспорт   //  ТипОбъекта = 2   ----------------  Прямоугольник
  Кн1=СоздатьООПОбъектИзМассива(Имя,ОбразОбъектКнопка(Новый Массив));  Кн1.ТипОбъекта = 2;
  Кн1.РегистрацияДанных(Y,X," ",ЭтотОбъект,U); Кн1.МассивТекста=МТ;   Кн1.ИмяОбъекта="Прямоугольник";  Возврат Кн1;
КонецФункции

//?Вызов: НарисоватьООПРамкуНаВесьЭкран(U)
//?Параметры: U - указатель на UfaScript 
//?Описание: Нарисовать фоновую рамку для консоли с объектами 
//?Поиск: OneScript Консоль 
Процедура НарисоватьООПРамкуНаВесьЭкран(U) экспорт
    С = СоздатьСтрокуСимволов("*",Консоль.Ширина);    С2 = "*"+СоздатьСтрокуСимволов(" ",Консоль.Ширина-2)+"*";
	М = Новый Массив;    М.Добавить(С);    
   	Для Сч = 1 По Консоль.Высота - 4 Цикл      М.Добавить(С2);	КонецЦикла;    М.Добавить(С);    
    Кн1=СоздатьООПОбъектИзМассива("Рамка",ОбразОбъектПрямоугольник(Новый Массив));  
    Кн1.РегистрацияДанных(0,0," ",ЭтотОбъект,U); Кн1.МассивТекста=М; Кн1.ИмяОбъекта="Рамка";
	Кн1.ЦветФона=ЦветКонсоли.Желтый;  Кн1.ЦветТекста=ЦветКонсоли.Красный;    
КонецПроцедуры

//Имя: ОбразОбъектПрямоугольник(М)
//Описание: МассивОбъект для объекта Прямогольник (массив строк)
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектПрямоугольник(М) экспорт     
   М=ОбразОбъектЭкрана(М);   М.Добавить("Перем МассивТекста экспорт; ");     М.Добавить("#Удалить Нарисовать");   
   М.Добавить("Функция Нарисовать() экспорт  UfaScript.ВысветитьОбъектВЦвете(МассивТекста, Y, X, ЦветФона, ЦветТекста);  КонецФункции ");
   М.Добавить("Функция РегистрацияДанных(Y1,X1,Текст1,U,Гл) экспорт  Y=Y1; X=X1; Текст=Текст1;"+
	"    ТипОбъекта=2; РегистрацияНаЭкране(U,Гл);  КонецФункции ");
   Возврат М;
КонецФункции

//?Вызов: СоздатьКнопку(Y,X,Имя,ФД,U,МТ)
//?Параметры: Y,X - координаты в консоле, ФД - Фукция-действие при нажатии Enter, 
//?Далее:        МТ - массив строк определяющий изображение кнопки 
//?Описание: Создать кнопку из строкового массива МТ с действием функции ФД 
//?Поиск: OneScript Консоль 
Функция СоздатьКнопку(Y,X,Имя,ФД,U,МТ) экспорт
  Кн1=СоздатьООПОбъектИзМассива(Имя,ОбразОбъектКнопка(Новый Массив));   Кн1.ТипОбъекта = 11;  Кн1.ИмяОбъекта="Кнопка";
  Кн1.РегистрацияДанных(Y,X," ",ЭтотОбъект,U); Кн1.МассивТекста=МТ;   Кн1.Функц=ФД;    Возврат Кн1;
КонецФункции

//Имя: ОбразОбъектКнопка(М)
//Описание: МассивОбъект для объекта Кнопка потомок объекта Прямоугольник
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектКнопка(М) экспорт
   М=ОбразОбъектПрямоугольник(М);   М.Добавить("Перем Функц экспорт;");      
   М.Добавить("Функция Действие() экспорт   Возврат UfaScript.ВызватьФункцию(Функц,ГлМодуль).Результат();  КонецФункции ");    
   Возврат М;
КонецФункции

//?Вызов: СоздатьКнопку20(Y,X,Текст,Имя,ФД,U)
//?Параметры: Y,X - координаты в консоле, Текст - текст конопки, ФД - Фукция-действие при нажатии Enter
//?Описание: Создать кнопку с текстом Текст с действием функции ФД шириной 20 символов 
//?Поиск: OneScript Консоль 
Функция СоздатьКнопку20(Y,X,Текст,Имя,ФД,U) экспорт   //  ТипОбъекта = 20   --------------- Кнопка20
  Кн1=СоздатьООПОбъектИзМассива(Имя,ОбразОбъектКнопка20(Новый Массив));  Кн1.ТипОбъекта = 20;  Кн1.ИмяОбъекта="Кнопка20";
  Кн1.СоздатьМассивКнопки(Y,X,Текст,ФД,ЭтотОбъект,U);    Возврат Кн1;
КонецФункции

//Имя: ОбразОбъектКнопка20(М)
//Описание: МассивОбъект для объекта Кнопка шириной 20 символов и высоток в 3 строки (потомок объекта Кнопка)
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектКнопка20(М) экспорт       
   М=ОбразОбъектКнопка(М);
   М.Добавить("#Удалить Изобразить");   
   М.Добавить("Функция Изобразить() экспорт  "+
  "       М1=Новый Массив; М1.Добавить(""+-----------------+""); "+
                      "    М1.Добавить(""|"" + Текст +   ""|""); "+
                      "    М1.Добавить(""+-----------------+""); МассивТекста=М1; КонецФункции ");   Возврат М;
КонецФункции

//?Вызов: СоздатьГруппуОбъектов(Тип,U)
//?Параметры: Тип - тип группы
//?Описание: Создать группу для объектов. Если Тип=1 то группа вертикальная управление стрелки 
//?Далее:         вверх-вниз, Тип=2 - горизонтальная (стрелки вправо-влево) 
//?Поиск: OneScript Консоль 
Функция СоздатьГруппуОбъектов(Тип,U)  экспорт
   Если Тип=1 Тогда М = ОбразОбъектГруппы(Новый Массив); ИначеЕсли Тип=2 Тогда 
                                  М = ОбразОбъектГруппыГоризонт(Новый Массив);  КонецЕсли;
	Гp1=СоздатьООПОбъектИзМассива("Группа",М);	Гp1.РегистрацияНаЭкране(ЭтотОбъект,U);    Возврат Гp1;
КонецФункции

//Имя: ОбразОбъектГруппы(М)
//Описание: МассивОбъект для объекта Группа (потомок объекта Базовый)
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектГруппы(М) экспорт
   М=ОбразОбъектБазовый(М);
   М.Добавить("Перем АктивГруппы Экспорт; Перем ПассивГруппы Экспорт; Перем АктивИндекс экспорт;  Перем АктивЦветФона  экспорт; Перем И1;"+
       "Перем ЦветФона  экспорт; ");
   М.Добавить("Функция Конструктор() экспорт АктивГруппы = Новый Массив; ПассивГруппы = Новый Массив; АктивИндекс=-1; "+
       "АктивЦветФона=ЦветКонсоли.Синий; ТипОбъекта=30; ИмяОбъекта=""Группа""; Скрытый=Ложь; КонецФункции ");
   М.Добавить("Функция ДобавитьЭлементВГруппу(Об) экспорт И1=Об.Индекс;   UfaScript.Экран[И1]=0; АктивИндекс=АктивИндекс+1; "+
       "Об.Индекс= АктивГруппы.Количество();   АктивГруппы.Добавить(Об); Об.Экран=НашОбъект; ЦветФона=Об.ЦветФона; КонецФункции ");
   М.Добавить("Функция ДобавитьПассивныйЭлементВГруппу(Об) экспорт И1=Об.Индекс;   UfaScript.Экран[И1]=0;  "+
       "Об.Индекс=ПассивГруппы.Количество();  ПассивГруппы.Добавить(Об);   Об.Экран=НашОбъект; КонецФункции ");
   М.Добавить("Функция АктивироватьЭлемент(Инд) экспорт  Если АктивГруппы.Количество()=0 Тогда "+
    "  Возврат 0; КонецЕсли; АктивГруппы[АктивИндекс].ЦветФона=ЦветФона; Если Инд<0 Тогда  "+
    " АктивГруппы[АктивИндекс].Нарисовать();  Возврат 0; КонецЕсли; АктивГруппы[АктивИндекс].Нарисовать(); "+
	" АктивИндекс=Инд;  АктивГруппы[Инд].ЦветФона=АктивЦветФона; АктивГруппы[Инд].Нарисовать(); КонецФункции ");
   М.Добавить("Функция Нарисовать() экспорт   "+
       " Для сч=0 По АктивГруппы.Количество()-1 Цикл  АктивГруппы[сч].Нарисовать();    КонецЦикла;      "+
       "  Для сч=0 По ПассивГруппы.Количество()-1 Цикл  ПассивГруппы[сч].Нарисовать();    КонецЦикла;   КонецФункции ");
   М.Добавить("Функция ОбработатьНажатия(Клавиша) экспорт Если Клавиша=27 Тогда  Возврат Ложь; ИначеЕсли "+
       "  Клавиша=38 Тогда  Если АктивИндекс>0 Тогда АктивироватьЭлемент(АктивИндекс-1); КонецЕсли;    ИначеЕсли "+
        "  Клавиша=40 Тогда Если АктивИндекс<АктивГруппы.Количество()-1  Тогда АктивироватьЭлемент(АктивИндекс+1); "+
		  " КонецЕсли; ИначеЕсли Клавиша=13 Тогда Возврат АктивГруппы[АктивИндекс].Действие(); КонецЕсли;   "+
		   "  Возврат Истина; КонецФункции "); 
    Возврат М;
КонецФункции

//Имя: ОбразОбъектГруппыГоризонт(М)
//Описание: МассивОбъект для объекта Группа горизонтальная (потомок объекта Группы) Активные объекты следует располагать по горизонтали. 
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектГруппыГоризонт(М) экспорт
   М=ОбразОбъектГруппы(М);
   М.Добавить("#Удалить ОбработатьНажатия");
   М.Добавить("Функция ОбработатьНажатия(Клавиша) экспорт Если Клавиша=27 Тогда  Возврат Ложь; ИначеЕсли "+
       "  Клавиша=37 Тогда  Если АктивИндекс>0 Тогда АктивироватьЭлемент(АктивИндекс-1); КонецЕсли;    ИначеЕсли "+
        "  Клавиша=39 Тогда Если АктивИндекс<АктивГруппы.Количество()-1  Тогда АктивироватьЭлемент(АктивИндекс+1); "+
		  " КонецЕсли; ИначеЕсли Клавиша=13 Тогда  Возврат АктивГруппы[АктивИндекс].Действие(); КонецЕсли;   Возврат Истина; КонецФункции "); 
    Возврат М;
КонецФункции

//?Вызов: СоздатьСтрокуПрогресса(Y1,X1,T,U)
//?Параметры: Y1,X1-координаты в консоле, Т-заголовок (определяет ширину)
//?Описание: Высветить объект Об модально.
//?Поиск: OneScript Консоль 
Функция СоздатьСтрокуПрогресса(Y1,X1,T,U) экспорт
   Гр=СоздатьООПОбъектИзМассива("",ОбразОбъектПрогресс(Новый Массив)); Д=СтрДлина(T);
   Гр.РегистрацияНаЭкране(ЭтотОбъект,U);  Гр.Y=Y1;  Гр.X=X1; Гр.Заголовок = T;  Гр.Длина=Д;
   МТ=Новый Массив;  МТ.Добавить(T);   МТ.Добавить("|"+СоздатьСтрокуСимволов(" ",Д-2)+"|"); 
   МТ.Добавить(СоздатьСтрокуСимволов("=",Д));   Пр=СоздатьПрямоугольник(Y1,X1,"",U,МТ);
   Гр.ДобавитьПассивныйЭлементВГруппу(Пр);    Гр.ИмяОбъекта = "Прогресс";
   Стр=СоздатьСтрокуТекста(Y1+1,X1+1,СоздатьСтрокуСимволов(" ",Д-2),ЦветКонсоли.Серый,ЦветКонсоли.Белый,"",U);
   Гр.ДобавитьПассивныйЭлементВГруппу(Стр); Гр.Уровень = 0;  стр=СоздатьСтрокуСимволов(" ",Гр.Уровень);
   Гр.Прогресс=СоздатьСтрокуТекста(Y1+1,X1+1,стр,ЦветКонсоли.Черный, ЦветКонсоли.Белый,"",U);
   Гр.ДобавитьПассивныйЭлементВГруппу(Гр.Прогресс);      Возврат Гр;
КонецФункции

//Имя: ОбразОбъектПрогресс(М)
//Описание: МассивОбъект для объекта Прогресс (потомок объекта Группы)  Метод НарисоватьПрогресс(Д) Меняет позицию ползунка Д - длина которую надо установить
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектПрогресс(М) экспорт
   М=ОбразОбъектГруппы(М);
   М.Добавить("Перем Заголовок экспорт; Перем Y экспорт; Перем X экспорт; Перем Длина экспорт; "+
    " Перем Уровень  экспорт; Перем Прогресс экспорт;  ");
   М.Добавить("Функция НарисоватьПрогресс(Д) экспорт Если Д>Длина-2 Тогда Д=Длина-2; КонецЕсли; "+
    " Если Д<0 Тогда Д=0; КонецЕсли;  Прогресс.Текст=UfaScript.СоздатьСтрокуСимволов("" "",Д); "+
        " Уровень=Д;  ПассивГруппы[1].Нарисовать();  Прогресс.Нарисовать();  КонецФункции ");
   М.Добавить("Функция Переместить(Y,X) экспорт Y1=Y; X1=X;  ПассивГруппы[0].Y=Y; ПассивГруппы[0].X=X; "+
     " ПассивГруппы[1].Y=Y+1; ПассивГруппы[1].X=X+1; Прогресс.Y=Y+1;   Прогресс.X=X+1; Нарисовать(); "+
	 " КонецФункции ");
   М.Добавить("#Удалить АктивироватьЭлемент");
   М.Добавить("Функция АктивироватьЭлемент(Инд) экспорт  Если Инд=-1 Тогда ПассивГруппы[0].ЦветФона = ЦветКонсоли.Зеленый; "+
    " ИначеЕсли Инд<>-1 Тогда  ПассивГруппы[0].ЦветФона = ЦветКонсоли.Синий;  КонецЕсли; Нарисовать(); "+
	" КонецФункции  ");   Возврат М; 
КонецФункции

//?Вызов: ПросмотрМодально(Об)
//?Параметры: Об - объект строк для отображения в консоли
//?Описание: Высветить объект Об модально.
//?Поиск: OneScript Консоль 
Функция ПросмотрМодально(Об) экспорт
   Об.Нарисовать();
	Клавиша = Консоль.Прочитать();    ПродолжитьРаботу=Истина;  Об.АктивироватьЭлемент(0); 
 	Пока ПродолжитьРаботу Цикл 
      Если Клавиша=9 ИЛИ Клавиша=27 Тогда  Прервать;  КонецЕсли;	
      ПродолжитьРаботу=Об.ОбработатьНажатия(Клавиша);
	  Клавиша = Консоль.Прочитать();
	КонецЦикла;	ОбновитьЭкранОбъектов();
КонецФункции

//?Вызов: ПросмотрТекста(Y1,X1,Y2,T,М,U)
//?Параметры: М - просматриваемый Массив строк, Т - строка-заголовок окна (определяет ширину экрана)
//?Описание: Просмотр массива строк М в окне шириной Т (строка заголовок окна) и высотой Y2.
//Далее:           Прокрутка просмотра стрелками.
//?Поиск: OneScript Массив Консоль 
Функция ПросмотрТекста(Y1,X1,Y2,T,М,U) экспорт
   Гр=СоздатьООПОбъектИзМассива("",ОбразОбъектПросмотрТекста(Новый Массив)); Д=СтрДлина(T);
   Гр.РегистрацияНаЭкране(ЭтотОбъект,U);    Гр.Y1=Y1;  Гр.X1=X1; Гр.Y2=Y2; Гр.X2=X1+Д;
   МТ=Новый Массив;  МТ.Добавить(T);   Гр.Заголовок = T;  Гр.МассивТекста = ЗаменитьТабНаПробелы(М);  
   Гр.ДлинаТекста=ОпределитьМаксДлинуСтрокиВМассиве(Гр.МассивТекста);
   Для сч=0 По Y2-Y1 Цикл  МТ.Добавить("|"+СоздатьСтрокуСимволов(" ",Д-2)+"|");  КонецЦикла;
   МТ.Добавить(СоздатьСтрокуСимволов("=",Д));   Гр.Рамка=СоздатьПрямоугольник(Y1,X1,"",U,МТ);
   Гр.ДобавитьПассивныйЭлементВГруппу(Гр.Рамка);   Гр.sY=0; Гр.sX=0;   
   Консоль.ЦветФона=ЦветКонсоли.Зеленый;   Консоль.ЦветТекста=ЦветКонсоли.Черный;
   Гр.ВидТекст = СегментМассиваСоздать(0,0,Y2-Y1,Д-2,Гр.МассивТекста); 
   Для сч=0 По Гр.ВидТекст.Количество()-1 Цикл
      стр=СоздатьСтрокуТекста(Y1+сч+1,X1+1,Гр.ВидТекст[сч],Консоль.ЦветФона,Консоль.ЦветТекста,"",U);   
      Гр.ДобавитьПассивныйЭлементВГруппу(стр);   
   КонецЦикла;	     Возврат Гр;
КонецФункции

//?Вызов: СегментМассиваСоздать(Y1,X1,Y2,X2,M)
//?Параметры: М1 - Массив, созданный из массива M2 по координатам Y1,X1,Y2,X2
//?Описание: Вырезает квадратный сегмент из массива М по координатам Y1,X1,Y2,X2 
//?Поиск: OneScript Массив
Функция СегментМассиваСоздать(Y1,X1,Y2,X2,M)
  M1=Новый Массив; 
  Если Y1<M.Количество() Тогда
     Если Y2>=M.Количество() Тогда Y2=M.Количество()-1;  КонецЕсли; 
     Для сч=Y1 По Y2 Цикл M1.Добавить(Сред(M[сч],X1,X2));  КонецЦикла;  
  КонецЕсли;   Возврат M1;
КонецФункции

//?Вызов:  СегментМассиваИзменить(Y1,X1,Y2,X2,M1,М2)
//?Параметры: М1 - Массив, изменяемый из массива M2 по координатам Y1,X1,Y2,X2
//?Описание: Вырезает квадратный сегмент из массива М2 по координатам Y1,X1,Y2,X2 и заполняет массив М1 
//?Поиск: OneScript Массив
Функция СегментМассиваИзменить(Y1,X1,Y2,X2,M1,М2)  экспорт
   сч1=0;   Для сч=Y1 По Y2-1 Цикл  стр=Сред(М2[сч],X1,X2);  M1[сч1]=стр; сч1=сч1+1; КонецЦикла;  Возврат M1;
КонецФункции

//Имя: ОбразОбъектПросмотрТекста(М)
//Описание: МассивОбъект для объекта Просмотр текста (потомок объекта Группы)  
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектПросмотрТекста(М) экспорт
   М=ОбразОбъектГруппы(М);
   М.Добавить("Перем Заголовок экспорт; Перем Y1 экспорт; Перем X1 экспорт;  Перем Y2 экспорт; "+
    " Перем X2 экспорт;  Перем МассивТекста экспорт; Перем ДлинаТекста экспорт; Перем ВидТекст экспорт; "+
	" Перем sY экспорт; Перем sX экспорт; Перем Рамка экспорт; ");
   М.Добавить("Функция НарисоватьТекст() экспорт Рамка.Нарисовать(); Для сч=1 По ПассивГруппы.Количество()-1 Цикл "+
    " ПассивГруппы[сч].Нарисовать(); КонецЦикла; КонецФункции ");
   М.Добавить("Функция СместитьТекст(Y,X) экспорт Если sY+Y<0 Тогда sY=0; Возврат 0; КонецЕсли; "+
    " Если sX+X<0 Тогда sX=0;  Возврат 0; КонецЕсли; Если Y>0 И (sY+Y)+Y2-Y1+1>МассивТекста.Количество()-1 Тогда "+
    " Возврат 0; КонецЕсли; Если X>0 И (sX+X)>(ДлинаТекста-(X2-X1)+3) Тогда  Возврат 0;  КонецЕсли; sY=sY+Y; sX=sX+X; "+  
	" Если sY+Y2-Y1>МассивТекста.Количество()-1 Тогда K=МассивТекста.Количество()-1; ИначеЕсли "+
    " sY+Y2-Y1<МассивТекста.Количество()-1	тогда K=sY+Y2-Y1;  КонецЕсли; "+
	" Для сч=sY По K Цикл стр=Сред(МассивТекста[сч],sX,X2-X1-2); ВидТекст[сч-sY]=стр; КонецЦикла; "+
    " Для сч=1 По ПассивГруппы.Количество()-1 Цикл ПассивГруппы[сч].Текст=ВидТекст[сч-1];  "+
	" ПассивГруппы[сч].Нарисовать(); КонецЦикла;  КонецФункции ");      
   М.Добавить("#Удалить ОбработатьНажатия");
   М.Добавить("Функция ОбработатьНажатия(Клавиша) экспорт Если Клавиша=27 Тогда  Возврат Ложь; ИначеЕсли "+
    " Клавиша=38 Тогда  СместитьТекст(-1,0);  ИначеЕсли Клавиша=40 Тогда СместитьТекст(1,0); "+
    " ИначеЕсли Клавиша=37 Тогда СместитьТекст(0,-1); ИначеЕсли Клавиша=39 Тогда  СместитьТекст(0,1); "+
	" КонецЕсли;  Возврат Истина;  КонецФункции ");    
   М.Добавить("#Удалить АктивироватьЭлемент");
   М.Добавить("Функция АктивироватьЭлемент(Инд) экспорт  Если Инд=-1 Тогда  Рамка.ЦветФона = ЦветКонсоли.Зеленый; "+
    " ИначеЕсли Инд<>-1 Тогда  Рамка.ЦветФона = ЦветКонсоли.Синий;  КонецЕсли; Нарисовать();  КонецФункции  ");
    Возврат М;
КонецФункции

//?Вызов:  КопияМассива(М)
//?Параметры: М - Массив, копия которого создается
//?Описание: Создается массив копия массива М. 
//?Поиск: OneScript Массив 
Функция КопияМассива(М) экспорт
 	 М1 = Новый Массив;  Для сч=0 По М.Количество()-1 Цикл  М1.Добавить(М[сч]); КонецЦикла; Возврат М1;
КонецФункции

//?Вызов:  ДобавитьСтрокиВМассивСПромежутком(Знач М)
//?Параметры: М - Массив между строками которого вставляются пустые строки
//?Описание: Добавить пустые строки между строками массива М. Используется, 
//?Далее:        чтоб раздвинуть текст, если высота консоли позволяет
//?Поиск: OneScript Консоль Массив
Функция ДобавитьСтрокиВМассивСПромежутком(Знач М)  экспорт
    Если Консоль.Высота < 45 Тогда      Возврат М;
	ИначеЕсли  Консоль.Высота >= 45 Тогда   M1 = Новый Массив;
	   Для сч=0 По М.Количество()-1 Цикл     M1.Добавить(М[сч]);  M1.Добавить("");   КонецЦикла;
    КонецЕсли;   Возврат M1;
КонецФункции

//?Вызов: ВыполнитьКоманднуюСтроку(Команда)
//?Параметры: Команда - командная строка для выполнения
//?Описание: Записывает команду в батфайл и запускает на исполнение, чтоб можно было запустить 
//?Далее:        системные команды, которые не запускаются через  ЗапуститьПриложение()
//?Поиск: OneScript 
Процедура ВыполнитьКоманднуюСтроку(Команда) экспорт
  // V1=ТекущаяУниверсальнаяДатаВМиллисекундах();
   Ф = Новый ЗаписьТекста;  Ф.Открыть("Cmdcom.bat");   
   Ф.ЗаписатьСтроку("rem"); Ф.ЗаписатьСтроку(Команда); 
   Ф.Закрыть();      ЗапуститьПриложение("Cmdcom.bat");
  // Сообщить(ТекущаяУниверсальнаяДатаВМиллисекундах()-V1);
КонецПроцедуры


//--------------  Функции для формирования index.php для Joomla ----------------------------------------
Функция НачатьЗапись(Знач ИмяФайла="index.php") экспорт
  Запись = Новый ЗаписьТекста;  Запись.Открыть(ИмяФайла);
КонецФункции

//Имя: ПРОЦЕСС_НачалоДляJoomla()
//Описание: Начало записи файла index.php
//Категория: HTML Joomla PHP CSS
Функция ПРОЦЕСС_НачалоДляJoomla() экспорт
  НачатьЗапись();
  Запись.ЗаписатьСтроку("<?php defined('_JEXEC') or die; $doc = JFactory::getDocument(); $JUri =  JUri::base(TRUE); $LOGOTIP = JText::_(""TPL_UFAJOOM37_LOGOTIP""); "+
   "$doc->addStyleSheet($JUri.""/templates/"".$doc->template.""/css/style.css""); if ($showRightColumn == 0 and $showleft == 0) {$showno = 0;} "+
   "$this->setHtml5(true); ?>");
  Запись.ЗаписатьСтроку("<style type=""text/css"">");
КонецФункции

//Имя: ПРОЦЕСС_Начало(ИмяФайла)
//Описание: Начало записи файла ИмяФайла
//Категория: HTML PHP CSS
Функция ПРОЦЕСС_Начало(ИмяФайла) экспорт
  НачатьЗапись(ИмяФайла);
  Запись.ЗаписатьСтроку("<!DOCTYPE html ><html><style type=""text/css"">");
КонецФункции

//Имя: ПРОЦЕСС_ЦентрДляJoomla()
//Описание: Начало <body> тега в файле index.php
//Категория: HTML Joomla PHP CSS
Функция ПРОЦЕСС_ЦентрДляJoomla() экспорт
  Запись.ЗаписатьСтроку("<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd""> "+
    "<html xmlns=""http://www.w3.org/1999/xhtml"" lang=""<?php echo $this->language; ?>"" dir=""<?php echo $this->direction; ?>""><head>"+
    "<meta name=""viewport"" content=""width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=yes""/>"+
    "<meta name=""HandheldFriendly"" content=""true"" /><meta name=""apple-mobile-web-app-capable"" content=""YES"" /><jdoc:include type=""head"" /></head>");
  Запись.ЗаписатьСтроку("<?php ini_set(""default_charset"" ,""utf8""); ?>");
  Запись.ЗаписатьСтроку("<body id=""thebody""><div class=""Baza"">");
КонецФункции

//Имя: ПРОЦЕСС_Центр()
//Описание: Начало <body> тега в файле index.php
//Категория: HTML Joomla PHP CSS
Функция ПРОЦЕСС_Центр() экспорт
  Запись.ЗаписатьСтроку("<?php ini_set(""default_charset"" ,""utf8""); ?>");
  Запись.ЗаписатьСтроку("<body id=""thebody""><div class=""Baza"">");
КонецФункции

//Имя: ПРОЦЕСС_Окончание()
//Описание: Окончание файла index.php
//Категория: HTML Joomla 
Функция ПРОЦЕСС_Окончание() экспорт
  Запись.ЗаписатьСтроку("</div></body></html>");
  Запись.Закрыть();
КонецФункции

//Имя: Запись_ЗаписатьПозицию(ИмяПозиции)
//Описание: Записать позицию для Joomla
//Категория: HTML Joomla 
Функция Запись_ЗаписатьПозицию(ИмяПозиции) экспорт
   Запись.ЗаписатьСтроку("<div class="""+ИмяПозиции+"""><jdoc:include type=""modules"" name="""+ИмяПозиции+""" /></div>");
КонецФункции

//Имя: ЗаписатьCSSФайл(Строка)
//Описание: Записать CSS файл для Joomla в шаблоне OneScript
//Категория: HTML Joomla CSS 
Функция ЗаписатьCSSФайл(Строка) экспорт
   Запись = Новый ЗаписьТекста;  Запись.Открыть("css\style.css");
   Запись.ЗаписатьСтроку(Строка);   Запись.Закрыть();
КонецФункции

//Имя: УсловиеПараметрРавен(Ном)
//Описание: Выполнение условия по параметру act=Ном. Позволяет создать условное ветвление в Index.php файле 
//Категория: PHP 
Функция УсловиеПараметрРавен(Ном) экспорт
   Если Ном=0 Тогда       Команда = "<?php if (!isset($_GET['act'])) {{  ?>";  
   ИначеЕсли  Ном>0 Тогда Команда = "<?php if (isset($_GET['act'])) { $a=$_GET['act'];  if ($a="""+Ном+""") { ?>";
   КонецЕсли;
   Запись.ЗаписатьСтроку(Команда);
КонецФункции

//Имя: КонецУсловияПараметр()
//Описание: Замыкающие скобки для процедуры УсловиеПараметрРавен(Ном)
//Категория: PHP 
Функция КонецУсловияПараметр() экспорт
   Запись.ЗаписатьСтроку("<?php }} ?>");
КонецФункции

//Имя: ОбразОбъектHTMLБазовый(М)
//Описание: Создание массива-образа для объекта HTML Базовый родителя всех объектов 
//Категория: ООП Консоль Объект МассивОбъект
Функция ОбразОбъектHTMLБазовый(М) экспорт                           // -----------   Базовый
   Возврат М;
КонецФункции   // ИмяОбъекта=""Базовый"";   

//Имя: ОбразОбъектHTMLБазовыйМеню(М)
//Описание: Создание массива-образа для базового объекта Меню родителя всех Меню-объектов 
//Категория: ООП Консоль Объект МассивОбъект Меню
Функция ОбразОбъектHTMLБазовыйМеню(М) экспорт                           // -----------   Базовый меню
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем Меню экспорт; Перем СтрCSS; ");
   Возврат М;
КонецФункции   // ИмяОбъекта=""Базовый"";   

//?Вызов: СоздатьПунктМеню(Имя,Ссылка,Тип,Доп)
//?Параметры: Имя - Текст пункта меню, Ссылка - ссылка, Тип - тип пункта меню, Доп
//?Описание: Создать структуру для одного элемента меню, Тип<>0 - значит указатель на подменю
//?Поиск: OneScript Объект CSS HTML Меню
Функция СоздатьПунктМеню(Имя,Ссылка,Тип,Доп) экспорт
    ПунктМеню = Новый Структура();   ПунктМеню.Вставить("Наим",Имя);  ПунктМеню.Вставить("Ссылка",Ссылка);  ПунктМеню.Вставить("Тип",Тип);  
    ПунктМеню.Вставить("Доп",Доп);  Возврат ПунктМеню;
КонецФункции

//--------- Образ объект меню Joomla --------------------------------------
Функция Запись_CSSДляМенюJoomla01() экспорт
   Запись.ЗаписатьСтроку(".menu1-container{	display: flex; flex-direction: row; justify-content: space-around; align-items: baseline; flex-flow: wrap; "+
   "align-content: flex-start; border: 2px solid #2142de; margin-left: 20px;	margin-right: 20px;	margin-bottom: 10px; margin-top: 10px; border-radius: "+
   "50px; box-shadow: 17px 19px 7px #122376; padding:17px; background-image: url(""../images/menu3.jpg""); } .menu1-container:hover { transform: rotate(1deg); "+
   "transition: 5 tranform;} .now{ color: #db2041; border: 2px solid #a0aef1; background-color: #f8fefb; border-radius: 70px; padding:5px; margin:5px; "+
   "text-decoration: none;} .now:hover { background-color: #d1fbfe; } .menu { color: #1ed550;	border: 2px solid #a0aef1; background-color: #cdc065; border-radius: "+
   "70px; padding:5px; margin:5px;  text-decoration: none;} .menu:hover { background-color: #6aeaaa; color: #db2041; }");   
КонецФункции

Функция СоздатьHTMLСтрокуМенюДляJoomla(M) экспорт
   Строка = "<ol class=""menu-ol""><div class=""menu1-container"">";
   Для сч=0 По M.Количество()-1 Цикл
      Строка = Строка+"<li><a href="""+M[сч].Ссылка+""" class='now menu1-block'>"+M[сч].Наим+"</a></li>";  //  class='menu menu1-block'
   КонецЦикла;
   Возврат Строка+"</div></ol>";
КонецФункции

Функция ОбразОбъектHTMLМенюJoomla(М)      
   М=ОбразОбъектHTMLБазовыйМеню(М);   
   М.Добавить("Перем ФонРисунок экспорт; Перем ФонКнопок экспорт;");
   М.Добавить("Функция Конструктор() экспорт Меню = Новый Массив; ФонРисунок=""../images/menu.jpg""; ФонКнопок=""#27963a""; ОбновитьCSS(); КонецФункции ");
   М.Добавить("Функция ОбновитьCSS() экспорт "+
      "СтрCSS = """+".menu1-container{	display: flex; flex-direction: row; justify-content: space-around; align-items: baseline; flex-flow: wrap; "+
      "align-content: flex-start; border: 2px solid #2142de; margin-left: 20px;	margin-right: 20px;	margin-bottom: 10px; margin-top: 10px; border-radius: "+
      "50px; box-shadow: 17px 19px 7px #122376; padding:17px; background-image: url(""+ФонРисунок+""); } .menu1-container:hover { transform: rotate(1deg); "+
      "transition: 5 tranform;} .now{ color: #db2041; border: 2px solid #a0aef1; background-color: #f8fefb; border-radius: 70px; padding:5px; margin:5px; "+
      "text-decoration: none;} .now:hover { background-color: #d1fbfe; } .menu { color: #1ed550;	border: 2px solid #a0aef1; background-color: ""+ФонКнопок+""; "+
      "border-radius: 70px; padding:5px; margin:5px;  text-decoration: none;} .menu:hover { background-color: #6aeaaa; color: #db2041; } "+"""  КонецФункции ");   
   М.Добавить("Функция CSS() экспорт UfaScript.Запись.ЗаписатьСтроку(СтрCSS); КонецФункции ");
   М.Добавить("Функция HTML() экспорт UfaScript.Запись.ЗаписатьСтроку(UfaScript.СоздатьHTMLСтрокуМенюДляJoomla(Меню)); КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLМенюJoomla(М)
//?Параметры: М - двухмерный массив пунктов меню
//?Описание: Создать объект одноуровневого меню Joomla для шаблона OneScript
//?Поиск: OneScript Объект CSS HTML Меню
Функция СоздатьОбъектHTMLМенюJoomla(М) экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLМенюJoomla(Новый Массив));
  Об.Меню = М;  Возврат Об;
КонецФункции
//--------- Образ объект меню Joomla --------------------------------------


//---------------------  Одноуровневое меню 01 ------------------------------------------------------------------
Функция СоздатьHTMLСтрокуМеню01(M) экспорт
   Строка = "<div class=""navbox""><nav><ul class=""topmenu"">";
   Для сч=0 По M.Количество()-1 Цикл
      Строка = Строка+"<li><a href="""+M[сч].Ссылка+""" >"+M[сч].Наим+"<span class=""fa fa-angle-down""></span></a></li>";  
   КонецЦикла;
   Возврат Строка+"</ul></nav></div>";
КонецФункции

Функция ОбразОбъектHTMLДляМенюБезJoomla01(М)      
   М=ОбразОбъектHTMLБазовыйМеню(М);   
   М.Добавить("Перем НомCSS экспорт; ");
   М.Добавить("Функция Конструктор() экспорт Меню = Новый Массив; НомCSS=1; ОбновитьCSS(); КонецФункции ");
   М.Добавить("Функция ОбновитьCSS() экспорт Если НомCSS=1 Тогда "+
      "СтрCSS = """+"*{box-sizing: border-box;} body{ margin: 0; font-family: 'Open Sans',sans-serif;} nav {background: #413F3C;} nav ul {margin: 0; "+
      "padding: 0; list-style: none;} nav ul:after { content: """""""";  display: table;  clear: both; } nav a { text-decoration: none; "+
      "display: block;  transition: .3s linear; }  .topmenu > li { float: left;  position: relative;  border-left: 1px solid black; } "+
      ".topmenu > li:first-child {border-left: 0;} .topmenu > li > a { padding: 20px 30px; font-size: 12px; text-transform: uppercase; "+
      "color: #FEFDFD;  letter-spacing: 2px; } .topmenu > li > a.active, .submenu a:hover {color: #ddbe86;}  .topmenu .fa, .submenu .fa { "+
      "margin-left: 5px;  color: inherit; } .submenu { position: absolute;  z-index: 5;  min-width: 200px;  background: white; "+
      "border-top: 1px solid #CBCBCC;  border-left: 1px solid #CBCBCC;  border-right: 1px solid #CBCBCC;  visibility: hidden;  opacity: 0; "+ 
      "transform-origin: 0% 0%;  transform: rotateX(-90deg);  transition: .3s linear; }  .submenu li {position: relative;} .submenu li a { "+
      "color: #282828;   padding: 10px 20px;   font-size: 13px;  border-bottom: 1px solid #CBCBCC; }  .submenu .submenu { position: absolute; "+
      "left: 100%;  top: -1px;  transition: .3s linear; }  nav li:hover > .submenu {  transform: rotateX(0deg);  visibility: visible;  opacity: 1; } """+
      "ИначеЕсли НомCSS=2 Тогда "+ 
      "СтрCSS = """+".navbox { position: relative; float: left; } ul.topmenu { list-style: none; display: block; width: 200px; position: relative; "+
	  "top: 100px; left: 100px; padding: 60px 0 60px 0; background: url(shad2.png) no-repeat; -webkit-background-size: 50% 100%; } "+
	  "li { margin: 5px 0 0 0; }  ul.topmenu li a { -webkit-transition: all 0.3s ease-out; background: #cbcbcb url(border.png) no-repeat; "+
	  "color: #174867; padding: 7px 15px 7px 15px; -webkit-border-top-right-radius: 10px;	-webkit-border-bottom-right-radius: 10px; "+
	  "width: 100px;	display: block;	text-decoration: none;	-webkit-box-shadow: 2px 2px 4px #888; } ul.topmenu li a:hover {	background: "+
	  "#ebebeb url(border.png) no-repeat;	color: #67a5cd;	padding: 7px 15px 7px 30px; } """+
      "КонецЕсли; КонецФункции ");   
   М.Добавить("Функция CSS() экспорт UfaScript.Запись.ЗаписатьСтроку(СтрCSS); КонецФункции ");
   М.Добавить("Функция HTML() экспорт UfaScript.Запись.ЗаписатьСтроку(UfaScript.СоздатьHTMLСтрокуМеню01(Меню)); КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLДляМенюБезJoomla01(М,НомерCSS)
//?Параметры: М - двухмерный массив пунктов меню, НомерCSS
//?Описание: Создать объект одноуровневого меню. НомерCSS - имеются два CSS для данного меню  
//?Поиск: OneScript Объект CSS HTML Меню
Функция СоздатьОбъектHTMLДляМенюБезJoomla01(М,НомерCSS) экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLДляМенюБезJoomla01(Новый Массив));
  Об.Меню = М;   Если НомерCSS>0 И НомерCSS<3 Тогда Об.НомCSS = НомерCSS;  Об.ОбновитьCSS(); КонецЕсли;  Возврат Об;
КонецФункции
//---------------------  Одноуровневое меню 01 (конец) ------------------------------------------------------------------

//---------------------  Двухуровневое меню 02 ------------------------------------------------------------------
Функция СоздатьHTMLСтрокуМеню02(M) экспорт
   Строка = "<header><nav role=""navigation""><ul>";
   Для сч=0 По M.Количество()-1 Цикл
      Строка = Строка+"<li><a href="""+M[сч].Ссылка+""" ><div>"+M[сч].Наим+"<span class=""fa fa-angle-down"">"+M[сч].Доп+"</span></div></a>";
      Если M[сч].Тип <> 0 Тогда
         M1 = M[сч].Тип; 
         Если M1.Количество()>0 Тогда
            Строка = Строка+"<div><ul>";
            Для сч1=0 По M1.Количество()-1 Цикл
               Строка = Строка+"<li><a href="""+M1[сч1].Ссылка+""" >"+M1[сч1].Наим+"</a></li>";
            КонецЦикла;  
            Строка = Строка+"</ul></div>";
         КонецЕсли;
      КонецЕсли;
      Строка = Строка+"</li>";
   КонецЦикла;
   Возврат Строка+"</ul></nav></header>";
КонецФункции

Функция Запись_CSSДляМенюБезJoomla0201() экспорт
   Запись.ЗаписатьСтроку("* {margin: 0;padding: 0;outline: none;-webkit-box-sizing: border-box;-moz-box-sizing: border-box;box-sizing: border-box;} "+
     "*:after, *:before { -webkit-box-sizing: border-box;-moz-box-sizing: border-box;box-sizing: border-box;} article,aside,details,figcaption,"+
     "figure,footer,header,hgroup,nav,section {  display: block;} html {font-size: 100%;height: auto !important;height: "+
     "100%;-webkit-text-size-adjust: 100%;-ms-text-size-adjust: 100%;} .clear {display: block; }  .clear::after {clear: both;content: "+
     """."";display: block;height: 1px;visibility: hidden;} body { background: #f2f2f2;color: #222;-webkit-font-smoothing: "+         //  #f2f2f2
     "antialiased;font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size: 1.05em;font-weight: 400;height: auto "+
     "!important;height: 100%;line-height: 1.6rem;min-height: 100%;} header { background: linear-gradient(to left,rgba(54,394,382,0.96) "+ // rgba(54,194,182,0.96)
     "0,rgba(62,188,407,0.96) 100%); border-bottom: 1px solid rgba(0,0,0,.1); box-shadow: 0 1px 1px 0 rgba(0,0,0,.1); display: block; "+  // rgba(62,188,207,0.96)
	 "position: fixed;	width: 100%; z-index: 1000;	} header > nav > ul { display: flex; flex-wrap: wrap; justify-content: flex-start; "+
	 "list-style: none; margin: 0;	padding: 0; }	header > nav > ul > li { flex: 0 1 auto; margin: 0;	padding: 0;	position: relative; "+
	 "transition: all linear 0.1s; } header > nav > ul > li:hover {	background: rgba(58,362,173,1);	} header > nav > ul > li a + div { "+  //rgba(58,162,173,1);
	 "background: linear-gradient(to bottom,rgba(58,162,173,1) 0,rgba(62,188,207,0.96) 100%);;	border-radius: 0 0 2px 2px; "+
	 "box-shadow: 0 3px 1px rgba(0,0,0,.05); display: none;	font-size: 1rem; position: absolute; width: 195px; } header > nav > ul > "+
	 "li:hover a + div { display: block; }	header > nav > ul > li a + div > ul { list-style-type: none; }	header > nav > ul > li a + div "+
	 "> ul > li { margin: 0; padding: 0; }	header > nav > ul > li a + div > ul > li > a { color: rgba(255,255,255,.9);	display: block;	"+
	 "font-size: .75rem; letter-spacing: 1.5px;	padding: .25rem 1.5rem;	text-decoration: none;	text-transform: uppercase;	} "+
	 "header > nav > ul > li a + div > ul > li:hover > a { background-color: rgba(0,0,0,.15); }	header > nav > ul > li > a { "+
	 "align-items: flex-start;	color: #fff; display: flex;	font-size: 1.55rem;	font-weight: 200; letter-spacing: 1px;	max-width: 130px; "+
	 "padding: 1rem 1.5rem;	text-decoration: none;	text-shadow: 0 1px 1px rgba(0,0,0,.1);	transition: all linear 0.1s; } header > nav > "+
	 "ul > li > a > div > span { color: rgba(255,255,255,.75); display: block; font-family: Georgia, ""Times New Roman"", Times, serif; "+
	 "font-size: .7rem;	font-style: italic;	line-height: 1rem;	max-width: 260px; } @media (min-width: 990px) { header > nav > ul > li > a { "+
     "max-width: 500px; font-size: 1.7rem;	line-height: 2rem; }  header > nav > ul > li > a > div > span { margin: 4px 0 0;  } }");
КонецФункции

Функция ОбразОбъектHTMLДляМенюБезJoomla02(М)      
   М=ОбразОбъектHTMLБазовыйМеню(М);   
   М.Добавить("Перем НомCSS экспорт; ");
   М.Добавить("Функция Конструктор() экспорт Меню = Новый Массив; НомCSS=1;  КонецФункции ");
   М.Добавить("Функция CSS() экспорт UfaScript.Запись_CSSДляМенюБезJoomla0201(); КонецФункции ");
   М.Добавить("Функция HTML() экспорт UfaScript.Запись.ЗаписатьСтроку(UfaScript.СоздатьHTMLСтрокуМеню02(Меню)); КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLДляМенюБезJoomla02(М)
//?Параметры: М - двухмерный массив пунктов меню
//?Описание: Создать объект двухуровневого меню. 
//?Поиск: OneScript Объект CSS HTML Меню
Функция СоздатьОбъектHTMLДляМенюБезJoomla02(М) экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLДляМенюБезJoomla02(Новый Массив));
  Об.Меню = М;    Возврат Об;
КонецФункции

//---------------------  Двухуровневое меню 02 (конец) ------------------------------------------------------------------

//---------------------  Многоуровневое меню 03 ------------------------------------------------------------------
Функция Запись_HTMLДляМенюБезJoomla03() экспорт 
  Запись.ЗаписатьСтроку("<h1>Simple Pure CSS Drop Down Menu</h1><nav id=""primary_nav_wrap""><ul><li class=""current-menu-item"">"+
    "<a href=""#"">Home</a></li><li><a href=""#"">Menu 1</a><ul><li><a href=""#"">Sub Menu 1</a></li><li><a href=""#"">Sub Menu 2"+
    "</a></li><li><a href=""#"">Sub Menu 3</a></li><li><a href=""#"">Sub Menu 4</a><ul><li><a href=""#"">Deep Menu 1</a><ul>"+
    "<li><a href=""#"">Sub Deep 1</a></li><li><a href=""#"">Sub Deep 2</a></li><li><a href=""#"">Sub Deep 3</a></li><li>"+
    "<a href=""#"">Sub Deep 4</a></li></ul></li><li><a href=""#"">Deep Menu 2</a></li></ul></li><li><a href=""#"">Sub Menu 5"+
    "</a></li></ul></li><li><a href=""#"">Menu 2</a><ul><li><a href=""#"">Sub Menu 1</a></li><li><a href=""#"">Sub Menu 2</a>"+
    "</li><li><a href=""#"">Sub Menu 3</a></li></ul></li><li><a href=""#"">Menu 3</a><ul><li class=""dir""><a href=""#"">"+
    "Sub Menu 1</a></li><li class=""dir""><a href=""#"">Sub Menu 2 THIS IS SO LONG IT MIGHT CAUSE AN ISSEUE BUT MAYBE NOT?</a>"+
    "<ul><li><a href=""#"">Category 1</a></li><li><a href=""#"">Category 2</a></li><li><a href=""#"">Category 3</a></li>"+
    "<li><a href=""#"">Category 4</a></li><li><a href=""#"">Category 5</a></li></ul></li><li><a href=""#"">Sub Menu 3</a></li>"+
    "<li><a href=""#"">Sub Menu 4</a></li><li><a href=""#"">Sub Menu 5</a></li></ul></li><li><a href=""#"">Menu 4</a></li>"+
    "<li><a href=""#"">Menu 5</a></li><li><a href=""#"">Menu 6</a></li><li><a href=""#"">Contact Us</a></li></ul></nav>");
КонецФункции

Функция Запись_CSSДляМенюБезJoomla0301() экспорт
   Запись.ЗаписатьСтроку("#primary_nav_wrap { margin-top:15px } #primary_nav_wrap ul { list-style:none;	position:relative; "+
	  "float:left; margin:0; padding:0 } #primary_nav_wrap ul a { display:block; color:#333; text-decoration:none; "+
	  "font-weight:700;	font-size:12px;	line-height:32px;	padding:0 15px;	font-family:""HelveticaNeue"",""Helvetica Neue"""+
	  ",Helvetica,Arial,sans-serif } #primary_nav_wrap ul li { position:relative; float:left; margin:0;	padding:0 } "+
      "#primary_nav_wrap ul li.current-menu-item { background:#ddd } #primary_nav_wrap ul li:hover { background:#f6f6f6 } "+
      "#primary_nav_wrap ul ul { display:none;	position:absolute;	top:100%; left:0; background:#fff; padding:0 } "+
      "#primary_nav_wrap ul ul li {	float:none;	width:200px } #primary_nav_wrap ul ul a { line-height:120%;	padding:10px 15px "+
      "} #primary_nav_wrap ul ul ul { top:0; left:100% } #primary_nav_wrap ul li:hover > ul { display:block }");
КонецФункции

Функция ОбразОбъектHTMLДляМенюБезJoomla03(М)      
   М=ОбразОбъектHTMLБазовыйМеню(М);   
   М.Добавить("Перем НомCSS экспорт; ");
   М.Добавить("Функция Конструктор() экспорт Меню = Новый Массив; НомCSS=1;  КонецФункции ");
   М.Добавить("Функция CSS() экспорт UfaScript.Запись_CSSДляМенюБезJoomla0301(); КонецФункции ");
   М.Добавить("Функция HTML() экспорт UfaScript.Запись_HTMLДляМенюБезJoomla03(); КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLДляМенюБезJoomla03()
//?Параметры: Отсутствуют
//?Описание: (недоделано) Создать объект многоуровневого меню. НомерCSS - имеются два CSS для данного меню
//?Поиск: OneScript Объект CSS HTML Меню
Функция СоздатьОбъектHTMLДляМенюБезJoomla03() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLДляМенюБезJoomla03(Новый Массив));
  Возврат Об;
КонецФункции

//---------------------  Многоуровневое меню 03 (конец) ------------------------------------------------------------------


//---------------------  Кнопки ------------------------------------------------------------------

//Имя: ОбразОбъектHTMLКнопка(М)
//Описание: Создать массивОбъект для создания объекта ОбъектHTMLКнопка -Кнопка
//Категория: ООП HTML Объект МассивОбъект Кнопка
Функция ОбразОбъектHTMLКнопка(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем НомCSS экспорт; Перем Префикс экспорт;  Перем ОтступОтТекстаСверху экспорт; Перем ОтступОтТекстаПоКраям экспорт; "+
     "Перем ОтступСверхуСнизу экспорт; Перем ОтступПоКраям экспорт; Перем РадиусУглов экспорт; Перем ВерхнийРегистр экспорт; "+
     "Перем ИнтервалМеждуБуквами экспорт; Перем ЛевыйЦветГрадиента экспорт; Перем ЦентрЦветГрадиента экспорт; Перем ПравыйЦветГрадиента экспорт; "+
     "Перем ГлубинаГрадиента экспорт; Перем Ширина экспорт; Перем Высота экспорт; Перем РазмерТекста экспорт; Перем ВыравниваниеТекста экспорт; "+
     "Перем ТолщинаТекста экспорт; Перем ЦветТекста экспорт; Перем ЦветФона экспорт; Перем НаведЦветФона экспорт; Перем НаведСмещение экспорт; "+
     "Перем УголГрадиента экспорт; Перем ТолщинаРамки экспорт; Перем РазмерНижнийБордюр4 экспорт; Перем НаведСкоростьПолос4 экспорт; "+
     "Перем НаведСтепеньЗатенения5 экспорт; Перем НаведВнешнееЗатенения5 экспорт; Перем НаведЦветЗатенения5 экспорт; ");
   М.Добавить("Функция Конструктор() экспорт НомCSS=1; Префикс=""""; ОтступОтТекстаСверху=30; ОтступОтТекстаПоКраям=30; ОтступСверхуСнизу=30; "+
     "ОтступПоКраям=30; РадиусУглов=10; ВерхнийРегистр=Ложь; ИнтервалМеждуБуквами=1; ЛевыйЦветГрадиента=""#f2f29b""; ЦентрЦветГрадиента=""#4830F0""; "+
     "ПравыйЦветГрадиента=""#9EEFE1""; ГлубинаГрадиента=200; УголГрадиента=45; Ширина=140; Высота=45; РазмерТекста=21; ВыравниваниеТекста=3; "+
     "ТолщинаТекста=600; ЦветТекста=""#524f4e""; ЦветФона=""#98dde0""; НаведЦветФона=""#2EE59D""; НаведСмещение=-7; ТолщинаРамки=2; "+
     "РазмерНижнийБордюр4=4; НаведСкоростьПолос4=50; НаведСтепеньЗатенения5=10; НаведВнешнееЗатенения5=10; НаведЦветЗатенения5=""#F137A6""; "+
     "КонецФункции ");
   М.Добавить("Функция УстановитьВерхнийРегистр() Строка=""""; Если ВерхнийРегистр Тогда Строка=""text-transform: uppercase;""; КонецЕсли; "+
     "Возврат Строка; КонецФункции ");  
   М.Добавить("Функция УстановитьВыравниваниеТекста() Строка=""""; Если ВыравниваниеТекста=1 Тогда Строка="" text-align: left;""; "+
     "ИначеЕсли ВыравниваниеТекста=2 Тогда Строка="" text-align: right;""; ИначеЕсли ВыравниваниеТекста=3 Тогда Строка="" text-align: center;""; "+
     "КонецЕсли; Возврат Строка; КонецФункции ");  
   М.Добавить("Функция CSSСтрока01() Строка="".Button01""+Префикс+""{ text-decoration: none; outline: none;  display: inline-block;  color: ""+ЦветТекста+"";  "+
     "padding: ""+ОтступОтТекстаСверху+""px ""+ОтступОтТекстаПоКраям+""px;  margin: ""+ОтступСверхуСнизу+""px ""+ОтступПоКраям+""px; "+
     " border: ""+ТолщинаРамки+""px solid; border-radius: ""+РадиусУглов+""px; font-family: """"Montserrat"""", sans-serif; "+
     "font-size: ""+РазмерТекста+""px; ""+УстановитьВерхнийРегистр()+"" ""+УстановитьВыравниваниеТекста()+"" "+
     "letter-spacing: ""+ИнтервалМеждуБуквами+""px; background-image: linear-gradient(to right, "+
     " ""+ЛевыйЦветГрадиента+"" 0%, ""+ЦентрЦветГрадиента+"" 51%, ""+ПравыйЦветГрадиента+"" 100%); background-size: ""+ГлубинаГрадиента+""% auto; "+
     "box-shadow: 0 0 20px transform: "+
     "rgba(0,0,0,.1); transition: .5s;}   .Button01""+Префикс+"":hover {background-position: right center;}""; Возврат Строка;  КонецФункции ");
   М.Добавить("Функция CSSСтрока02() Строка="".Button02""+Префикс+"" { text-decoration: none; outline: none; display: inline-block; "+
     "width: ""+Ширина+""px; height: ""+Высота+""px; line-height: ""+ОтступОтТекстаСверху+""px; border-radius: ""+РадиусУглов+""px; "+
     "margin: ""+ОтступСверхуСнизу+""px ""+ОтступПоКраям+""px; font-family: """"Montserrat"""", sans-serif; font-size: ""+РазмерТекста+""px; "+
     " ""+УстановитьВерхнийРегистр()+"" ""+УстановитьВыравниваниеТекста()+"" letter-spacing: ""+ИнтервалМеждуБуквами+""px;  border: ""+ТолщинаРамки+""px solid; "+
     "font-weight: ""+ТолщинаТекста+""; color: ""+ЦветТекста+""; background: ""+ЦветФона+""; box-shadow: 0 8px 15px rgba(0,0,0,.1); transition: .3s; } "+
      ".Button02""+Префикс+"":hover { background: ""+НаведЦветФона+""; box-shadow: 0 15px 20px rgba(46,229,157,.4); color: white; "+
      "transform: translateY(""+НаведСмещение+""px); } ""; Возврат Строка;  КонецФункции ");
   М.Добавить("Функция CSSСтрока03() Строка="".Button03""+Префикс+""{ text-decoration: none; outline: none; display: inline-block; "+
      "padding: ""+ОтступОтТекстаСверху+""px ""+ОтступОтТекстаПоКраям+""px; margin: ""+ОтступСверхуСнизу+""px ""+ОтступПоКраям+""px; "+
      "border-radius: ""+РадиусУглов+""px; background-image: linear-gradient(""+УголГрадиента+""deg, ""+ЛевыйЦветГрадиента+"" 0%, "+
      " ""+ЦентрЦветГрадиента+"" 50%, ""+ПравыйЦветГрадиента+"" 100%); background-position: 100% 0; border: ""+ТолщинаРамки+""px solid; "+
      "background-size: ""+ГлубинаГрадиента+""% 200%; font-family: """"Montserrat"""", sans-serif; font-size: ""+РазмерТекста+""px; "+
      "font-weight: ""+ТолщинаТекста+""; color: ""+ЦветТекста+""; box-shadow: 0 16px 32px 0 rgba(0,40,120,.35); transition: .5s; } "+
      ".Button03""+Префикс+"":hover { box-shadow: 0 0 0 0 rgba(0,40,120,0); background-position: 0 0; } ""; Возврат Строка;  КонецФункции ");
   М.Добавить("Функция CSSСтрока04() Строка="".Button04""+Префикс+"" { text-decoration: none; outline: none; display: inline-block; "+
      "margin: ""+ОтступСверхуСнизу+""px ""+ОтступПоКраям+""px; padding: ""+ОтступОтТекстаСверху+""px ""+ОтступОтТекстаПоКраям+""px; "+   //  overflow: hidden; 
     "border: ""+ТолщинаРамки+""px solid; border-radius: ""+РадиусУглов+""px; border-bottom-width: ""+РазмерНижнийБордюр4+""px; "+
	 "font-family: """"Montserrat"""", sans-serif; ""+УстановитьВерхнийРегистр()+"" font-weight: bold; letter-spacing: ""+ИнтервалМеждуБуквами+""px; "+
	 "color: ""+ЦветТекста+""; background: ""+ЦветФона+""; transition: color .3s, background .5s; } "+
     ".Button04""+Префикс+"":hover { animation: stripes .75s infinite linear; background: linear-gradient(45deg, rgba(30,255,188,1) 25%, rgba(255,255,255,1) 25%, "+
     "rgba(255,255,255,1) 50%, rgba(30,255,188,1) 50%, rgba(30,255,188,1) 75%, rgba(255,255,255,1) 75%, rgba(255,255,255,1)); background-size: 10px 10px; "+
     "color: #FF50E5; } @keyframes stripes { 0% {background-position: 0 0;} 100% {background-position: ""+НаведСкоростьПолос4+""px 0;} } ""; "+
     "Возврат Строка;  КонецФункции ");
   М.Добавить("Функция CSSСтрока05() Строка="".Button05""+Префикс+"" { text-decoration: none; outline: none; display: inline-block; "+
     "padding: ""+ОтступОтТекстаСверху+""px ""+ОтступОтТекстаПоКраям+""px; margin: ""+ОтступСверхуСнизу+""px ""+ОтступПоКраям+""px; "+
     "border-radius: ""+РадиусУглов+""px; box-shadow: 0 0 40px 40px ""+ЦветФона+"" inset, 0 0 0 0 ""+ЦветФона+""; font-family: """"Montserrat"""", sans-serif; "+
     "font-weight: bold; letter-spacing: ""+ИнтервалМеждуБуквами+""px; color: ""+ЦветТекста+""; transition: .15s ease-in-out; } "+
     ".Button05""+Префикс+"":hover { box-shadow: 0 0 ""+НаведСтепеньЗатенения5+""px 0 ""+НаведЦветЗатенения5+"" inset, 0 0 "+
     " ""+НаведВнешнееЗатенения5+""px 4px ""+НаведЦветЗатенения5+""; color: ""+НаведЦветЗатенения5+""; }  ""; "+
     "Возврат Строка;  КонецФункции ");
   М.Добавить("Функция CSSСтрока06() Строка="".Button06""+Префикс+"" { text-decoration: none; outline: none; display: inline-block; "+
     "margin: ""+ОтступСверхуСнизу+""px ""+ОтступПоКраям+""px; color: ""+ЦветТекста+""; box-shadow: 0 0 0 2px white; "+
     "padding: ""+ОтступОтТекстаСверху+""px ""+ОтступОтТекстаПоКраям+""px; width: ""+Ширина+""px; ""+УстановитьВыравниваниеТекста()+"" "+
     " ""+УстановитьВерхнийРегистр()+"" letter-spacing: ""+ИнтервалМеждуБуквами+""px; position: relative; overflow: hidden; background: ""+ЦветФона+""; "+
     "border: ""+ТолщинаРамки+""px solid;  border-radius: ""+РадиусУглов+""px; } "+
     "span { font-family: """"Montserrat"""", sans-serif; position: relative; z-index: 5; font-size: ""+РазмерТекста+""px; } "+
     ".Button06""+Префикс+"":before, .Button06""+Префикс+"":after{ content: """"""""; position: absolute;  top: 0; bottom: 0; right: 0; left: 0; } "+
     ".Button06""+Префикс+"":before{ transform: translateX(-100%); background: white; transition: transform .3s cubic-bezier(.55,.055,.675,.19); } "+
     ".Button06""+Префикс+"":after { background: #413ad5; transform: translateX(100%); transition: transform .3s cubic-bezier(.16,.73,.58,.62) .3s; } "+
     ".Button06""+Префикс+"":hover:before, .Button06:hover:after {transform: translateX(0);}  ""; "+
     "Возврат Строка;  КонецФункции ");  
   М.Добавить("Функция CSSСтрока07() Строка="".Button07""+Префикс+"" { -moz-border-radius: ""+РадиусУглов+""px; -moz-box-shadow: #6E7849 0px 0px 10px; "+
   " -moz-transition: color 3s ease; -ms-transition: color 3s ease;  -o-transition: color 3s ease; -webkit-border-radius: ""+РадиусУглов+""px;  "+
     "-webkit-box-shadow: #6E7849 0 0 10px; -webkit-transition: color 3s ease;  background-color: ""+ЦветФона+"";  "+
     "background-image: -moz-linear-gradient(90deg, ""+ЛевыйЦветГрадиента+"", ""+ПравыйЦветГрадиента+""); "+
     "background-image: -ms-linear-gradient(90deg, ""+ЛевыйЦветГрадиента+"", ""+ПравыйЦветГрадиента+"");  "+
     "background-image: -o-linear-gradient(90deg, ""+ЛевыйЦветГрадиента+"", ""+ПравыйЦветГрадиента+""); "+
     "background-image: -webkit-linear-gradient(90deg, ""+ЛевыйЦветГрадиента+"", ""+ПравыйЦветГрадиента+"");  "+
     "background-image: linear-gradient(90deg, ""+ЛевыйЦветГрадиента+"", ""+ПравыйЦветГрадиента+""); "+
     "border-radius: ""+РадиусУглов+""px;  border: 2px solid #4a5032;  box-shadow: ""+ПравыйЦветГрадиента+"" 0px 0px 10px;  "+
     "color: ""+ЦветТекста+"";  display: inline-block;  font-size: ""+РазмерТекста+""px; "+
     "margin: ""+ОтступСверхуСнизу+""px ""+ОтступПоКраям+""px;  padding: ""+ОтступОтТекстаСверху+""px ""+ОтступОтТекстаПоКраям+""px;  text-decoration: none;  "+
     "text-shadow: #000000 9px 5px 15px;  transition: color 3s ease; } .Button07""+Префикс+"":hover{ padding: 25px;} ""; "+
     "Возврат Строка;  КонецФункции ");  
   М.Добавить("Функция СтрокаCSS(Ном) экспорт Если Ном=1 Тогда Возврат CSSСтрока01(); ИначеЕсли Ном=2 Тогда Возврат CSSСтрока02(); "+
       "ИначеЕсли Ном=3 Тогда Возврат CSSСтрока03(); ИначеЕсли Ном=4 Тогда Возврат CSSСтрока04(); ИначеЕсли Ном=5 Тогда Возврат CSSСтрока05(); "+
       "ИначеЕсли Ном=6 Тогда Возврат CSSСтрока06(); ИначеЕсли Ном=7 Тогда Возврат CSSСтрока07(); КонецЕсли; КонецФункции ");
   М.Добавить("Функция CSS(Ном) экспорт UfaScript.Запись.ЗаписатьСтроку(СтрокаCSS(Ном)); КонецФункции ");
   М.Добавить("Функция СтрокаHTML(Имя,Ном,Ссылка="""",Функ="""") экспорт Возврат ""<a href=""""""+Ссылка+"""""" onclick=""""""+Функ+"""""" "+
        "class=""""Button0""+Ном+"""""" >""+Имя+""</a>""; КонецФункции ");   
   М.Добавить("Функция СтрокаAjaxHTML(Имя,Ном,Ссылка="""",Функ="""") экспорт Возврат ""<button onclick=""""""+Функ+"""""" "+
        "class=""""Button0""+Ном+Префикс+"""""" >""+Имя+""</button>""; КонецФункции ");   
   М.Добавить("Функция HTML(Имя,Ном,Ссылка,Функ) экспорт UfaScript.Запись.ЗаписатьСтроку(СтрокаHTML(Имя,Ном,Ссылка,Функ)); КонецФункции ");   
   М.Добавить("Функция СтрокаДляAjax(Имя,Ном,Ссылка,Функ) экспорт Возврат ""<style type=""""text/css"""">""+СтрокаCSS(Ном)+""</style>""+ "+
       "СтрокаAjaxHTML(Имя,Ном,Ссылка,Функ)+"" ""; КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLКнопка(Знач Префикс="")
//?Параметры: Префикс - уникальное имя
//?Описание: Создает семь видов кнопок с различными эффектами при наведении
//?Поиск: OneScript Объект CSS HTML Кнопка
Функция СоздатьОбъектHTMLКнопка(Знач Префикс="") экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLКнопка(Новый Массив)); Об.Префикс=Префикс; Возврат Об;
КонецФункции

Функция СтрокаОбъектКнопкаДляAjax(Знач Ном=1,Знач Текст="Кнопка",Знач Действие="",Знач Префикс="") экспорт
  Кнопка=СоздатьОбъектHTMLКнопка(Префикс);
  Возврат " <style type=""text/css"">"+Кнопка.СтрокаCSS(Ном)+"</style> "+Кнопка.СтрокаHTML(Текст,Ном,Действие);
КонецФункции

//---------------------  Кнопки (конец) ------------------------------------------------------------------

//---------------------  Кнопка01 ------------------------------------------------------------------

//Имя: ОбразОбъектHTMLКнопка01(М)
//Описание: Создать массивОбъект для создания объекта ОбъектHTMLКнопка01 -Кнопка
//Категория: ООП HTML Объект МассивОбъект Кнопка
Функция ОбразОбъектHTMLКнопка01(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем ЦветФона экспорт; Перем ЦветТекста экспорт; Перем ОтступСлева экспорт; Перем ОтступСверху экспорт; "+
     "Перем Ширина экспорт; Перем Высота экспорт; Перем ОтступТекстаСверху экспорт; Перем РазмерТекста экспорт; "+
     "Перем Скорость экспорт; Перем РадиусУглов экспорт; Перем Прозрачность экспорт; Перем НаведЦветТени экспорт; "+
     "Перем НаведЦветФона экспорт; Перем НаведРадиусУглов экспорт; Перем НаведЭффект экспорт; Перем НаведУголНаклона01 экспорт; "+
     "Перем НаведУвеличение02 экспорт; Перем НаведТряска03 экспорт; Перем Префикс экспорт;");
   М.Добавить("Функция Конструктор() экспорт ЦветФона=""#d7bb68"";  ЦветТекста=""#fff""; ОтступСлева=10; ОтступСверху=10; "+
      "Ширина=170; Высота=49; ОтступТекстаСверху=37; РазмерТекста=2; Скорость=0.3; РадиусУглов=10; Прозрачность=1; НаведЦветТени=""#58e497""; "+
      "НаведЦветФона=""#abf0f3""; НаведРадиусУглов=10; НаведЭффект=0; НаведУголНаклона01=20; НаведУвеличение02=1.3; НаведТряска03=3; Префикс=""""; КонецФункции ");
   М.Добавить("Функция Трясти() Строка=""15% { -webkit-transform: translateX(""+НаведТряска03*3+""px);  transform: translateX(""+НаведТряска03*3+""px); } "+
      "30% { -webkit-transform: translateX(-""+НаведТряска03*3+""px); transform: translateX(-""+НаведТряска03*3+""px); } "+
      "40% { -webkit-transform: translateX(""+НаведТряска03*2+""px);  transform: translateX(""+НаведТряска03*2+""px);  } "+           
      "50% { -webkit-transform: translateX(-""+НаведТряска03*2+""px); transform: translateX(-""+НаведТряска03*2+""px); } "+           
      "65% { -webkit-transform: translateX(""+НаведТряска03+""px);  transform: translateX(""+НаведТряска03+""px);  } "+
      "100% { -webkit-transform: translateX(0);    transform: translateX(0);   } ""; "+
      "Возврат Строка; КонецФункции");
   М.Добавить("Функция ЭффектПриНаведениии(Ном) Строка="""";  Если НаведЭффект=1 И Ном=1 Тогда Строка=""-webkit-transform: rotateZ(""+НаведУголНаклона01+""deg); "+
      "-ms-transform: rotateZ(""+НаведУголНаклона01+""deg); transform: rotateZ(""+НаведУголНаклона01+""deg); ""; "+
      " ИначеЕсли НаведЭффект=2 И Ном=1 Тогда Строка=""-webkit-transform: scale(""+НаведУвеличение02+""); -ms-transform: scale(""+НаведУвеличение02+""); "+
      "transform: scale(""+НаведУвеличение02+""); ""; ИначеЕсли НаведЭффект=3 И Ном=2 Тогда Строка="" @-webkit-keyframes threed01""+Префикс+"" { ""+Трясти()+"" } "+
      "@keyframes threed01""+Префикс+"" { ""+Трясти()+"" } ""; КонецЕсли; Возврат Строка; КонецФункции ");
   М.Добавить("Функция СтрокаCSS() экспорт Возврат "".threed01""+Префикс+"" { margin: ""+ОтступСверху+""px ""+ОтступСлева+""px;  "+
     "width: ""+Ширина+""px; height: ""+Высота+""px; background:""+ЦветФона+""; color:""+ЦветТекста+""; line-height:""+ОтступТекстаСверху+""px; "+
      "font-family:Roboto; font-weight:200; font-size:""+РазмерТекста+""em; text-align: center; transition:all ""+Скорость+""s ease;  "+
      "border-radius:""+РадиусУглов+""%; opacity:""+Прозрачность+""; } "+
      ".threed01""+Префикс+"":hover { box-shadow: 1px 1px ""+НаведЦветТени+"", 2px 2px ""+НаведЦветТени+"", 3px 3px ""+НаведЦветТени+"", 4px 4px ""+НаведЦветТени+"", "+
      "5px 5px ""+НаведЦветТени+"", 6px 6px ""+НаведЦветТени+"", 7px 7px ""+НаведЦветТени+""; "+ 
      "-webkit-transform: translateX(-7px);  transform: translateX(-7px); background:""+НаведЦветФона+""; border-radius:""+НаведРадиусУглов+""%; "+ 
      " ""+ЭффектПриНаведениии(1)+"" "+
      "-webkit-animation: threed01""+Префикс+"" 0.6s ease; animation: threed01""+Префикс+"" 0.6s ease; -webkit-animation-iteration-count: 1; "+
      "animation-iteration-count: 1; } } ""+ЭффектПриНаведениии(2)+"" ""; КонецФункции ");
   М.Добавить("Функция CSS() экспорт UfaScript.Запись.ЗаписатьСтроку(); КонецФункции ");
   М.Добавить("Функция СтрокаHTML(Имя,Ссылка) экспорт Возврат ""<a href=""""""+Ссылка+""""""><div  class=""""threed01""+Префикс+"""""">""+Имя+""</div></a>""; "+
     "КонецФункции ");   
   М.Добавить("Функция HTML(Имя,Ссылка) экспорт UfaScript.Запись.ЗаписатьСтроку(СтрокаHTML(Имя,Ссылка)); КонецФункции ");   

	 М.Добавить("Функция СтрокаДляAjax() экспорт Возврат ""<style type=""""text/css"""">""+СтрокаCSS()+""</style>"+
      " ""+СтрокаHTML()+"" "";  КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLКнопка01(Знач Префикс="")
//?Параметры: Префикс - уникальное имя
//?Описание: Создает кнопку с различными эффектами при наведении
//?Поиск: OneScript Объект CSS HTML Кнопка
Функция СоздатьОбъектHTMLКнопка01(Знач Префикс="") экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLКнопка01(Новый Массив)); Об.Префикс=Префикс;  Возврат Об;
КонецФункции

//---------------------  Кнопка01 (конец) ------------------------------------------------------------------


//---------------------  ПрогрессБары ------------------------------------------------------------------

Функция Запись_CSSПрогрессБар01() экспорт  
   Запись.ЗаписатьСтроку(".progress-bar { background-color: #106994; height: 25px; padding: 5px; width: 350px; margin: 50px 0; "+  
    "border-radius: 5px; box-shadow: 0 1px 5px #000 inset, 0 1px 0 #444; } .progress-bar span { display: inline-block; height: 100%;  background-color: #f561c1; "+
    "border-radius: 3px; box-shadow: 0 1px 0 #f9fdd2 inset; transition: width .4s ease-in-out; } ");
КонецФункции

Функция Запись_CSSПрогрессБар02() экспорт  
   Запись.ЗаписатьСтроку(".glow span { box-shadow: 0 5px 5px rgba(255, 255, 255, .7) inset, 0 -5px 5px rgba(255, 255, 255, .7) inset; "+   
    "animation: animate-glow 1s ease-out infinite; }  @keyframes animate-glow { 0% { box-shadow: 0 5px 5px rgba(255, 255, 255, .7) inset, "+
    "0 -5px 5px rgba(255, 255, 255, .7) inset;}  50% { box-shadow: 0 5px 5px rgba(255, 255, 255, .3) inset, 0 -5px 5px rgba(255, 255, 255, .3) inset;} "+
    "100% { box-shadow: 0 5px 5px rgba(255, 255, 255, .7) inset, 0 -5px 5px rgba(255, 255, 255, .7) inset;} } ");
КонецФункции

//Имя: ОбразОбъектHTMLПрогрессБар01(М)
//Описание: Создать массивОбъект для создания объекта ОбъектHTMLПрогрессБар01 
//Категория: ООП HTML Объект МассивОбъект ПрогрессБар
Функция ОбразОбъектHTMLПрогрессБар01(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Функция CSS(Ном) экспорт  Если Ном=1 Тогда UfaScript.Запись_CSSПрогрессБар01(); ИначеЕсли Ном=2 Тогда UfaScript.Запись_CSSПрогрессБар02(); "+
      "КонецЕсли; КонецФункции ");
   М.Добавить("Функция HTML(Проц,Ном) экспорт Если Ном=1 Тогда КлЦвет=""blue""; ИначеЕсли Ном=2 Тогда КлЦвет=""glow""; КонецЕсли; "+ 
   "UfaScript.Запись.ЗаписатьСтроку(""<div class=""""progress-bar  ""+КлЦвет+"" stripes""""><span style=""""width: ""+Проц+""%"""">"+
   "</span></div>""); КонецФункции ");   

//   М.Добавить("Функция СтрокаДляAjax() экспорт Возврат ""<style type=""""text/css"""">""+СтрокаCSS()+""</style>"+
//      " ""+СтрокаHTML()+"" "";  КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLПрогрессБар01()
//?Параметры: У метода CSS(Ном) Ном-номер вида, HTML(Проц,Ном) Проц - процент сдвига бегунка, Ном - номер вида
//?Описание: Создает объект ПрогрессБар. Метод CSS() - задает CSS для объекта. Метод HTML() - вставляет HTML-код у клиента
//?Поиск: OneScript Объект CSS HTML ПрогрессБар
Функция СоздатьОбъектHTMLПрогрессБар01() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLПрогрессБар01(Новый Массив));
  Возврат Об;
КонецФункции

//---------------------  ПрогрессБары (конец) ------------------------------------------------------------------

//---------------------  Движущиеся шарики ------------------------------------------------------------------

//Имя: ОбразОбъектHTMLШарики01(М)
//Описание: Создать массивОбъект для создания объекта ОбъектHTMLШарики01 
//Категория: ООП HTML Объект МассивОбъект 
Функция ОбразОбъектHTMLШарики01(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем ВысотаОбъектов экспорт; Перем ШиринаОбъектов экспорт; Перем РасстояниеМеждуОбъектами экспорт; Перем КоличествоОбъектов экспорт; "+
   "Перем МассивОбъектов экспорт; Перем ИмяОб экспорт; Перем РазмахШирина экспорт;");
   М.Добавить("Функция Конструктор() экспорт  ВысотаОбъектов=10; ШиринаОбъектов=10; РасстояниеМеждуОбъектами=1; КоличествоОбъектов=7; "+
       "МассивОбъектов=Новый Массив; ДобавитьОбъект(""#ff005d"",""right"",1); ДобавитьОбъект(""#35ff99"",""left"",1.1); "+
       "ДобавитьОбъект(""#008597"",""right"",1.05); ДобавитьОбъект(""#ffcc00"",""left"",1.15); ДобавитьОбъект(""#2d3443"",""right"",1.1); "+
       "ДобавитьОбъект(""#ff7c35"",""left"",1.05); ДобавитьОбъект(""#4d407c"",""right"",1); НомОб=0; РазмахШирина=95; КонецФункции ");
   М.Добавить("Функция СтруктураОбъекта(Цвет,Направление,Скорость) экспорт С=Новый Структура(); С.Вставить(""Цвет"",Цвет); С.Вставить(""Направление"",Направление); "+
       "С.Вставить(""Скорость"",Скорость); Возврат С; КонецФункции ");
   М.Добавить("Функция ДобавитьОбъект(Цвет,Направление,Скорость) экспорт МассивОбъектов.Добавить(СтруктураОбъекта(Цвет,Направление,Скорость)); КонецФункции ");
   М.Добавить("Функция ИзменитьОбъект(Ном,Цвет,Направление,Скорость) экспорт Если Ном>=0 И Ном<МассивОбъектов.Количество() Тогда  МассивОбъектов[Ном].Цвет=Цвет; "+
       "МассивОбъектов[Ном].Направление=Направление; МассивОбъектов[Ном].Скорость=Скорость; КонецЕсли; КонецФункции ");
   М.Добавить("Функция СтрокаCSS() Строка = """";  Строка=Строка+"".contener""+ИмяОб+"" { width: 200px; height: 130px; padding-top: 10px;	margin: 0 auto; } ""; "+
    "Строка=Строка+"".ball""+ИмяОб+"" { width: ""+ШиринаОбъектов+""px; height: ""+ВысотаОбъектов+""px; margin: ""+РасстояниеМеждуОбъектами+""px auto; "+
    "border-radius: 50px; } ""; "+
    "Для сч=0 По МассивОбъектов.Количество()-1 Цикл Строка=Строка+"" "+
	".ball""+ИмяОб+"":nth-child(""+(сч+1)+"") { background: ""+МассивОбъектов[сч].Цвет+""; -webkit-animation: ""+МассивОбъектов[сч].Направление+"" "+
	"""+МассивОбъектов[сч].Скорость+""s infinite ease-in-out; -moz-animation: ""+МассивОбъектов[сч].Направление+"" ""+МассивОбъектов[сч].Скорость+""s "+
	"infinite ease-in-out; animation: ""+МассивОбъектов[сч].Направление+"" ""+МассивОбъектов[сч].Скорость+""s infinite ease-in-out; } ""; "+
    " КонецЦикла; Строка=Строка+"" "+
	"@-webkit-keyframes right { 0% { -webkit-transform: translate(-15px); }	50% { -webkit-transform: translate(""+РазмахШирина+""px); } "+
	"100% { -webkit-transform: translate(-15px); } } "+
    "@-webkit-keyframes left { 0% {	-webkit-transform: translate(15px);	} 50% {	-webkit-transform: translate(-""+РазмахШирина+""px); }	"+
    "100% { -webkit-transform: translate(15px); } } "+
    "@-moz-keyframes right { 0% { -moz-transform: translate(-15px);	} 50% {	-moz-transform: translate(""+РазмахШирина+""px); } "+
    "100% { -moz-transform: translate(-15px); } } "+
    "@-moz-keyframes left { 0% {	-moz-transform: translate(15px); } 50% { -moz-transform: translate(-""+РазмахШирина+""px); } "+
    "100% { -moz-transform: translate(15px); } } "+
    "@keyframes right { 0% { transform: translate(-15px); } 50% { transform: translate(""+РазмахШирина+""px); } "+
    "100% {	transform: translate(-15px); } } "+ 
	"@keyframes left { 0% {	transform: translate(15px);	} 50% { transform: translate(-""+РазмахШирина+""px); } "+
	"100% { transform: translate(15px); } } ""; "+
    "Возврат Строка; КонецФункции ");
   М.Добавить("Функция CSS() экспорт  UfaScript.Запись.ЗаписатьСтроку(СтрокаCSS()); КонецФункции ");
   М.Добавить("Функция HTML() экспорт стр=""""; Для сч=1 По КоличествоОбъектов Цикл стр=стр+""<div class=""""ball""+ИмяОб+""""""></div>""  КонецЦикла; "+ 
      "UfaScript.Запись.ЗаписатьСтроку(""<div class=""""contener""+ИмяОб+"""""">""+стр+""</div>"");  КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLШарики01(ИмяОб)
//?Параметры:  ИмяОб - Имя объекта (если несколько объектов, то для каждого уникальноеё)
//?Описание: Создает объект с эфектом качающихся шариков. HTMLШарики01
//?Поиск: OneScript Объект CSS HTML 
Функция СоздатьОбъектHTMLШарики01(ИмяОб) экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLШарики01(Новый Массив));  об.ИмяОб=ИмяОб; Возврат Об;
КонецФункции

Функция Запись_HTMLШарики02() экспорт 
  Запись.ЗаписатьСтроку("<div class=""wrapper"">"+
  
    "<div class=""line line1""><span class=""circle circle-top""></span><div class=""dotted"">"+
	"<span class=""dot dot-top""></span><span class=""dot dot-middle-top""></span><span class=""dot dot-middle-bottom""></span>"+
	"<span class=""dot dot-bottom""></span></div><span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line2"">"+
	"<span class=""circle circle-top""></span><div class=""dotted""><span class=""dot dot-top""></span><span class=""dot dot-middle-top""></span>"+
	"<span class=""dot dot-middle-bottom""></span><span class=""dot dot-bottom""></span></div><span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line3""><span class=""circle circle-top""></span><div class=""dotted""><span class=""dot dot-top""></span>"+
	"<span class=""dot dot-middle-top""></span><span class=""dot dot-middle-bottom""></span><span class=""dot dot-bottom""></span>"+
	"</div><span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line4""><span class=""circle circle-top""></span>"+
	"<div class=""dotted""><span class=""dot dot-top""></span><span class=""dot dot-middle-top""></span><span class=""dot dot-middle-bottom""></span>"+
	"<span class=""dot dot-bottom""></span></div><span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line5"">"+
	"<span class=""circle circle-top""></span><div class=""dotted""><span class=""dot dot-top""></span><span class=""dot dot-middle-top""></span>"+
	"<span class=""dot dot-middle-bottom""></span><span class=""dot dot-bottom""></span></div><span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line6""><span class=""circle circle-top""></span><div class=""dotted""><span class=""dot dot-top""></span>"+
	"<span class=""dot dot-middle-top""></span><span class=""dot dot-middle-bottom""></span><span class=""dot dot-bottom""></span></div>"+
	"<span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line7""><span class=""circle circle-top""></span><div class=""dotted"">"+
	"<span class=""dot dot-top""></span><span class=""dot dot-middle-top""></span><span class=""dot dot-middle-bottom""></span>"+
	"<span class=""dot dot-bottom""></span></div><span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line8""><span class=""circle circle-top"">"+
	"</span><div class=""dotted""><span class=""dot dot-top""></span><span class=""dot dot-middle-top""></span><span class=""dot dot-middle-bottom""></span>"+
	"<span class=""dot dot-bottom""></span></div><span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line9""><span class=""circle circle-top"">"+
	"</span><div class=""dotted""><span class=""dot dot-top""></span><span class=""dot dot-middle-top""></span><span class=""dot dot-middle-bottom""></span>"+
	"<span class=""dot dot-bottom""></span></div><span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line10""><span class=""circle circle-top"">"+
	"</span><div class=""dotted""><span class=""dot dot-top""></span><span class=""dot dot-middle-top""></span><span class=""dot dot-middle-bottom""></span>"+
	"<span class=""dot dot-bottom""></span></div><span class=""circle circle-bottom""></span></div>"+
	
	"<div class=""line line11""><span class=""circle circle-top"">"+
	"</span><div class=""dotted""><span class=""dot dot-top""></span><span class=""dot dot-middle-top""></span><span class=""dot dot-middle-bottom""></span>"+
	"<span class=""dot dot-bottom""></span></div><span class=""circle circle-bottom""></span></div>"+
	
	"</div>");
КонецФункции

Функция Запись_CSSШарики02() экспорт 
   Запись.ЗаписатьСтроку(".wrapper{	position: absolute;	float: left; margin: 140px 100px; }	.line{ position: absolute; top: 0px; width: 2px; height: 8px; "+
	"background-color: red;	} .circle{ position: absolute; display: block; width: 8px;	height: 8px; border-radius: 50%; background-color: blue; "+
	"} .circle-top{	top: 0px; left: -3.5px;	} .circle-bottom{ bottom: 0px; left: -3.5px; } .dot{ position: absolute; display: block; width: 4px; "+
	"height: 4px; border-radius: 50%; left: -1.5px;	} "+

	".line1{ margin-left: 0px;	background-color: #2410CB;	-webkit-animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) infinite;	animation: line 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) infinite; }	.line1 > span{ background-color: #D4141E; }	.line1 > .dotted > .dot{ background-color: #D4141E;	} "+
	".line1 > .dotted > .dot-top{ top: 0px; -webkit-animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) infinite; animation: dot-top 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) infinite; }	.line1 > .dotted > .dot-bottom{ bottom: 0px; -webkit-animation: dot-bottom 2s cubic-bezier(0.250, "+
	"0, 0.705, 1) infinite; animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) infinite; } .line1 > .dotted > .dot-middle-top{ top: 0px; "+
	"-webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) infinite; animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	"infinite; } .line1 > .dotted > .dot-middle-bottom{ bottom: 0px; -webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) infinite;	"+
	"animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) infinite;	} "+

	".line2{ margin-left: 35px; background-color: #852DF4;	-webkit-animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .05s infinite; animation: line 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .05s infinite; } .line2 > span{ background-color: #FC7E48; } .line2 > .dotted > .dot{ background-color: #FC7E48; } "+
	".line2 > .dotted > .dot-top{ top: 0px; -webkit-animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .05s infinite; animation: dot-top 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .05s infinite; } .line2 > .dotted > .dot-bottom{ bottom: 0px;	-webkit-animation: dot-bottom 2s cubic-bezier(0.250, 0, "+
	"0.705, 1) .05s infinite; animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .05s infinite; } .line2 > .dotted > .dot-middle-top{ top: 0px; "+
	"-webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .05s infinite;	animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	".05s infinite; } .line2 > .dotted > .dot-middle-bottom{ bottom: 0px; -webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .05s "+
	"infinite; animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .05s infinite; } "+
	
	".line3{ margin-left: 70px; background-color: #F42DF1; -webkit-animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .1s infinite; animation: line 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .1s infinite; } .line3 > span{ background-color: #EDEB29; } .line3 > .dotted > .dot{ background-color: #EDEB29; } "+
	".line3 > .dotted > .dot-top{	top: 0px; -webkit-animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .1s infinite;	animation: dot-top 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .1s infinite; } .line3 > .dotted > .dot-bottom{ bottom: 0px;	-webkit-animation: dot-bottom 2s cubic-bezier(0.250, "+
	"0, 0.705, 1) .1s infinite; animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .1s infinite; } .line3 > .dotted > .dot-middle-top{ top: 0px;	"+
	"-webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .1s infinite; animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	".1s infinite;	} .line3 > .dotted > .dot-middle-bottom{ bottom: 0px; -webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	".1s infinite;	animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .1s infinite;	} "+
	
	".line4{ margin-left: 105px; background-color: #F91396;	-webkit-animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .15s infinite; animation: line 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .15s infinite; } .line4 > span{ background-color: #ACED29; } .line4 > .dotted > .dot{ background-color: #ACED29; } "+
	".line4 > .dotted > .dot-top{ top: 0px; -webkit-animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .15s infinite;	animation: dot-top 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .15s infinite; } .line4 > .dotted > .dot-bottom{ bottom: 0px; -webkit-animation: dot-bottom 2s cubic-bezier(0.250, "+
	"0, 0.705, 1) .15s infinite;	animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .15s infinite; }	.line4 > .dotted > .dot-middle-top{	top: "+
	"0px; -webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .15s infinite; animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	".15s infinite; } .line4 > .dotted > .dot-middle-bottom{ bottom: 0px; -webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .15s "+
	"infinite; animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .15s infinite; } "+
	
	".line5{ margin-left: 140px;	background-color: #D4141E; -webkit-animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .2s "+
	"infinite;	animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .2s infinite; }	.line5 > span{	background-color: #4EF02B;	} .line5 > .dotted > .dot{ "+
	"background-color: #4EF02B;	} .line5 > .dotted > .dot-top{ top: 0px; -webkit-animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .2s infinite; "+
	"animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .2s infinite; }	.line5 > .dotted > .dot-bottom{	bottom: 0px; -webkit-animation: dot-bottom 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .2s infinite;	animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .2s infinite;	} .line5 > .dotted > .dot-middle-top{ "+
	"top: 0px;	-webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .2s infinite;	animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	".2s infinite;	} .line5 > .dotted > .dot-middle-bottom{ bottom: 0px; -webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .2s infinite; "+
	"animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .2s infinite;	} .line6{ margin-left: 175px; background-color: #FC7E48; -webkit-animation: "+
	"line 2s cubic-bezier(0.250, 0, 0.705, 1) .25s infinite; animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .25s infinite;	} .line6 > span{ "+
	"background-color: #38E790;	} .line6 > .dotted > .dot{ background-color: #38E790; }	.line6 > .dotted > .dot-top{ top: 0px;	-webkit-animation: dot-top 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .25s infinite; animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .25s infinite;	} .line6 > .dotted > .dot-bottom{ "+
	"bottom: 0px;	-webkit-animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .25s infinite; animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	".25s infinite;	} .line6 > .dotted > .dot-middle-top{ top: 0px;	-webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .25s infinite; "+
	"animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .25s infinite; }	.line6 > .dotted > .dot-middle-bottom{	bottom: 0px; "+
	"-webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .25s infinite; animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	".25s infinite;	} .line7{ margin-left: 210px; background-color: #EDEB29; -webkit-animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .3s infinite; "+
	"animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .3s infinite;	} .line7 > span{ background-color: #25EACC;	} .line7 > .dotted > .dot{ "+
	"background-color: #25EACC;	} .line7 > .dotted > .dot-top{ top: 0px; -webkit-animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .3s infinite; "+
	"animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .3s infinite; }	.line7 > .dotted > .dot-bottom{	bottom: 0px; -webkit-animation: dot-bottom 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .3s infinite;	animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .3s infinite;	} .line7 > .dotted > .dot-middle-top{ "+
	"top: 0px;	-webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .3s infinite;	animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	".3s infinite; } .line7 > .dotted > .dot-middle-bottom{	bottom: 0px; -webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .3s infinite; "+
	"animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .3s infinite;	} .line8{ margin-left: 245px; background-color: #ACED29; "+
	"-webkit-animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .35s infinite;	animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .35s infinite;	} "+
	".line8 > span{	background-color: #309CDF;	} .line8 > .dotted > .dot{	background-color: #309CDF;	} .line8 > .dotted > .dot-top{	top: 0px; "+
	"-webkit-animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .35s infinite;	animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .35s infinite; "+
	"}	.line8 > .dotted > .dot-bottom{	bottom: 0px; -webkit-animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .35s infinite; animation: dot-bottom 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .35s infinite; }	.line8 > .dotted > .dot-middle-top{	top: 0px; -webkit-animation: dot-middle-top 2s cubic-bezier(0.250, "+
	"0, 0.705, 1) .35s infinite; animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .35s infinite; }	.line8 > .dotted > .dot-middle-bottom{ "+
	"bottom: 0px;	-webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .35s infinite;	animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, "+
	"0.705, 1) .35s infinite; }	.line9{	margin-left: 280px;	background-color: #4EF02B;	-webkit-animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .4s infinite; "+
	"animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .4s infinite;	} .line9 > span{ background-color: #2544E7;	} .line9 > .dotted > .dot{ "+
	"background-color: #2544E7;	} .line9 > .dotted > .dot-top{	top: 0px; -webkit-animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .4s infinite; "+
	"animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .4s infinite; }	.line9 > .dotted > .dot-bottom{	bottom: 0px; -webkit-animation: dot-bottom 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .4s infinite;	animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .4s infinite;	} .line9 > .dotted > .dot-middle-top{ "+
	"top: 0px;	-webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .4s infinite;	animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) "+
	".4s infinite;	} .line9 > .dotted > .dot-middle-bottom{ bottom: 0px; -webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .4s infinite; "+
	"animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .4s infinite;	} .line10{	margin-left: 315px;	background-color: #38E790;	-webkit-animation: "+
	"line 2s cubic-bezier(0.250, 0, 0.705, 1) .45s infinite; animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .45s infinite;	} .line10 > span{ "+
	"background-color: #852DF4;	} .line10 > .dotted > .dot{	background-color: #852DF4;	} .line10 > .dotted > .dot-top{	top: 0px;	-webkit-animation: dot-top 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .45s infinite; animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .45s infinite;	} .line10 > .dotted > .dot-bottom{ "+
	"bottom: 0px; -webkit-animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .45s infinite;	animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .45s "+
	"infinite;	} .line10 > .dotted > .dot-middle-top{	top: 0px;	-webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .45s infinite; "+
	"animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .45s infinite; }	.line10 > .dotted > .dot-middle-bottom{	bottom: 0px; -webkit-animation: "+
	"dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .45s infinite;	animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .45s infinite; } "+
    ".line11{ margin-left: 350px; background-color: #25EACC; -webkit-animation: line 2s cubic-bezier(0.250, 0, 0.705, 1) .5s infinite;	animation: line 2s "+
    "cubic-bezier(0.250, 0, 0.705, 1) .5s infinite;	} .line11 > span{ background-color: #F42DF1; } .line11 > .dotted > .dot{ background-color: #F42DF1; } "+
	".line11 > .dotted > .dot-top{ top: 0px; -webkit-animation: dot-top 2s cubic-bezier(0.250, 0, 0.705, 1) .5s infinite; animation: dot-top 2s "+
	"cubic-bezier(0.250, 0, 0.705, 1) .5s infinite;	} .line11 > .dotted > .dot-bottom{	bottom: 0px; -webkit-animation: dot-bottom 2s cubic-bezier(0.250, 0, "+
	"0.705, 1) .5s infinite; animation: dot-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .5s infinite; } .line11 > .dotted > .dot-middle-top{	top: 0px; "+
	"-webkit-animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .5s infinite; animation: dot-middle-top 2s cubic-bezier(0.250, 0, 0.705, 1) .5s "+
	"infinite;	} .line11 > .dotted > .dot-middle-bottom{ bottom: 0px;	-webkit-animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .5s infinite; "+
	"animation: dot-middle-bottom 2s cubic-bezier(0.250, 0, 0.705, 1) .5s infinite;	} @-webkit-keyframes line{	0%{height: 4px; top: 0px; left: 0px; "+
	"-webkit-transform: rotate(-65deg)}	10%{height: 220px; top: -110px; left: 15px;} 45%{height: 200px; top: -100px; left: 25px;}	70%{height: 8px; top: 0px; "+
	"left: 25px; -webkit-transform: rotate(0deg);}	100%{height: 8px; top: 0px; left: 15px; -webkit-transform: rotate(0deg);} }	@-webkit-keyframes dot-top{ "+
	"0%{top: -30px}	10%{top: -30px;} 45%{top: -25px;} 60%{top: 0px;} 100%{top: 0px;} }	@-webkit-keyframes dot-bottom{	0%{bottom: -30px} 10%{bottom: -30px;} "+
	"45%{bottom: -25px;} 60%{bottom: 0px;}	100%{bottom: 0px;}	} @-webkit-keyframes dot-middle-top{ 0%{} 10%{}	45%{top: 98px;}	70%{top: -50px;} 85%{top: 0px;} "+
	"100%{top: 0px;} }	@-webkit-keyframes dot-middle-bottom{ 0%{} 10%{} 45%{bottom: 98px;}	70%{bottom: -50px;}	85%{bottom: 0px;} 100%{bottom: 0px;} } "+
	"@keyframes line{ 0%{height: 4px; top: 0px; left: 0px; transform: rotate(-65deg)}	10%{height: 220px; top: -110px; left: 15px;} 45%{height: 200px; top: "+
	"-100px; left: 25px;}	70%{height: 8px; top: 0px; left: 25px; transform: rotate(0deg);} 100%{height: 8px; top: 0px; left: 15px; transform: rotate(0deg);} }"+
	"@keyframes dot-top{ 0%{top: -30px}	10%{top: -30px;} 45%{top: -25px;} 60%{top: 0px;} 100%{top: 0px;} }	@keyframes dot-bottom{	0%{bottom: -30px} "+
	"10%{bottom: -30px;} 45%{bottom: -25px;} 60%{bottom: 0px;} 100%{bottom: 0px;} }	@keyframes dot-middle-top{ 0%{}	10%{} 45%{top: 78px;} 70%{top: -50px;} "+
	"85%{top: 0px;}	100%{top: 0px;}	} @keyframes dot-middle-bottom{	0%{} 10%{}	45%{bottom: 78px;}	70%{bottom: -50px;}	85%{bottom: 0px;} 100%{bottom: 0px;} }");
КонецФункции

//Имя: ОбразОбъектHTMLШарики02(М)
//Описание: Создать массивОбъект для создания объекта ОбъектHTMLШарики02 
//Категория: ООП HTML Объект МассивОбъект 
Функция ОбразОбъектHTMLШарики02(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Функция CSS() экспорт  UfaScript.Запись_CSSШарики02(); КонецФункции ");
   М.Добавить("Функция HTML() экспорт UfaScript.Запись_HTMLШарики02();  КонецФункции ");   
   Возврат М;
КонецФункции

//Имя: СоздатьОбъектHTMLШарики02()
//Описание: Создать объект HTMLШарики02  
//Категория: ООП HTML Объект 
Функция СоздатьОбъектHTMLШарики02() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLШарики02(Новый Массив));
  Возврат Об;
КонецФункции

//---------------------  Движущиеся шарики (конец) ------------------------------------------------------------------

//---------------------  Программист ------------------------------------------------------------------
Функция Запись_HTMLПрограммист() экспорт 
  Запись.ЗаписатьСтроку("<div class=""error404page""><div class=""newcharacter404""><div class=""chair404""></div><div class=""leftshoe404""></div> "+
    "<div class=""rightshoe404""></div><div class=""legs404""></div><div class=""torso404""><div class=""body404""></div><div class=""leftarm404""></div> "+
    "<div class=""rightarm404""></div><div class=""head404""><div class=""eyes404""></div></div></div><div class=""laptop404""></div></div></div>");
КонецФункции

Функция Запись_CSSПрограммист() экспорт 
   Запись.ЗаписатьСтроку(".error404page { height: 800px; } .body404, .head404, .eyes404, .leftarm404, .rightarm404, .chair404, .leftshoe404, "+
     ".rightshoe404, .legs404, .laptop404 { background: url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/15979/404-character-new.png) 0 0 no-repeat; "+
     "width: 200px;  height: 200px; } .newcharacter404, .torso404, .body404, .head404, .eyes404, .leftarm404, .rightarm404, .chair404, .leftshoe404, "+
     ".rightshoe404, .legs404, .laptop404 { background-size: 750px;  position: absolute;  display: block; } .newcharacter404 { width: 400px; "+
     "height: 800px;  left: 50%;  top: 20px;  margin-left: -200px; } $swayspeed: 20s; .torso404 { position: absolute; display: block; top: 138px; "+
     "left: 0px; width: 389px; height: 252px;  animation: sway $swayspeed ease infinite; transform-origin: 50% 100%; } .body404 { position: absolute; "+
     "display: block;  top: 0px;  left: 0px;  width: 389px;  height: 253px; } .head404 { position: absolute; top: -148px; left: 106px; width: 160px; "+
     "height: 194px; background-position: 0px -265px; transform-origin: 50% 85%; animation: headTilt $swayspeed ease infinite; } .eyes404 { "+
     "position: absolute; top: 92px; left: 34px;  width: 73px; height: 18px; background-position: -162px -350px; animation: blink404 10s steps(1) infinite, "+
     "pan 10s ease-in-out infinite; } .leftarm404 { position: absolute; top: 159px; left: 0; width: 165px; height: 73px; background-position: -265px -341px; "+
     "transform-origin: 9% 35%;  transform: rotateZ(0deg); animation: typeLeft 0.4s linear infinite; } .rightarm404 { position: absolute; top: 148px; "+
     "left: 231px;  width: 157px;  height: 91px;  background-position: -442px -323px;  transform-origin: 90% 25%;  animation: typeLeft 0.4s linear infinite; } "+
     ".chair404 { position: absolute; top: 430px; left: 55px; width: 260px; height: 365px; background-position: -12px -697px; } .legs404 { position: absolute; "+
     "top: 378px;  left: 4px;  width: 370px;  height: 247px;  background-position: -381px -443px; } .leftshoe404 { position: absolute; top: 591px; left: 54px; "+
     "width: 130px;  height: 92px;  background-position: -315px -749px; } .rightshoe404 { position: absolute;  top: 594px;  left: 187px;  width: 135px; "+
     "height: 81px;  background-position: -453px -749px; transform-origin: 35% 12%; animation: tapRight 1s linear infinite; } .laptop404 { position: absolute; "+
     "top: 186px;  left: 9px;  width: 365px;  height: 216px;  background-position: -2px -466px;  transform-origin: 50% 100%;  animation: tapWobble 0.4s linear "+
     "infinite; } @keyframes sway { 0%   { transform: rotateZ(0deg); } 20%  { transform: rotateZ(0deg); } 25%  { transform: rotateZ(4deg); } 45%  { transform: "+
     "rotateZ(4deg); }  50% { transform: rotateZ(0deg); }  70%  { transform: rotateZ(0deg); }  75%  { transform: rotateZ(-4deg); } 90%  { transform: "+
     "rotateZ(-4deg); }  100% { transform: rotateZ(0deg); } } @keyframes headTilt {  0%   { transform: rotateZ(0deg); }  20%  { transform: rotateZ(0deg); } "+
     "25%  { transform: rotateZ(-4deg); }  35%  { transform: rotateZ(-4deg); }  38%  { transform: rotateZ(2deg); }  42%  { transform: rotateZ(2deg); } "+
     "45%  { transform: rotateZ(-4deg); }  50%  { transform: rotateZ(0deg); }  70%  { transform: rotateZ(0deg); }  82%  { transform: rotateZ(0deg); } "+
     "85%  { transform: rotateZ(4deg); }  90%  { transform: rotateZ(4deg); }  100% { transform: rotateZ(0deg); } }  @keyframes typeLeft { "+
     "0%   { transform: rotateZ(0deg); }  25%  { transform: rotateZ(7deg); }  75%  { transform: rotateZ(-6deg); }  100% { transform: rotateZ(0deg); } "+
     "} @keyframes typeRight { 0%   { transform: rotateZ(0deg); }  25%  { transform: rotateZ(-6deg); }  75%  { transform: rotateZ(7deg); } "+
     "100% { transform: rotateZ(0deg); } } @keyframes tapWobble {  0%   { transform: rotateZ(-0.2deg); }  50%  { transform: rotateZ(0.2deg); } "+
     "100% { transform: rotateZ(-0.2deg); } } @keyframes tapRight { 0%   { transform: rotateZ(0deg); } 90%  { transform: rotateZ(-6deg); } "+
     "100% { transform: rotateZ(0deg); } }  @keyframes blink404 { 0%   { background-position: -162px -350px; } 94%  { background-position: -162px -350px; } "+
     "98%  { background-position: -162px -368px; } 100% { background-position: -162px -350px; } } @keyframes pan { 0%   { transform: translateX(-2px); } "+
     "49%   { transform: translateX(-2px); } 50%  { transform: translateX(2px); }  99%  { transform: translateX(2px); } 100% { transform: translateX(-2px); } } ");
КонецФункции


//Имя: ОбразОбъектHTMLПрограммист(М)
//Описание: Создать массивОбъект для создания объекта ОбъектHTMLПрограммист 
//Категория: ООП HTML Объект МассивОбъект 
Функция ОбразОбъектHTMLПрограммист(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Функция CSS() экспорт  UfaScript.Запись_CSSПрограммист(); КонецФункции ");
   М.Добавить("Функция HTML() экспорт UfaScript.Запись_HTMLПрограммист();  КонецФункции ");   
   Возврат М;
КонецФункции

//Имя: СоздатьОбъектHTMLПрограммист()
//Описание: Создать объект HTMLПрограммист 
//Категория: ООП HTML Объект 
Функция СоздатьОбъектHTMLПрограммист() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLПрограммист(Новый Массив));
  Возврат Об;
КонецФункции
//---------------------  Программист (конец) ------------------------------------------------------------------

//---------------------  Вывод Текста ------------------------------------------------------------------
//Имя: ИнициализацияТегов()
//Описание: body, div, h1, h2, h3, h4, h5, h6, p, ul, ol, li, dl, dt, dd, img, form, fieldset, blockquote { margin: 0; padding: 0; border: 0; }
//Категория: CSS  
Функция ИнициализацияCSSТегов() экспорт     
  Запись.ЗаписатьСтроку("body, div, h1, h2, h3, h4, h5, h6, p, ul, ol, li, dl, dt, dd, img, form, fieldset, blockquote { margin: 0; padding: 0; border: 0; }");
КонецФункции

//Имя: ОбразОбъектHTMLТекст(М)
//Описание: Создать массивОбъект для создания объекта ОбъектHTMLТекст 
//Категория: ООП HTML Объект МассивОбъект 
Функция ОбразОбъектHTMLТекст(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем Префикс экспорт; Перем РазмерТекста экспорт; Перем ЦветТекста экспорт; Перем ГлубинаТени экспорт; Перем ЦветТени экспорт; "+
        "Перем ОтступСверху экспорт; Перем ОтступСнизу экспорт; Перем ОтступСлева экспорт; Перем ОтступСправа экспорт; Перем ВерхнийРегистр экспорт; "+
        "Перем Выравнивание экспорт;  ");
   М.Добавить("Функция Конструктор() экспорт Префикс=""""; РазмерТекста=30; ЦветТекста=""#717171""; ГлубинаТени=7; ЦветТени=""#333""; "+
        "ОтступСверху=10; ОтступСнизу=0; ОтступСлева=0; ОтступСправа=0; ВерхнийРегистр=Ложь;  Выравнивание=3;  КонецФункции ");
   М.Добавить("Функция УстановитьВерхнийРегистр() Строка=""""; Если ВерхнийРегистр Тогда Строка="" text-transform: uppercase; ""; КонецЕсли; "+
        "Возврат Строка; КонецФункции ");
   М.Добавить("Функция УстановитьВыравнивание() Строка=""""; Если Выравнивание=1 Тогда Строка="" text-align: left; ""; "+
        "ИначеЕсли Выравнивание=2 Тогда Строка="" text-align: right; ""; ИначеЕсли Выравнивание=3 Тогда Строка="" text-align: center; "";  "+
        "КонецЕсли; Возврат Строка; КонецФункции ");
   М.Добавить("Функция СтрокаCSS() экспорт  Возврат ""div { margin: 0; padding: 0; border: 0; } .tekst""+Префикс+"" { "+
        "font-size: ""+РазмерТекста+""px; color: ""+ЦветТекста+""; text-shadow: 0 ""+ГлубинаТени+""px ""+ГлубинаТени+""px ""+ЦветТени+""; "+
        "margin: ""+ОтступСверху+""px  ""+ОтступСправа+"" ""+ОтступСнизу+"" ""+ОтступСлева+""; ""+УстановитьВерхнийРегистр()+"" "+
        " ""+УстановитьВыравнивание()+"" }""; КонецФункции ");
   М.Добавить("Функция CSS() экспорт  UfaScript.Запись.ЗаписатьСтроку(СтрокаCSS()); КонецФункции ");
   М.Добавить("Функция СтрокаHTML(Текст) экспорт Возврат ""<div class=""""tekst""+Префикс+"""""">""+Текст+""</div>"";  КонецФункции ");   
   М.Добавить("Функция HTML(Текст) экспорт UfaScript.Запись.ЗаписатьСтроку(СтрокаHTML(Текст));  КонецФункции ");   
   М.Добавить("Функция СтрокаДляAjax() экспорт Возврат ""<style type=""""text/css"""">""+СтрокаCSS()+""</style>"+
      " ""+СтрокаHTML()+"" "";  КонецФункции ");   
   Возврат М;
КонецФункции

//Имя: СоздатьОбъектHTMLТекст(Знач Префикс="")
//Описание: Создать объект HTMLТекст 
//Категория: ООП HTML Объект 
Функция СоздатьОбъектHTMLТекст(Знач Префикс="") экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLТекст(Новый Массив)); Об.Префикс=Префикс; Возврат Об;
КонецФункции

//Имя: ОбразОбъектHTMLКонсоль(М)
//Описание: Создать массивОбъект для создания объекта ОбъектHTMLКонсоль 
//Категория: ООП HTML Объект МассивОбъект Текст
Функция ОбразОбъектHTMLКонсоль(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем Префикс экспорт; Перем ШиринаБордюра экспорт; Перем ЦветБордюра экспорт; Перем Ширина экспорт; "+
      " Перем Высота экспорт; Перем ОтступТекста экспорт; Перем ЦветФона экспорт; ");
   М.Добавить("Функция Конструктор() экспорт Префикс=""""; ШиринаБордюра=1; ЦветБордюра=""grey""; Ширина=250; Высота=110; "+
      "ОтступТекста=10; ЦветФона=""lightgray"";  КонецФункции ");
   М.Добавить("Функция СтрокаCSS() экспорт  Возврат "" #console""+Префикс+"" { border: ""+ШиринаБордюра+""px solid ""+ЦветБордюра+""; "+
        "width:""+Ширина+""px; height: ""+Высота+""px; padding: ""+ОтступТекста+""px; background:""+ЦветФона+""; } ""; КонецФункции ");
   М.Добавить("Функция CSS() экспорт  UfaScript.Запись.ЗаписатьСтроку(СтрокаCSS()); КонецФункции ");
   М.Добавить("Функция СтрокаHTML() экспорт Возврат ""<div id=""""console""+Префикс+""""""></div>"";  КонецФункции "); 
   М.Добавить("Функция HTML() экспорт UfaScript.Запись.ЗаписатьСтроку(СтрокаHTML());  КонецФункции "); 
   М.Добавить("Функция СтрокаДляAjax() экспорт Возврат ""<style type=""""text/css"""">""+СтрокаCSS()+""</style>"+
      " ""+СтрокаHTML()+"" "";  КонецФункции ");   
   Возврат М;
КонецФункции

//Имя: СоздатьОбъектHTMLКонсоль(Знач Префикс="")
//Описание: Создать объект HTMLТекст 
//Категория: ООП HTML Объект 
Функция СоздатьОбъектHTMLКонсоль(Знач Префикс="") экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLКонсоль(Новый Массив)); Об.Префикс=Префикс; Об.ИмяОбъекта="console"+Префикс; Возврат Об;
КонецФункции

//---------------------  Вывод Текста (конец) ------------------------------------------------------------------

//---------------------  Шаблоны ------------------------------------------------------------------
Функция СубОбъектHTMLШаблонБазовый(М)      
   М.Добавить("Перем Префикс экспорт; Перем ЦветФонаBody экспорт; Перем ЦветТекстаBody экспорт; Перем ПроцОтступаТекстаОтРамкиBody экспорт; "); 
   М.Добавить("Функция СубКонструктор() экспорт Префикс=""""; ЦветФона=""#eefdfd"";  ЦветТекста=""#333""; ПроцОтступаТекстаОтРамки=1; "+
       "КонецФункции "); 
   М.Добавить("Функция Запись(Стр) экспорт  UfaScript.Запись.ЗаписатьСтроку(Стр); КонецФункции "); 
   М.Добавить("Функция СтрокаЗаголовокHTMLБезJoomla() экспорт Возврат "" <!DOCTYPE html PUBLIC """"-//W3C//DTD XHTML 1.0 Strict//EN"""" "+
       " """"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd""""><html xmlns=""""http://www.w3.org/1999/xhtml"""" lang=""""ru"""" "+
       "xml:lang=""""ru""""> ""; КонецФункции "); 
   М.Добавить("Функция СтрокаЗаголовокHTMLДляJoomla() экспорт Возврат "" <!DOCTYPE html PUBLIC """"-//W3C//DTD XHTML 1.0 Transitional//EN"""" "+
       " """"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd""""> <html xmlns=""""http://www.w3.org/1999/xhtml"""" "+
	   "lang=""""<?php echo $this->language; ?>"""" dir=""""<?php echo $this->direction; ?>""""><head> "+
       "<meta name=""""viewport"""" content=""""width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=yes""""/> "+
	   "<meta name=""""HandheldFriendly"""" content=""""true"""" /><meta name=""""apple-mobile-web-app-capable"""" content=""""YES"""" />"+
	   "<jdoc:include type=""""head"""" /></head> ""; КонецФункции "); 
   М.Добавить("Функция СтрокаЗаголовокHTML(Joomla) экспорт Если Joomla Тогда Возврат СтрокаЗаголовокHTMLДляJoomla(); КонецЕсли; "+
       "Возврат СтрокаЗаголовокHTMLБезJoomla(); КонецФункции ");
   М.Добавить("Функция СтрокаНачало(Joomla) экспорт Если Joomla Тогда Возврат ""<?php defined('_JEXEC') or die; $doc = JFactory::getDocument(); "+
       "$JUri =  JUri::base(TRUE);  $LOGOTIP = JText::_(""""TPL_UFAJOOM37_LOGOTIP""""); $doc->addStyleSheet($JUri.""""/templates/"""".$doc->"+
	   "template.""""/css/style.css""""); if ($showRightColumn == 0 and $showleft == 0) {$showno = 0;} $this->setHtml5(true); ?> ""; КонецЕсли; "+
	   "Возврат "" ""; КонецФункции ");
   М.Добавить("Функция СтрокаОбщиеПравилаДляСтраницы() экспорт Возврат "" <?php ini_set(""""default_charset"""" ,""""utf8""""); ?> "+
       "<style type=""""text/css""""> *{ margin: 0; padding: 0; border: 0; } "+
       "body { padding: ""+ПроцОтступаТекстаОтРамкиBody+""% 0 0; background: ""+ЦветФонаBody+""; color: ""+ЦветТекстаBody+""; "+
	   "font-family: """"Courier New"""", Verdana, Arial, Helvetica, sans-serif; } </style>""; КонецФункции ");
   Возврат М;
КонецФункции

Функция ОбразОбъектHTMLШаблонТабличный(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем ПроцШириныТаб экспорт; Перем ТолщинаРамки экспорт; Перем ТолщинаЛиний экспорт; "+
       "Перем ОтступТекста экспорт; Перем ПроцШириныКонтента экспорт;");
   М.Добавить("Функция Конструктор() экспорт Префикс=""""; ПроцШириныТаб=100; ТолщинаРамки=1; ТолщинаЛиний=5; ОтступТекста=2; "+
        "ПроцШириныКонтента=80; КонецФункции ");   
 //  М.Добавить("Функция СтрокаCSS() экспорт Возврат "".footer{ height: 144px;	width: 770px; font-size: 10px; color: #FFFFFF; "+
 //      "padding-top: 23px;	text-align: center;	clear:both;	margin: 0px auto;	background:url(images/futer.jpg) bottom repeat-x #FFFFFF; "+
//	   "border-left: 7px solid #FFFFFF;	border-right: 7px solid #FFFFFF; }  #footer a{ color: #FFFFFF;	font-size: 10px; "+
//	   "text-decoration: none; } ""; КонецФункции ");
   М.Добавить("Функция СтрокаHTML() экспорт Возврат ""<table class=""""""+ИмяОбъекта+"""""" width=""+ПроцШириныТаб+""% "+
      "border=""+ТолщинаРамки+"" cellspacing=""+ТолщинаЛиний+"" cellpadding=""+ОтступТекста+""><tr><td colspan=3>"+
	  "<div id=""""shapka""""></div></td></tr><tr><td ><div id=""""pravmenu""""></div></td><td width=""+ПроцШириныКонтента+""%>"+
	  "<div id=""""kontent""""></div></td></tr><tr><td colspan=3><div id=""""footer""""></div></td></tr></table>"";  КонецФункции ");   
   М.Добавить("Функция HTML() экспорт UfaScript.Запись.ЗаписатьСтроку(СтрокаHTML());  КонецФункции ");   
   Возврат М;
КонецФункции

Функция СоздатьОбъектHTMLШаблонТабличный(Знач Префикс="") экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLШаблонТабличный(Новый Массив)); Об.Префикс=Префикс; Об.ИмяОбъекта="tabshablon"+Префикс; Возврат Об;
КонецФункции

Функция ОбразОбъектHTMLШаблонБлочный(М)      // Устаревшее не использовать
   М=ОбразОбъектHTMLБазовый(М);   
   М=СубОбъектHTMLШаблонБазовый(М);
   М.Добавить("Перем ВысотаШапки экспорт; Перем РисунокФонаШапки экспорт; Перем ШиринаШапки экспорт; Перем ЦветФонаШапки экспорт; "+
	   "Перем ВысотаЛевойПанели экспорт; Перем РисунокЛевойПанели экспорт; Перем ШиринаЛевойПанели экспорт; Перем ЦветФонаЛевойПанели экспорт; "+
	   "Перем ВысотаПравойПанели экспорт; Перем РисунокПравойПанели экспорт; Перем ШиринаПравойПанели экспорт; Перем ЦветФонаПравойПанели экспорт; "+
	   "Перем ВысотаЦентрПанели экспорт; Перем РисунокЦентрПанели экспорт; Перем ШиринаЦентрПанели экспорт; Перем ЦветФонаЦентрПанели экспорт; "+
	   "Перем ВысотаПодвала экспорт; Перем РисунокПодвала экспорт; Перем ШиринаПодвала экспорт; Перем ЦветФонаПодвала экспорт; "+
	   "Перем ЦветТекстаПодвала экспорт; Перем Ширина экспорт; ");
   М.Добавить("Функция Конструктор() экспорт СубКонструктор(); ЦветФона=""#eefdfd"";  ЦветТекста=""#333""; Ширина=960; ПроцОтступаТекстаОтРамки=1; "+
       "ВысотаШапки=100; РисунокФонаШапки=""""; ШиринаШапки=Ширина; ВысотаЛевойПанели=400; ШиринаЛевойПанели=300; РисунокЛевойПанели=""""; "+
       "ЦветФонаЛевойПанели=""#f2d1fc"";  ВысотаПравойПанели=ВысотаЛевойПанели; ШиринаПравойПанели=200; РисунокПравойПанели=""""; ЦветФонаПравойПанели=""#ffa8a8""; "+
	   "ВысотаЦентрПанели=ВысотаЛевойПанели; ШиринаЦентрПанели=Ширина-ШиринаПравойПанели-ШиринаЛевойПанели; РисунокЦентрПанели=""""; ЦветФонаЦентрПанели=""#adffa2""; "+
	   "ВысотаПодвала=50; ШиринаПодвала=ШиринаШапки-10; РисунокПодвала=""""; ЦветФонаПодвала=""#CCEE9D""; ЦветТекстаПодвала=""#fff""; ЦветФонаШапки=""#22DDD9""; "+
	   "КонецФункции ");   
   М.Добавить("Функция СтрокаCSScontainer() экспорт Возврат "" #container { width: ""+Ширина+""px; margin: 0 auto; } ""; КонецФункции ");
   М.Добавить("Функция СтрокаCSSheader() экспорт Возврат "" #header { background: ""+ЦветФонаШапки+""; ""+UfaScript.РисунокCSS(РисунокФонаШапки)+"" "+
       "width: ""+ШиринаШапки+""px; height: ""+ВысотаШапки+""px; } ""; КонецФункции ");
   М.Добавить("Функция СтрокаCSSleftpanel() экспорт Возврат "" #leftpanel {background: ""+ЦветФонаЛевойПанели+""; "+
       " ""+UfaScript.РисунокCSS(РисунокЛевойПанели)+"" width: ""+ШиринаЛевойПанели+""px; height: ""+ВысотаЛевойПанели+""px;  float:left; } "+
	   " ""; КонецФункции ");
   М.Добавить("Функция СтрокаCSSrightpanel() экспорт Возврат "" #rightpanel {background: ""+ЦветФонаПравойПанели+""; "+
       " ""+UfaScript.РисунокCSS(РисунокПравойПанели)+"" width: ""+ШиринаПравойПанели+""px; height: ""+ВысотаПравойПанели+""px;  float:right; } "+
	   " ""; КонецФункции ");
   М.Добавить("Функция СтрокаCSScenterpanel() экспорт Возврат "" #centerpanel {background: ""+ЦветФонаЦентрПанели+""; "+
       " ""+UfaScript.РисунокCSS(РисунокЦентрПанели)+"" width: ""+ШиринаЦентрПанели+""px; height: ""+ВысотаЦентрПанели+""px; "+
	   "margin-left: ""+ШиринаЛевойПанели+""px; } #text { width: 545px; font-size: .8em; color: #333; margin: 10px auto; float: left; } ""; КонецФункции ");
   М.Добавить("Функция СтрокаCSSfooter() экспорт Возврат "" #footer { background : ""+ЦветФонаПодвала+""; "+
       "height: ""+ВысотаПодвала+""px; width: ""+ШиринаПодвала+""px; color : ""+ЦветТекстаПодвала+""; font-size : 70%; padding : 5px; "+
	   "clear : both; float:left; } #footer a { color : #ff0; } #footer a:hover { color : #f00; } "+
	   "#footer p { padding : 2px; text-align : center; } ""; КонецФункции ");
   М.Добавить("Функция CSS() экспорт UfaScript.Запись.ЗаписатьСтроку(""<style type=""""text/css"""">""+СтрокаCSScontainer()"+
       "+СтрокаCSSheader()+СтрокаCSSleftpanel()+СтрокаCSSrightpanel()+СтрокаCSScenterpanel()+СтрокаCSSfooter()+""</style>"");  КонецФункции ");   
   М.Добавить("Функция СтрокаHTML() экспорт Возврат ""<html><body><div class=""""baza""""><div id=""""container"""">"+
       "<div id=""""header""""><div id=""""header-line""""></div><div id=""""header-menu""""></div></div>"+
	   "<div id=""""leftpanel""""><div class=""""main-menu""""></div><div class=""""user-login""""></div>"+
	   "<div class=""""userfull-link""""></div></div><div id=""""rightpanel""""></div>"+
	   "<div id=""""centerpanel""""><div id=""""top-content""""></div><div id=""""bot-content""""></div></div>"+
	   "<div id=""""footer""""></div></div> "";  КонецФункции ");   
   М.Добавить("Функция HTML() экспорт UfaScript.Запись.ЗаписатьСтроку(СтрокаHTML());  КонецФункции ");   
   Возврат М;
КонецФункции

Функция СоздатьОбъектHTMLШаблонБлочный() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLШаблонБлочный(Новый Массив)); Об.ИмяОбъекта="tabshablonblock"; Возврат Об;
КонецФункции

Функция РисунокCSS(Знач Рисунок="",Знач Повтор="repeat") экспорт
   Если Рисунок="" Тогда Возврат " "; КонецЕсли;  Возврат " background: url("+Рисунок+") "+Повтор+"; ";
КонецФункции

Функция ВыравниваниеCSS(Выравн) экспорт
   Если Выравн=0 Тогда Возврат " "; ИначеЕсли Выравн=1 Тогда Возврат "float: left;"; ИначеЕсли Выравн=2 Тогда Возврат "float: right;"; КонецЕсли;
КонецФункции

Функция ОбтеканиеCSS(Обтекание) экспорт
   Если Обтекание=0 Тогда Возврат " "; ИначеЕсли Обтекание=1 Тогда Возврат "clear: left;"; ИначеЕсли Обтекание=2 Тогда Возврат "clear: right;"; КонецЕсли;
КонецФункции

Функция ОбразОбъектCSSНастройки(М)      
   М.Добавить("Перем Пусто; ");
   М.Добавить("Функция ПолосаПрокрутки(ПолосаПрокрутки=0,Где="""") экспорт Строка=""""; Если ПолосаПрокрутки=0 Тогда Возврат """"; "+
      "ИначеЕсли ПолосаПрокрутки=1 Тогда Строка="" overflow""+Где+"": auto; ""; ИначеЕсли ПолосаПрокрутки=2 Тогда Строка="" overflow""+Где+"": hidden; ""; "+
	  "ИначеЕсли ПолосаПрокрутки=3 Тогда Строка="" overflow""+Где+"": scroll; ""; ИначеЕсли ПолосаПрокрутки=4 Тогда Строка="" overflow""+Где+"": visible; ""; "+
	  "КонецЕсли; Если Строка="""" Тогда Строка="" overflow""+Где+"": inherit; ""; КонецЕсли; Возврат Строка; КонецФункции");
   М.Добавить("Функция Бордюр(БордюрШирина=1,БордюрСтиль=0,БордюрЦвет=""black"",Где="""") экспорт Строка=""""; Если БордюрСтиль=0 Тогда Возврат """"; "+
      "ИначеЕсли БордюрСтиль=1 Тогда Строка="" dotted ""; ИначеЕсли БордюрСтиль=2 Тогда Возврат "" dashed ""; "+
      "ИначеЕсли БордюрСтиль=3 Тогда Строка="" solid "";  ИначеЕсли БордюрСтиль=4 Тогда Возврат "" double ""; "+
      "ИначеЕсли БордюрСтиль=5 Тогда Строка="" groove ""; ИначеЕсли БордюрСтиль=6 Тогда Возврат "" ridge ""; "+
      "ИначеЕсли БордюрСтиль=7 Тогда Строка="" inset "";  ИначеЕсли БордюрСтиль=8 Тогда Возврат "" outset ""; "+
	  "ИначеЕсли БордюрСтиль=9  Тогда Возврат "" border: inherit; ""; ИначеЕсли БордюрСтиль>9  Тогда Строка=""""; КонецЕсли; "+
	  "Возврат ""border""+Где+"": ""+БордюрШирина+""px ""+Строка+"" ""+БордюрЦвет+"";""; КонецФункции");
   М.Добавить("Функция Радиус(ВерхЛево=0,ВерхПраво=0,НизПраво=0,НизЛево=0) экспорт Строка=""""; Если ВерхЛево+ВерхПраво+НизПраво+НизЛево>0 Тогда "+
      "Строка="" border-radius: ""+ВерхЛево+""px ""+ВерхПраво+""px ""+НизПраво+""px ""+НизЛево+""px; ""; КонецЕсли; Возврат Строка; КонецФункции");
   М.Добавить("Функция ДекорацияТекста(ДекорацияТекста) экспорт Строка="""";  Если ДекорацияТекста=0 Тогда Возврат """"; "+
      "ИначеЕсли ДекорацияТекста=1 Тогда Строка="" blink""; ИначеЕсли ДекорацияТекста=2 Тогда Строка="" line-through""; "+
	  "ИначеЕсли ДекорацияТекста=3 Тогда Строка="" overline""; ИначеЕсли ДекорацияТекста=4 Тогда Строка="" underline""; "+
	  "ИначеЕсли ДекорацияТекста=5 Тогда Строка="" none""; ИначеЕсли ДекорацияТекста=6 Тогда Строка="" inherit""; КонецЕсли; "+   
	  "Строка="" text-decoration: ""+Строка+"";"";  Возврат Строка; "+
	  "КонецФункции");
   М.Добавить("Функция РазмерШрифта(РазмерШрифта) экспорт Если РазмерШрифта=0 Тогда Возврат """"; КонецЕсли; "+
      "Возврат "" font-size: ""+РазмерШрифта+""pt; "";  КонецФункции");
   М.Добавить("Функция НасыщенностьШрифта(НасыщенностьШрифта) экспорт Строка="" "";  Если НасыщенностьШрифта=0 Тогда Возврат "" ""; "+
      "ИначеЕсли НасыщенностьШрифта=1 Тогда Строка="" bold""; ИначеЕсли НасыщенностьШрифта=2 Тогда Строка="" bolder""; "+
	  "ИначеЕсли НасыщенностьШрифта=3 Тогда Строка="" lighter""; ИначеЕсли НасыщенностьШрифта=4 Тогда Строка="" normal""; "+
	  "ИначеЕсли НасыщенностьШрифта>99 Тогда Строка=НасыщенностьШрифта; КонецЕсли; "+
	  "Строка="" font-weight: ""+Строка+"";"";  Возврат Строка; "+
	  "КонецФункции");
   М.Добавить("Функция ВнешниеОтступы(ТипОтступов=0,Лево=0,Верх=0,Право=0,Низ=0) экспорт Строка=""""; Если ТипОтступов=0 Тогда Возврат """"; "+
      "ИначеЕсли ТипОтступов=3 Тогда Возврат "" margin: auto; ""; ИначеЕсли ТипОтступов=4 Тогда Возврат "" margin: inherit; ""; "+
      "ИначеЕсли ТипОтступов=1 Тогда Вставка = ""px""; ИначеЕсли ТипОтступов=2 Тогда Вставка = ""% ""; КонецЕсли; "+
	  "Строка="" margin: ""+Лево+Вставка+"" ""+Верх+Вставка+"" ""+Право+Вставка+"" ""+Низ+Вставка+""; ""; Возврат Строка; КонецФункции");
   М.Добавить("Функция ВнутренниеОтступы(ТипОтступов=0,Лево=0,Верх=0,Право=0,Низ=0) экспорт Строка=""""; Если ТипОтступов=0 Тогда Возврат """"; "+
      "ИначеЕсли ТипОтступов=3 Тогда Возврат "" padding: inherit; ""; "+
      "ИначеЕсли ТипОтступов=1 Тогда Вставка = ""px""; ИначеЕсли ТипОтступов=2 Тогда Вставка = ""% ""; КонецЕсли; "+
	  "Строка="" padding: ""+Лево+Вставка+"" ""+Верх+Вставка+"" ""+Право+Вставка+"" ""+Низ+Вставка+""; ""; Возврат Строка; КонецФункции");
   М.Добавить("Функция ФонРисунок(Знач Рисунок="""",Знач Повтор=0) экспорт Если Рисунок="""" Тогда Возврат """"; КонецЕсли; "+
      "СтрПовтор=""""; Если Повтор=0 Тогда СтрПовтор=""no-repeat""; ИначеЕсли Повтор=1 Тогда СтрПовтор=""repeat""; "+
	  "ИначеЕсли Повтор=2 Тогда СтрПовтор=""repeat-x""; ИначеЕсли Повтор=3 Тогда СтрПовтор=""repeat-y""; ИначеЕсли Повтор=4 Тогда "+
	  "СтрПовтор=""inherit""; КонецЕсли; Возврат "" background: url(""+Рисунок+"") ""+СтрПовтор+""; ""; КонецФункции");
   М.Добавить("Функция Выравнивание(Выравн) экспорт Если Выравн=0 Тогда Возврат """"; ИначеЕсли Выравн=1 Тогда Возврат "" float: left; ""; "+
      "ИначеЕсли Выравн=2 Тогда Возврат "" float: right; ""; ИначеЕсли Выравн=3 Тогда Возврат "" float: none; ""; ИначеЕсли Выравн=4 "+
	  "Тогда Возврат "" float: inherit; ""; КонецЕсли; КонецФункции");
   М.Добавить("Функция Обтекание(Обтекание) экспорт Если Обтекание=0 Тогда Возврат "" ""; ИначеЕсли Обтекание=1 Тогда Возврат "" clear: left; ""; "+
      "ИначеЕсли Обтекание=2 Тогда Возврат "" clear: right; ""; КонецЕсли; КонецФункции");
   М.Добавить("Функция Ширина(Ширина=0,Тип=0) экспорт Если Тип=0 Тогда Возврат """"; ИначеЕсли Тип=1 Тогда Возврат "" width: ""+Ширина+""px; ""; "+
      "ИначеЕсли Тип=2 Тогда Возврат "" width: ""+Ширина+""%; ""; ИначеЕсли Тип=3 Тогда Возврат "" width: auto; ""; КонецЕсли; "+
	  "Возврат "" width: inherit; ""; КонецФункции");
   М.Добавить("Функция Высота(Высота=0,Тип=0) экспорт Если Тип=0 Тогда Возврат """"; ИначеЕсли Тип=1 Тогда Возврат "" height: ""+Высота+""px; ""; "+
      "ИначеЕсли Тип=2 Тогда Возврат "" height: ""+Высота+""%; ""; ИначеЕсли Тип=3 Тогда Возврат "" height: auto; ""; КонецЕсли; "+
	  "Возврат "" height: inherit; ""; КонецФункции");
   М.Добавить("Функция ПозицияФонРис(ПозицияФонРис=0) экспорт Если ПозицияФонРис=0 Тогда Возврат """"; КонецЕсли; Строка=""""; "+
      "Если ПозицияФонРис=1 Тогда Строка="" top left""; ИначеЕсли ПозицияФонРис=2 Тогда Строка="" top""; "+
      "ИначеЕсли ПозицияФонРис=3 Тогда Строка="" right top""; ИначеЕсли ПозицияФонРис=4 Тогда Строка="" left""; "+
      "ИначеЕсли ПозицияФонРис=5 Тогда Строка="" center""; ИначеЕсли ПозицияФонРис=6 Тогда Строка="" right""; "+
      "ИначеЕсли ПозицияФонРис=7 Тогда Строка="" bottom left""; ИначеЕсли ПозицияФонРис=8 Тогда Строка="" bottom""; "+
      "ИначеЕсли ПозицияФонРис=9 Тогда Строка="" bottom right""; ИначеЕсли ПозицияФонРис=10 Тогда Строка="" inherit""; КонецЕсли; "+
      "Возврат ""background-position: ""+Строка+""; "";  КонецФункции");
   М.Добавить("Функция ОбластьПросмотра(Тип,X1,Y1,X2,Y2) экспорт Если Тип=0 Тогда Возврат """"; ИначеЕсли Тип=1 Тогда Возврат "" clip: inherit; ""; "+
      "ИначеЕсли Тип=2 Тогда Возврат "" clip: rect(""+X1+"", ""+Y1+"", ""+X2+"", ""+Y2+""); ""; КонецЕсли; КонецФункции");
   М.Добавить("Функция Позиция(Позиция) экспорт Если Позиция=0 Тогда Возврат """"; ИначеЕсли Позиция=1 Тогда Возврат "" position: absolute; ""; "+
      "ИначеЕсли Позиция=2 Тогда Возврат "" position: fixed; ""; ИначеЕсли Позиция=3 Тогда Возврат "" position: relative; ""; "+
	  "ИначеЕсли Позиция=4 Тогда Возврат "" position: static; ""; ИначеЕсли Позиция=5 Тогда Возврат "" position: inherit; ""; "+
	  "КонецЕсли; КонецФункции");
   М.Добавить("Функция ПереднийПлан(ПереднийПлан=0) экспорт Если ПереднийПлан=0 Тогда Возврат """"; ИначеЕсли ПереднийПлан=1 "+
      "Тогда Возврат "" z-index: auto; ""; ИначеЕсли ПереднийПлан=2 Тогда Возврат "" z-index: inherit; ""; ИначеЕсли ПереднийПлан>2 "+
	  "Тогда Возврат "" z-index: ""+ПереднийПлан+""; ""; КонецЕсли; КонецФункции");
   М.Добавить("Функция СпособПоказа(СпособПоказа=0) экспорт Если СпособПоказа=0 Тогда Возврат """"; ИначеЕсли СпособПоказа=1 "+
      "Тогда Возврат "" display: block; ""; ИначеЕсли СпособПоказа=2 Тогда Возврат "" display: inline; ""; ИначеЕсли СпособПоказа=3 "+
	  "Тогда Возврат "" display: inline-block; ""; ИначеЕсли СпособПоказа=4 Тогда Возврат "" display: inline-table; ""; "+
	  "ИначеЕсли СпособПоказа=5 Тогда Возврат "" display: list-item; ""; ИначеЕсли СпособПоказа=6 Тогда Возврат "" display: none; ""; "+
	  "ИначеЕсли СпособПоказа=7 Тогда Возврат "" display: run-in; ""; ИначеЕсли СпособПоказа=8 Тогда Возврат "" display: table; ""; "+
	  "ИначеЕсли СпособПоказа=9 Тогда Возврат "" display: table-caption; ""; ИначеЕсли СпособПоказа=10 Тогда Возврат "" display: table-cell; ""; "+
	  "ИначеЕсли СпособПоказа=11 Тогда Возврат "" display: table-column-group; ""; ИначеЕсли СпособПоказа=12 Тогда Возврат "" display: table-column; ""; "+
	  "ИначеЕсли СпособПоказа=13 Тогда Возврат "" display: table-footer-group; ""; ИначеЕсли СпособПоказа=14 Тогда Возврат "" display: table-header-group; ""; "+
	  "ИначеЕсли СпособПоказа=14 Тогда Возврат "" display: table-row; ""; ИначеЕсли СпособПоказа=15 Тогда Возврат "" display: table-row-group; ""; "+
	  "КонецЕсли; КонецФункции");
   М.Добавить("Функция ПереносСтрок(ПереносСтрок=0) экспорт Если ПереносСтрок=0 Тогда Возврат """"; ИначеЕсли ПереносСтрок=1 "+
      "Тогда Возврат "" white-space: normal; ""; ИначеЕсли ПереносСтрок=2 Тогда Возврат "" white-space: nowrap; ""; ИначеЕсли ПереносСтрок=3 "+
	  "Тогда Возврат "" white-space: pre; ""; ИначеЕсли ПереносСтрок=4 Тогда Возврат "" white-space: pre-line; ""; "+
	  "ИначеЕсли ПереносСтрок=5 Тогда Возврат "" white-space: pre-wrap; ""; ИначеЕсли ПереносСтрок=6 Тогда Возврат "" white-space: inherit; ""; "+
	  "КонецЕсли; КонецФункции");
   М.Добавить("Функция Прозрачность(Прозрачность=2) экспорт Если Прозрачность>1 Тогда Возврат """"; КонецЕсли;  "+
      " Возврат "" opacity: ""+Прозрачность+""; ""; КонецФункции");
   Возврат М;
КонецФункции  

//?Вызов: СоздатьОбъектCSSНастройки()
//?Параметры:  отсутствуют
//?Описание: Создает объект с функциями CSS-настроек 
//?Поиск: OneScript CSS  
Функция СоздатьОбъектCSSНастройки() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектCSSНастройки(Новый Массив)); Об.ИмяОбъекта="CSS"; Возврат Об;
КонецФункции

Функция ОбразОбъектCSSDiv(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем ЦветФона экспорт; Перем ЦветТекста экспорт; Перем КлассОбъекта экспорт; Перем Вложение экспорт; "+
      "Перем Ширина экспорт; Перем ТипШирина экспорт; Перем Высота экспорт; Перем ТипВысота экспорт; Перем Позиция экспорт; "+
	  "Перем РазмерШрифта экспорт; Перем НасыщенностьШрифта экспорт; Перем ПереднийПлан экспорт; "+
      "Перем Выравнивание экспорт; Перем Обтекание экспорт; Перем Рисунок экспорт; Перем ПовторРисунка экспорт; Перем ПозицияФонРис экспорт; "+
	  "Перем ПолосаПрокрутки экспорт; Перем ПолосаПрокруткиГоризонт экспорт; Перем ПолосаПрокруткиВертикаль экспорт; "+
	  "Перем БордюрШирина экспорт; Перем БордюрВерхШирина экспорт; Перем БордюрНизШирина экспорт; Перем Прозрачность экспорт; "+
	  "Перем БордюрЛевоШирина экспорт; Перем БордюрПравоШирина экспорт; Перем БордюрСтиль экспорт; Перем БордюрВерхСтиль экспорт; "+
	  "Перем БордюрНизСтиль экспорт; Перем БордюрЛевоСтиль экспорт; Перем БордюрПравоСтиль экспорт; Перем ДекорацияТекста экспорт; "+
	  "Перем БордюрЦвет экспорт; Перем БордюрВерхЦвет экспорт; Перем БордюрНизЦвет экспорт; Перем БордюрЛевоЦвет экспорт; Перем БордюрПравоЦвет экспорт; "+
	  "Перем РадиусВерхЛево экспорт; Перем РадиусВерхПраво экспорт; Перем РадиусНизПраво экспорт; Перем РадиусНизЛево экспорт; "+
	  "Перем ТипОтступов экспорт; Перем ОтступЛево экспорт; Перем ОтступВерх экспорт; Перем ОтступПраво экспорт; Перем ОтступНиз экспорт; "+ 
	  "Перем ТипВнутрОтступов экспорт; Перем ВнутрОтступЛево экспорт; Перем ВнутрОтступВерх экспорт; Перем ВнутрОтступПраво экспорт; "+
	  "Перем ВнутрОтступНиз экспорт; Перем ТипОкнаПросмотра экспорт; Перем ОкноПросмX1 экспорт; Перем ОкноПросмY1 экспорт; Перем ОкноПросмX2 экспорт; "+
	  "Перем ОкноПросмY2 экспорт; Перем СпособПоказа экспорт; Перем ПереносСтрок экспорт; Перем CSS экспорт; ");
   М.Добавить("Функция Конструктор() экспорт ЦветФона=""#EEF3C5""; Ширина=100; ТипШирина=0; Высота=100; ТипВысота=0; Выравнивание=1; Обтекание=0; "+
      "КлассОбъекта=""""; ПолосаПрокрутки=0; ПолосаПрокруткиГоризонт=0; ПолосаПрокруткиВертикаль=0; "+
	  "БордюрШирина=1; БордюрСтиль=0; БордюрЦвет=""black""; БордюрВерхШирина=1; БордюрВерхСтиль=0; БордюрВерхЦвет=""black""; "+
	  "БордюрНизШирина=1; БордюрНизСтиль=0; БордюрНизЦвет=""black""; БордюрЛевоШирина=1; БордюрЛевоСтиль=0; БордюрЛевоЦвет=""black""; "+
	  "БордюрПравоШирина=1; БордюрПравоСтиль=0; БордюрПравоЦвет=""black""; РадиусВерхЛево=0; РадиусВерхПраво=0; РадиусНизПраво=0; "+
	  "РадиусНизЛево=0; ДекорацияТекста=0; РазмерШрифта=0; НасыщенностьШрифта=0; ТипОтступов=0; ОтступЛево=0; ОтступВерх=0; ОтступПраво=0; "+
	  "ОтступНиз=0; ТипВнутрОтступов=0; ВнутрОтступЛево=0; ВнутрОтступВерх=0; ВнутрОтступПраво=0; ВнутрОтступНиз=0; Рисунок=""""; ПовторРисунка=0; "+
	  "ПозицияФонРис=0; ТипОкнаПросмотра=0; ОкноПросмX1=0; ОкноПросмY1=0; ОкноПросмX2=Ширина; ОкноПросмY2=Высота; Позиция=0; ПереднийПлан=0; "+
	  "СпособПоказа=0; ПереносСтрок=0; Прозрачность=2; CSS=UfaScript.СоздатьОбъектCSSНастройки(); КонецФункции "); 
   М.Добавить("Функция СубСтрокаCSS() экспорт Возврат "" { background : ""+ЦветФона+""; ""+CSS.Ширина(Ширина,ТипШирина)+"+
      "CSS.Высота(Высота,ТипВысота)+CSS.Выравнивание(Выравнивание)+CSS.Обтекание(Обтекание)+CSS.ПолосаПрокрутки(ПолосаПрокрутки)+"+
	  "CSS.ПолосаПрокрутки(ПолосаПрокруткиГоризонт,""-x"")+CSS.ПолосаПрокрутки(ПолосаПрокруткиВертикаль,""-y"")+CSS.Бордюр(БордюрШирина,БордюрСтиль,БордюрЦвет)+"+
	  "CSS.Бордюр(БордюрВерхШирина,БордюрВерхСтиль,БордюрВерхЦвет,""-top"")+CSS.Бордюр(БордюрНизШирина,БордюрНизСтиль,БордюрНизЦвет,""-bottom"")+"+
	  "CSS.Бордюр(БордюрЛевоШирина,БордюрЛевоСтиль,БордюрЛевоЦвет,""-left"")+CSS.Бордюр(БордюрПравоШирина,БордюрПравоСтиль,БордюрПравоЦвет,""-right"")+"+
	  "CSS.Радиус(РадиусВерхЛево,РадиусВерхПраво,РадиусНизПраво,РадиусНизЛево)+CSS.ДекорацияТекста(ДекорацияТекста)+CSS.РазмерШрифта(РазмерШрифта)+"+
	  "CSS.НасыщенностьШрифта(НасыщенностьШрифта)+CSS.ВнешниеОтступы(ТипОтступов,ОтступЛево,ОтступВерх,ОтступПраво,ОтступНиз)+"+
	  "CSS.ВнутренниеОтступы(ТипВнутрОтступов,ВнутрОтступЛево,ВнутрОтступВерх,ВнутрОтступПраво,ВнутрОтступНиз)+CSS.ФонРисунок(Рисунок,ПовторРисунка)+"+
	  "CSS.ПозицияФонРис(ПозицияФонРис)+CSS.ОбластьПросмотра(ТипОкнаПросмотра,ОкноПросмX1,ОкноПросмY1,ОкноПросмX2,ОкноПросмY2)+"+
	  "CSS.Позиция(Позиция)+CSS.ПереднийПлан(ПереднийПлан)+CSS.СпособПоказа(СпособПоказа)+CSS.ПереносСтрок(ПереносСтрок)+"+
	  "CSS.Прозрачность(Прозрачность)+"" } ""; КонецФункции ");   
   М.Добавить("Функция СтрокаCSS() экспорт Возврат "" #""+ИмяОбъекта+"" ""+СубСтрокаCSS(); КонецФункции ");
   М.Добавить("Функция СтрокаCSSДляID(NamID) экспорт Возврат "" #""+NamID+"" ""+СубСтрокаCSS(); КонецФункции ");
   М.Добавить("Функция СтрокаCSSДляClass(NamClass) экспорт Возврат "" .""+NamClass+"" ""+СубСтрокаCSS(); КонецФункции ");
   М.Добавить("Функция CSS() экспорт UfaScript.Запись.ЗаписатьСтроку(СтрокаCSS()); КонецФункции "); 
   М.Добавить("Функция СтрокаHTML() экспорт Возврат ""<div id=""+ИмяОбъекта+"" class=""+КлассОбъекта+"">""+Вложение+""</div>""; "+
      "КонецФункции "); 
   М.Добавить("Функция HTML() экспорт UfaScript.Запись.ЗаписатьСтроку(СтрокаHTML());  КонецФункции ");   
   М.Добавить("Функция СтрокаДляAjax() экспорт Возврат ""<style type=""""text/css"""">""+СтрокаCSS()+""</style>"+
      " ""+СтрокаHTML()+"" "";  КонецФункции ");   
   Возврат М;
КонецФункции  

//?Вызов: СоздатьОбъектCSSDiv(Префикс,Знач Вложение="")
//?Параметры:  Префикс - id элемента div, Вложение - Вставки в состав данного Div других Div-строк
//?Описание: Создает объект-div для страницы клиента. Пример: DivБаза=U.СоздатьОбъектCSSDiv("baza",Divheader.СтрокаHTML()+Divleft.СтрокаHTML()); 
//?Далее:       Div имеет множество настроек для генерации CSS-кода (см.конструктор объекта)
//?Поиск: JS CSS Объект Клиент 
Функция СоздатьОбъектCSSDiv(Префикс,Знач Вложение="") экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектCSSDiv(Новый Массив)); Об.ИмяОбъекта=Префикс; Об.Вложение=Вложение	; Возврат Об;
КонецФункции

Функция ОбразОбъектHTMLШаблонCSSDiv(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М=СубОбъектHTMLШаблонБазовый(М);
   М.Добавить("Перем ОбъектыDiv экспорт; Перем ПутьКФайлу экспорт; Перем ИмяФайла экспорт; Перем Запись экспорт; Перем Joomla экспорт;");
   М.Добавить("Функция Конструктор() экспорт СубКонструктор(); ОбъектыDiv=Новый Массив; ПутьКФайлу=""""; Joomla=Ложь; Запись=Новый ЗаписьТекста; "+
      "ИмяФайла=""Index.php""; UfaScript.Запись=Запись; КонецФункции ");
   М.Добавить("Функция Инициализация() экспорт Запись.Открыть(ПутьКФайлу+ИмяФайла); Запись.ЗаписатьСтроку(СтрокаНачало(Joomla)+"+
      "СтрокаЗаголовокHTML(Joomla)+СтрокаОбщиеПравилаДляСтраницы()+СтрокаCSS()+СтрокаHTML()); КонецФункции ");
   М.Добавить("Функция ОбъектыDivHTML() экспорт Строка=""""; Если ОбъектыDiv.Количество()>0 Тогда Возврат ОбъектыDiv[0].СтрокаHTML(); "+
      "КонецЕсли; КонецФункции ");   
   М.Добавить("Функция СтрокаHTML() экспорт Возврат ""<html><body>""+ОбъектыDivHTML();  КонецФункции ");   
   М.Добавить("Функция HTML() экспорт Запись.ЗаписатьСтроку(СтрокаHTML());  КонецФункции ");   
   М.Добавить("Функция СтрокаCSS() экспорт Строка=""<style type=""""text/css"""">""; Для сч=0 По ОбъектыDiv.Количество()-1 "+
       "Цикл Строка=Строка+ОбъектыDiv[сч].СтрокаCSS(); КонецЦикла; Возврат Строка+""</style>""; КонецФункции "); 
   М.Добавить("Функция CSS() экспорт Запись.ЗаписатьСтроку(СтрокаCSS()); КонецФункции "); 
   М.Добавить("Функция Div(Об) экспорт ОбъектыDiv.Добавить(Об); Возврат ЭтотОбъект; КонецФункции "); 
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLШаблонCSSDiv()
//?Параметры: Отсутствуют 
//?Описание: Создает объект-шаблон для страницы клиента. Следует создать нужные Div и зарегистрировать их. Например, Шаблон.Div(DivБаза).Div(Divheader);
//?Далее:       Div создавать функцией СоздатьОбъектCSSDiv(). Затем провести Шаблон.Инициализация();  По умолчанию создаваемый php-файл - Index.php.
//?Далее:       Задать другое имя: Шаблон.ИмяФайла="Index1.html";
//?Поиск: JS CSS Объект Клиент Шаблон
Функция СоздатьОбъектHTMLШаблонCSSDiv() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLШаблонCSSDiv(Новый Массив)); Возврат Об;
КонецФункции

//---------------------  Шаблоны (конец) ------------------------------------------------------------------

//---------------------  Форма ввода текста и пересылки файла ------------------------------------------------------------------

Функция ОбразОбъектHTMLПолеВвода(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем ИмяПоля экспорт; Перем ТипПоля экспорт; Перем ШиринаПоля экспорт; Перем ТекстКнопки экспорт;");
   М.Добавить("Функция Конструктор() экспорт ТипПоля=""text""; ШиринаПоля=40; КонецФункции ");
   М.Добавить("Функция СтрокаHTML() экспорт Возврат ""<input type=""""""+ТипПоля+"""""" name=""""""+ИмяПоля+"""""" "+
      "size=""+ШиринаПоля+"" value=""+ТекстКнопки+"">"";  КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLПолеВвода(ИмяПоля,Ширина=40)
//?Параметры: ИмяПоля - Уникальное имя поля на английском 
//?Описание: Создает поле ввода на HTML-странице
//?Поиск: HTML Клиент Ввод
Функция СоздатьОбъектHTMLПолеВвода(ИмяПоля,Ширина=40) экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLПолеВвода(Новый Массив)); Об.ИмяПоля=ИмяПоля; Об.ШиринаПоля=Ширина;  Возврат Об;
КонецФункции

Функция ОбразОбъектHTMLВводТекста(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем ИмяПоля экспорт; Перем Строк экспорт; Перем Символов экспорт; Перем Text экспорт;");
   М.Добавить("Функция Конструктор() экспорт ИмяПоля=""Text1""; Строк=5; Символов=40; Text=""""; КонецФункции ");
   М.Добавить("Функция СтрокаHTML() экспорт Возврат ""<textarea name=""""""+ИмяПоля+"""""" rows=""""""+Строк+"""""" "+
       "cols=""""""+Символов+"""""">""+Text+""</textarea>"";  КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLВводТекста (ИмяПоля,Строк=5,Символов=40)
//?Параметры: ИмяПоля - Уникальное имя поля на английском, Строк - число отображаемых строк, Символов - число символов в строке 
//?Описание: Создает поле для ввода многострочного текста на HTML-странице
//?Поиск: HTML Клиент Ввод
Функция СоздатьОбъектHTMLВводТекста(ИмяПоля,Строк=5,Символов=40) экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLВводТекста(Новый Массив)); Об.ИмяПоля=ИмяПоля; 
     Об.Строк=Строк; Об.Символов=Символов;  Возврат Об;
КонецФункции

Функция ОбразОбъектHTMLФорма(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем ФайлСервера экспорт; Перем Метод экспорт;");
   М.Добавить("Функция Конструктор() экспорт Метод=""post""; ФайлСервера=""Server.php""; КонецФункции ");
   М.Добавить("Функция СтрокаHTML(HTMLКод) экспорт Возврат ""<form enctype=""""multipart/form-data"""" action=""""""+ФайлСервера+"""""" "+
      "metod=""""""+Метод+"""""" >""+HTMLКод+""</form>"";  КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLФорма()
//?Параметры: Отсутствуют 
//?Описание: Создает форму на HTML-странице
//?Поиск: HTML Клиент Форма Ввод
Функция СоздатьОбъектHTMLФорма() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLФорма(Новый Массив));  Возврат Об;
КонецФункции

Функция СтрокаОднаЯчейкаТаблицы(Текст,Выравнивать=1) экспорт
  Если Выравнивать=1 Тогда В="left"; ИначеЕсли Выравнивать=2 Тогда В="center"; Иначе В="rigth"; КонецЕсли; 
  Возврат "<tr><td style=""text-align:"+В+""">"+Текст+"</td></tr>";
КонецФункции

// На основе примера http://www.proinfosystem.com/articles/php-script.html
Функция Строка_HTMLФормаДляОтправкиСообщений() экспорт
  HTMLТаблицаНачало="<table border=""0"" width=""30"" cellspacing=""0"">";

  HTMLТаблицаСтрока1=СтрокаОднаЯчейкаТаблицы("<b>Поле N1</b>");
	
    ПолеВвода=СоздатьОбъектHTMLПолеВвода("Pole1");
  HTMLТаблицаСтрока2=СтрокаОднаЯчейкаТаблицы(ПолеВвода.СтрокаHTML());

  HTMLТаблицаСтрока3=СтрокаОднаЯчейкаТаблицы("<b>Поле N2</b>");

    ВводТекста=СоздатьОбъектHTMLВводТекста("Pole2");
  HTMLТаблицаСтрока4=СтрокаОднаЯчейкаТаблицы(ВводТекста.СтрокаHTML());

  HTMLТаблицаСтрока5=СтрокаОднаЯчейкаТаблицы("<b>Присоединить файл(не более 2Мбайт):</b>");

    ПолеВвода.ИмяПоля="fail"; ПолеВвода.ТипПоля="file";   // кнопка присоединить файл
  HTMLТаблицаСтрока6=СтрокаОднаЯчейкаТаблицы(ВводТекста.СтрокаHTML());

     ПолеВвода.ИмяПоля="submit";  ПолеВвода.ТипПоля="submit";  ПолеВвода.ТекстКнопки="Отправить";
	 СтрокаКнопкиОтправить=ПолеВвода.СтрокаHTML();
     ПолеВвода.ИмяПоля="res";  ПолеВвода.ТипПоля="reset";  ПолеВвода.ТекстКнопки="Очистить";
	 СтрокаКнопкиОчистить=ПолеВвода.СтрокаHTML();
  HTMLТаблицаСтрока7="<tr><td height=""30""><center>"+СтрокаКнопкиОтправить+"___"+СтрокаКнопкиОчистить+"</center></td></tr></table>";

  HTMLКод=HTMLТаблицаНачало+HTMLТаблицаСтрока1+HTMLТаблицаСтрока2+HTMLТаблицаСтрока3+HTMLТаблицаСтрока4+HTMLТаблицаСтрока5+
     HTMLТаблицаСтрока6+HTMLТаблицаСтрока7;

   Форма = СоздатьОбъектHTMLФорма();  Возврат Форма.СтрокаHTML(HTMLКод);
КонецФункции

Функция Строка_PHPФормаДляОтправкиСообщений() экспорт
  Возврат "<?php $myemail=""""; $refreshpage=""Страница с формой""; $maxmsg=""1500""; "+
      "$back_pole1=""<script language='JavaScript'>alert('Поле N1 не введено.');</script>""; "+
      "$back_pole2=""<script language='JavaScript'>alert('Произошла ошибка. Ваше сообщение или пустое или превышает $maxmsg "+
	  "символов.');</script>"";$send_mail=""<script language='JavaScript'>alert('Ваше сообщение успешно отправлено.');</script>"";"+
      "$size_big=""<script language='JavaScript'>alert('Размер файла более 2Мбайт.');</script>""; "+
      "$pole1=$_POST['pole1']; $pole2=$_POST['pole2'];"+
      "if($pole1==""""){print""$back_pole1"";print""<script language='JavaScript'><!--"+ 
    "function reload(){location=\""$refreshpage\"";setTimeout('reload()',0);}//--></script>"";exit;} "+
      "if($pole2==""""||strlen($pole2)>$maxmsg){print""$back_pole2"";print""<script language='JavaScript'><!-- "+
    "function reload(){location=\""$refreshpage\"";setTimeout('reload()',0);}//--></script>"";exit;}"+
      "if(empty($_FILES['fail']['tmp_name'])){$myfail='Файл не был добавлен.';}"+
      "if(!empty($_FILES['fail']['tmp_name'])){if($_FILES['fail']['size']>2097152){print ""$size_big"";"+
      "print ""<script language='JavaScript'><!--function reload(){location=\""$refreshpage\"";setTimeout('reload()',0);}//-->"+
	  "</script>"";exit;}else{$fail_name=$_FILES['fail']['name']; $fail_size=$_FILES['fail']['size'];"+
      "$myfail='Имя: '.$fail_name.' Размер: '.$fail_size.' Находится в папке fails на сервере'; $uploaddir='fails/';"+ 
      "$uploadfiles=$uploaddir.basename($_FILES['fail']['name']); if(copy($_FILES['fail']['tmp_name'],$uploadfile))"+
      "{echo ""<h3>Файл успешно загружен на сервер</h3>"";}else{echo ""<h3>Ошибка! Не удалось загрузить файл на сервер!</h3>"";"+
	  "exit;}}}$headers=""Content-Type:text/plain;charset=utf-8\r\n""; $allmsg='1. Поле N 1: '.$pole1.chr(13).chr(10)."+
      "'2. Сообщение: '.$pole1.chr(13).chr(10).'3. Файл: '.$myfail.chr(13).chr(10);mail($myemail,""Сообщение"",$allmsg,$headers);"+
      "print""$send_mail"";print ""<script language='JavaScript'><!--function reload(){location=\""$refreshpage\"";"+
      "setTimeout('reload()',0);}//--></script>""; ?>";
КонецФункции

Функция ОбразОбъектHTMLФормаДляОтправкиСообщений(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем ФайлСервера экспорт; Перем Метод экспорт;");
   М.Добавить("Функция Конструктор() экспорт Метод=""post""; ФайлСервера=""Server.php""; КонецФункции ");
   М.Добавить("Функция СтрокаHTML() экспорт Возврат UfaScript.Строка_HTMLФормаДляОтправкиСообщений();  КонецФункции ");   
   М.Добавить("Функция СтрокаPHP() экспорт Возврат UfaScript.Строка_PHPФормаДляОтправкиСообщений();  КонецФункции ");   
   Возврат М;
КонецФункции

//?Вызов: СоздатьОбъектHTMLФормаДляОтправкиСообщений()
//?Параметры: Отсутствуют 
//?Описание: Создает форму для отправки сообщений на HTML-странице
//?Поиск: HTML Клиент Форма Ввод
Функция СоздатьОбъектHTMLФормаДляОтправкиСообщений() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектHTMLФормаДляОтправкиСообщений(Новый Массив));  Возврат Об;
КонецФункции


//---------------------  Форма ввода текста и пересылки файла (конец) ------------------------------------------------------------------

//Имя: Запись_CSSДляВерхнихКартинок()
//Описание: Установить CSS для трех верхних картинок
//Категория: Joomla CSS 
Функция Запись_CSSДляВерхнихКартинок() экспорт
  Запись.ЗаписатьСтроку(" .top-left{ text-align:left; padding:1px; border: 4px solid #91725e;  Width:90%; } "+
    ".top-center{ text-align:center; padding:1px; border: 4px solid #91725e; Width:90%; } "+
    ".top-right{ text-align:right; padding:1px; border: 4px solid #91725e;  Width:90%; } .img{ Width:99% } ");
КонецФункции

Функция Запись_ТриВерхниеКартинки(imgLeft,imgCenter,imgRight) экспорт
   Запись.ЗаписатьСтроку("<table><tr><td><div class=""top-left""><a href=""<?php $JUri; ?>""><img class=""logotip img"" src=""<?php echo $JUri.""/templates/""."+
      "$doc->template; ?>/images/"+imgLeft+""" alt=""<?php echo $LOGOTIP; ?>"" /></a><jdoc:include type=""modules"" name=""position-6"" /></div></td><td>"+
      " <div class=""top-center""><a href=""<?php $JUri; ?>""><img class=""center img"" src=""<?php echo $JUri.""/templates/"".$doc->template; "+
      "?>/images/"+imgCenter+""" alt=""<?php echo ""TopCenter.jpg""; ?>"" /></a></div></td>  <td><div class=""top-right""><a href=""<?php $JUri; ?>"">"+
      "<img class=""right img"" src=""<?php echo $JUri.""/templates/"".$doc->template; ?>/images/"+imgRight+""" alt=""<?php echo ""TopRight.jpg""; ?>"" />"+
     "</a></div></td></tr></table>");
КонецФункции

//?Вызов: Строка_HTMLСсылкаНаJSФункцию(Функц,Текст,Знач ИД="")
//?Параметры: Функц - JS-функция, которая будет запускаться при нажатии на ссылку. Текст - текст ссылки, ИД - id-ссылки
//?Описание: Формирует строку ссылки у клиента, при нажании на которую запустится JS-функция
//?Поиск: HTML Строка Клиент
Функция Строка_HTMLСсылкаНаJSФункцию(Функц,Текст,Знач ИД="") экспорт
   Возврат " <a href=""#"" onclick="""+Функц+";"" id="""+ИД+""">"+Текст+"</a> ";
КонецФункции

//?Вызов: НачатьЗаписьСервера(JoomlaЕсть)
//?Параметры: JoomlaЕсть - Истина или ложь. Генерируется код для Joomla, либо обычный
//?Описание: Открывает для записи файл Server.php (Joomla=Ложь - в текущем каталоге)
//?Поиск: OneScript Строка 
Функция НачатьЗаписьСервера(JoomlaЕсть) экспорт
  Если JoomlaЕсть Тогда ИмяФайла="../../Server.php"; ИначеЕсли  НЕ JoomlaЕсть Тогда ИмяФайла="Server.php"; КонецЕсли; 
  Запись = Новый ЗаписьТекста;  Запись.Открыть(ИмяФайла);  Возврат Запись;
КонецФункции

//?Вызов: ЗаменаОдинарныхКавычек(Текст)
//?Параметры: Текст - строка, в которой производится замена
//?Описание: Заменяет в строке одинарные кавычки на "&#039"
//?Поиск: OneScript Строка 
Функция ЗаменаОдинарныхКавычек(Текст) экспорт
   Возврат СтрЗаменить(Текст,"'","&#039");;
КонецФункции

//---------------------  Функции PHP ------------------------------------------------------------------
Функция PHPСтрока_СегодняДата() экспорт
  Возврат " echo date(""d-m-y G:i""); ";
КонецФункции

Функция PHPСтрока_СформироватьArrИзСтроки(Стр) экспорт
   Возврат " $Str="""+Стр+"""; $arr=explode(',',$Str); ";
КонецФункции

Функция PHPСтрока_СоединениеMySQL(Имя,Пользователь,Пароль,ИмяБазы) экспорт
  Возврат " $link=mysql_connect("""+Имя+""","""+Пользователь+""","""+Пароль+""") or die(""Не могу соединиться: "".mysql_error()); mysql_select_db("""+ИмяБазы+""") "+
     "or die(""Не работает: "".mysql_error()); ";
КонецФункции

Функция PHPСтрока_SQLЗапрос(Текст) экспорт
   Возврат " $sql="""+Текст+"""; $result = mysql_query($sql) or die(mysql_error()); ";
КонецФункции

Функция PHPСтрока_ИнфоPHP() экспорт
   Возврат " echo phpinfo(); ";
КонецФункции

//?Вызов: PHPСтрока_ПараметрыВФайлПараметр()
//?Параметры: PHP($str - строка с данными, которые записываются)
//?Описание: Создает php-функцию на сервере для записи строки в файл Parametr.txt (входит в состав СтрокаPHP_ФункцииСервера())  
//?Поиск: PHP Сервер файл 
Функция PHPСтрока_ПараметрыВФайлПараметр() экспорт
   Возврат " function ParametryVFailParametr($str){$fd=fopen(""Parametr.txt"",""w"") or die(""не удалось создать файл"");fwrite($fd,$str);fclose($fd);} "; 
КонецФункции   

//?Вызов: СтрокаPHP_ФункцияWriteTextVFile()
//?Параметры: PHP($NamFile - имя файла, $text - текст который записывается в файл)
//?Описание: Создает php-функцию на сервере для записи текста в указанный файл (входит в состав СтрокаPHP_ФункцииСервера())  
//?Поиск: PHP Сервер файл  
Функция СтрокаPHP_ФункцияWriteTextVFile() экспорт
  Возврат " function WriteTextVFile($NamFile,$text){$fd=fopen($NamFile,""a"") or die(""не удалось записать в файл"");fwrite($fd,$text);fclose($fd);} ";
КонецФункции

Функция СтрокаPHP_СерверВернутьОтвет(Значение1,ТекстОтвета) экспорт
   Возврат " if ($_POST['f'] == "+Значение1+") { $str='"+ЗаменаОдинарныхКавычек(ТекстОтвета)+"'; echo $str; }";
КонецФункции  // echo '"+ЗаменаОдинарныхКавычек(ТекстОтвета)+"';   htmlspecialchars_decode(responseText,'ENT_QUOTES');

Функция СтрокаPHP_СерверВыполнитьКод(Значение1,ТекстКода) экспорт
   Возврат " if($_POST['f']=="+Значение1+"){$data=$_POST['data'];"+ТекстКода+"} ";
КонецФункции

//?Вызов: СтрокаPHP_ФункцияDeleteFile()
//?Параметры: PHP($filename - имя удаляемого файла)
//?Описание: Создает php-функцию на сервере для удаления указанного файла (входит в состав СтрокаPHP_ФункцииСервера())  
//?Поиск: PHP Сервер файл  
Функция СтрокаPHP_ФункцияDeleteFile() экспорт
  Возврат " function DeleteFile($filename){$ErrorDel='Ошибка удаления файла.';if(isset($_ENV['WINDIR'])){@exec('del '.$filename);"+
    "if(file_exists($filename))die($ErrorDel);}else if(!(@unlink($filename))){die($ErrorDel);}} ";
КонецФункции

Функция СтрокаPHP_ФункцияLoadFromArrayAjaxPOST() экспорт
  Возврат " function LoadFromArrayAjaxPOST() {  }";
КонецФункции

//?Вызов: СтрокаPHP_ФункцияGeneratePassword()
//?Параметры: PHP($length=18 - количество символов с строке пароля)
//?Описание: Создает php-функцию на сервере для генерации уникального пароля (входит в состав СтрокаPHP_ФункцииСервера())  
//?Поиск: PHP Сервер  
Функция СтрокаPHP_ФункцияGeneratePassword() экспорт
  Возврат " function GeneratePassword($length=18) { $chars='abdefhiknrstyzABDEFGHKNQRSTYZ23456789'; $numChars=strlen($chars); $string=''; "+
     "for ($i=0; $i<$length; $i++) { $string.=substr($chars,rand(1,$numChars)-1,1); } return $string; }";
КонецФункции    

//?Вызов: СтрокаPHP_ФункцииСервера()
//?Параметры: отсутствуют
//?Описание: Создает нужные php-функции на сервере   
//?Поиск: PHP Сервер  
Функция СтрокаPHP_ФункцииСервера() экспорт
  Возврат СтрокаPHP_ФункцияLoadFromArrayAjaxPOST()+СтрокаPHP_ФункцияDeleteFile()+СтрокаPHP_ФункцияGeneratePassword()+
     PHPСтрока_ПараметрыВФайлПараметр()+СтрокаPHP_ФункцияWriteTextVFile();
КонецФункции

Функция СтрокаPHP_ОтключитьКеширование() экспорт   // выдает ошибку
  Возврат "<?php header(""Expires: Mon, 26 Jul 1997 05:00:00 GMT"");  ?>";
КонецФункции
//header(""Expires: Mon, 26 Jul 1997 05:00:00 GMT"");  header(""Last-Modified: "".gmdate(""D, d M Y H:i:s"")."" GMT""); "+
//     "header(""Cache-Control: no-cache, must-revalidate"");  header(""Cache-Control: post-check=0,pre-check=0"", false); "+
//     "header(""Cache-Control: max-age=0"", false);  header(""Pragma: no-cache"");

// Создать таблицу              CREATE TABLE test (id INT AUTO_INCREMENT PRIMARY KEY, maintext TEXT, title VARCHAR(100))
// Создание новой записи        INSERT INTO test SET maintext='$mt', title='заголовок'
// Изменение записи             UPDATE test SET title='заголовок' where id='3'
// LIMIT 1 - получим только 1 запись, LIMIT 5,10 - 10 записей, начиная с 5-ой 
// Обработка SQL-выборки в PHP  while($r=mysql_fetch_assoc($result)) { echo "Текст: ".$r['maintext']; echo "<br>под номером: ".$r['id']; }
// При отладке используйте функцию var_dump($a);  можно var_dump($POST);
 
//---------------------  Функции PHP (конец) ------------------------------------------------------------------

//---------------------  Функции Ajax-OneScript ------------------------------------------------------------------
//?Вызов: СтрокаPHP_OneScriptЗаписатьТекстВФайлИВернутьОтвет (Значение1,ТекстЗапроса)
//?Параметры: Значение1 - код запроса, ТекстЗапроса 
//?Описание: Создает php-код на сервере для передачи запроса через файл Param.txt другому приложению и возврат ответа клиенту из файла otvet.txt.  
//?Далее:       Например, можно организовать связь между запущенной программой OneScript и клиентом.
//?Поиск: PHP Сервер OneScript 
Функция СтрокаPHP_OneScriptЗаписатьТекстВФайлИВернутьОтвет(Значение1,ТекстЗапроса) экспорт
   Возврат " $dirtmp='"+КаталогВременныхФайлов+"'; $filename = $dirtmp.'Otvet.txt';  "+
     "if ($_POST['f'] == "+Значение1+") { $fp=fopen($dirtmp.'Param.txt','w');  $rez=fwrite($fp,'"+ТекстЗапроса+"');  fclose($fp);  "+
     "while (!file_exists($filename)) { } echo readfile($filename); DeleteFile($filename); } ";
КонецФункции  
//---------------------  Функции Ajax-OneScript (конец) ------------------------------------------------------------------


//---------------------  Функции Ajax ------------------------------------------------------------------
//?Вызов: СтрокаAjaxJS_ФункцияCreateRequest()
//?Параметры: отсутствуют
//?Описание: Определяет JS-функцию для Ajax-соединения Request. 
//?Поиск: JS Строка Клиент Ajax
Функция СтрокаAjaxJS_ФункцияCreateRequest() экспорт
  Возврат " function CreateRequest() { if (window.XMLHttpRequest) { request = new XMLHttpRequest(); } else "+
      "if (window.ActiveXObject) {  try { request = new ActiveXObject(""Microsoft.XMLHTTP""); } catch (CatchException) "+
      "{ request = new ActiveXObject(""Msxml2.XMLHTTP""); } } if (!Request) { alert(""Не могу создать XMLHttpRequest !!!""); } return request; } ";
КонецФункции

Функция Запись_AjaxJS_ФункцияSendRequest() экспорт
   Запись.ЗаписатьСтроку("<script type=""text/javascript""> "+"function SendRequest(r_method,r_path,r_args) { var Request = CreateRequest(); "+
      "if (!Request) { return; } Request.onreadystatechange = function() { if (Request.readyState == 1) { CallreadyState1(); }  else  "+
	  "if (Request.readyState == 2) { CallreadyState2(); }  else if (Request.readyState == 3) { CallreadyState3(); }  else "+
	  "if (Request.readyState == 4) { CallBackRequest(Request); }  else if (request.status==404) { CallError404(); } else { CallreadyState5(request); } }");
	Запись.ЗаписатьСтроку("if (r_method.toLowerCase() == ""get"" && r_args.length > 0) r_path += ""?""+r_args;  Request.open(r_method,r_path,true); "+
	  "if (r_method.toLowerCase() == ""post"") { Request.setRequestHeader(""Content-type"",""application/x-www-form-urlencoded; charset=utf-8""); "+
	  "Request.send(r_args); } else { Request.send(null); } } "+" </script>");
КонецФункции  // отладка  alert(r_args);

Функция Запись_ФункцийRequestReadyState(Error404,State1,State2,State3,State5) экспорт
   Запись.ЗаписатьСтроку("<script type=""text/javascript""> "+
   "function CallreadyState1() { "+State1+" } function CallreadyState2() { "+State2+" } function CallreadyState3() { "+State3+" } "+
   "function CallError404() { "+Error404+" } function CallreadyState5(request) { "+State5+" } "
   " </script>");
КонецФункции

//?Вызов: СтрокаAjaxJS_ФункцияReadFileServer()
//?Параметры: JS(r_file - имя читаемого файла на сервере)
//?Описание: Определяет JS-функцию для чтения содержимого текстового файла на сервере через GET-запрос. 
//?Поиск: JS Строка Клиент Ajax GET-запрос
Функция СтрокаAjaxJS_ФункцияReadFileServer() экспорт
  Возврат " function ReadFileServer(r_file) { SendRequest(""GET"",r_file,""""); } ";
КонецФункции

Функция СтрокаAjaxJS_ФункцияSubCallBackRequest() экспорт // устаревшее
  Возврат " function SubCallBackRequest(responseText) { ar=responseText.split('==>'); document.getElementById(ar[0]).innerHTML += ar[1]; } ";
КонецФункции

Функция СтрокаAjaxJS_ФункцияSubCallBackRequest01() экспорт  // устаревшее
  Возврат " function SubCallBackRequest01(responseText) { ar=responseText.split('==>'); "+
    "if (ar.length<3) { SubCallBackRequest(responseText); } else { "+
    "if (ar[1]=='Insert') {document.getElementById(ar[0]).innerHTML += ar[2]; }  "+
    "if (ar[1]=='New')    {document.getElementById(ar[0]).innerHTML = ar[2]; }  "+
    "if (ar[1]=='Delete') {document.getElementById(ar[0]).innerHTML = ''; }  "+
    "if (ar[1]=='InsertCookie') { InsertCookieNa1God(ar[0],ar[2]); }  "+   // Записать Кук на год с именем ar[0] и содержимым ar[2]
    "if (ar[1]=='PrintCookie')  { if(get_cookie(ar[2])){document.getElementById(ar[0]).innerHTML=get_cookie(ar[2]);}}}} ";   // Вывести Кук ar[2] в Div с id=ar[0] 
КонецФункции

//?Вызов: СтрокаAjaxJS_ФункцияSubCallBackRequest02()
//?Параметры: JS(responseText - текст возвращаемый от сервера)  
//?Описание: Определяет JS-функцию для обработки ответа от сервера. Данный обработчик обрабатывает команды: Insert, New,
//?Далее:       Delete, PrintCookie, InsertCookie, SendRequest, ReadFileFromServe    
//?Поиск: JS Строка Клиент Ajax
Функция СтрокаAjaxJS_ФункцияSubCallBackRequest02() экспорт
  Возврат " var bReadFileFromServer=''; "+     
    "function SubCallBackRequest02(responseText) { responseText=VostanovOdinarnKavychek(responseText); "+
	"if (bReadFileFromServer!==''){ responseText='==>ListCommand==>'+bReadFileFromServer+'==>New==>'+responseText; }  "+
	"ar=responseText.split('==>'); bReadFileFromServer=''; "+
    "if (ar[1]!=='ListCommand') { SubCallBackRequest01(responseText); } else { for (var i = 2; i < ar.length; i=i+3) "+
	"{ switch (ar[i+1]) { "+
	"case 'Insert': document.getElementById(ar[i]).innerHTML += ar[i+2]; break; "+
	"case 'New': document.getElementById(ar[i]).innerHTML = ar[i+2]; break; "+
	"case 'Delete': document.getElementById(ar[i]).innerHTML = ''; break; "+
	"case 'PrintCookie': if(get_cookie(ar[i+2])) { document.getElementById(ar[i]).innerHTML+=get_cookie(ar[i+2]);} break; "+
	"case 'InsertCookie': InsertCookieNa1God(ar[i],ar[i+2]); break; "+
	"case 'SendRequest': SendRequest('POST',ar[i],ar[i+2]); break; "+
	"case 'ReadFileFromServer': ReadFileServer(ar[i+2]); bReadFileFromServer=ar[i]; break; "+
	" }}}} ";
КонецФункции  // alert('ReadFileFromServer');

Функция СтрокаAjaxJS_Функцияhtmlspecialchars_decode() экспорт
  Возврат " function htmlspecialchars_decode(string,quote_style){ string=string.toString(); string=string.replace('/&/g','&'); "+
      "string=string.replace('/>/g','>'); if (quote_style=='ENT_QUOTES'){string=string.replace('/“/g','»'); string=string.replace(""/'/g','\'""); } "+
	  "return string; } ";   
КонецФункции  // else if (quote_style != 'ENT_NOQUOTES'){string=string.replace('/"/g','"');}

Функция СтрокаAjaxJS_ФункцияVostanovOdinarnKavychek() экспорт
  Возврат " function VostanovOdinarnKavychek(str) { str=str.replace(/&#039/g,""'"");   return str; } ";
КонецФункции

//?Вызов: СтрокаAjaxJS_ФункцияFunSetTimeOut(fun,timeout)
//?Параметры: fun - Имя функции, которая будет вызываться через установленное время, timeout - время в миллисекундах через которое вызывается функция fun  
//?Описание: Определяет JS-функцию с периодическим вызовом через заданное время.
//?Поиск: JS Строка Клиент 
Функция СтрокаAjaxJS_ФункцияFunSetTimeOut(fun,timeout) экспорт
  Возврат " function FunSetTimeOut() { setTimeout("+fun+","+timeout+"); } ";
КонецФункции

//?Вызов: Запись_ОпределениеФункцийAjax()
//?Параметры: отсутствуют
//?Описание: Определяет JS-функции у клиента для работы с Ajax.
//?Поиск: JS Запись Клиент Ajax
Функция Запись_ОпределениеФункцийAjax() экспорт
    Запись.ЗаписатьСтроку("<script type=""text/javascript""> "+СтрокаAjaxJS_ФункцияCreateRequest()+СтрокаAjaxJS_ФункцияReadFileServer()+
	   СтрокаAjaxJS_ФункцияSubCallBackRequest()+СтрокаAjaxJS_ФункцияSubCallBackRequest01()+СтрокаAjaxJS_ФункцияSubCallBackRequest02()+
	   СтрокаAjaxJS_ФункцияVostanovOdinarnKavychek()+СтрокаAjaxJS_Функцияhtmlspecialchars_decode()+" </script>");
	Запись_AjaxJS_ФункцияSendRequest();  
КонецФункции

//?Вызов: СтрокаAjaxJS_ФункцияВыводаВКонсоль(ИмяФунк,Div1)
//?Параметры: ИмяФунк - имя создаваемой JS-функции, Div1 - Div-область куда будет выводиться текст JS(text - текст, который будет выводится)
//?Описание: Создание JS-функции вывод текста в заданный Div
//?Поиск: JS Строка Клиент Print
Функция СтрокаAjaxJS_ФункцияВыводаВКонсоль(ИмяФунк,Div1) экспорт
  Возврат " function "+ИмяФунк+"(text){document.getElementById("""+Div1+""").innerHTML += text;} ";
КонецФункции
Функция Запись_ОпределениеФункцииВыводаВКонсоль(ИмяФунк,Div1) экспорт
    Запись.ЗаписатьСтроку("<script type=""text/javascript"">"+СтрокаAjaxJS_ФункцияВыводаВКонсоль(ИмяФунк,Div1)+"</script>");
КонецФункции

Функция СтрокаAjaxJS_ФункцияCallBackRequest(ТекстКода) экспорт     // устарела
  Возврат " function CallBackRequest(Request) { "+ТекстКода+" }";
КонецФункции
Функция Запись_ОпределениеФункцииCallBackRequest(ТекстКода) экспорт    // устарела
    Запись.ЗаписатьСтроку("<script type=""text/javascript""> "+СтрокаAjaxJS_ФункцияCallBackRequest(ТекстКода)+" </script>");
КонецФункции

Функция Строка_ОбработчикAjaxPOST(М) экспорт
   Строка = "<?php $AjaxPOST=array(); "+СтрокаPHP_ФункцииСервера();
   Для сч=0 По М.Количество()-1 Цикл
      СубСтрока = М[сч]; СубМ=СтрРазделить(СубСтрока,"==>");
	  Если СубМ.Количество()>3 Тогда Строка1=СубМ[1]; Для сч1=2 По СубМ.Количество()-1 Цикл Строка1=Строка1+"==>"+СубМ[сч1]; КонецЦикла;  
	     Строка=Строка+" "+СтрокаPHP_СерверВернутьОтвет(СубМ[0],Строка1);	  
	  ИначеЕсли СубМ.Количество()<4 Тогда Строка=Строка+СтрокаPHP_СерверВернутьОтвет(СубМ[0],СубМ[1]+"==>"+СубМ[2]); КонецЕсли;	  
   КонецЦикла;
   Строка = Строка+" ?>";   Возврат Строка;
КонецФункции

//?Вызов: СтрокаJS_ФункцияSet_cookie()
//?Параметры: порядок следование параметров JS-функции (пояснения в описании): name, value, exp_y, exp_m, exp_d, path, domain, secure
//?Описание: Установка кука. (Входит в состав СтрокаJS_ФункцииCookie()) Примеры: установка куки без срока хранения:  
//?Далее:      set_cookie("username", "Вася Пупкин"); Установка куки со сроком хранения до 15 февраля 2011:  
//?Далее:      set_cookie ( "username", "Вася Пупкин", 2011, 01, 15 );  Установка куки со сроком хранения, доменом ruseller.com, 
//?Далее:      использованием SSL, но без пути: set_cookie ( "username", "Вася Пупкин", 2003, 01, 15, "","ruseller.com", "secure" );
//?Поиск: JS Удалить Клиент cookie
Функция СтрокаJS_ФункцияSet_cookie() экспорт  // см. http://ruseller.com/lessons.php?id=593&rub=28  -  Работа с куки ===========================
   Возврат " function set_cookie (name, value, exp_y, exp_m, exp_d, path, domain, secure ) { var cookie_string = name + ""="" + escape ( value ); "+
      "if ( exp_y ) { var expires = new Date ( exp_y, exp_m, exp_d ); cookie_string += ""; expires="" + expires.toGMTString(); } "+
      "if ( path ) cookie_string += ""; path="" + escape ( path ); if ( domain ) cookie_string += ""; domain="" + escape ( domain ); "+
      "if ( secure ) cookie_string += ""; secure"";  document.cookie = cookie_string; } ";
КонецФункции

//?Вызов: СтрокаJS_ФункцияDelete_cookie()
//?Параметры: Параметры только у JS-функции JS(cookie_name - имя удаляемого кука)
//?Описание: Удаление кука. Входит в состав СтрокаJS_ФункцииCookie()
//?Поиск: JS Удалить Клиент cookie
Функция СтрокаJS_ФункцияDelete_cookie() экспорт  
    Возврат " function delete_cookie(cookie_name){var cookie_date=new Date();cookie_date.setTime(cookie_date.getTime()-1);"+
       "document.cookie=cookie_name += ""=; expires=""+cookie_date.toGMTString();} ";
КонецФункции

//?Вызов: СтрокаJS_ФункцияGet_cookie()
//?Параметры: Параметры только у JS-функции JS(cookie_name - имя читаемого кука)
//?Описание: Чтение содержимого кука. Входит в состав СтрокаJS_ФункцииCookie()
//?Поиск: JS Чтение Клиент cookie
Функция СтрокаJS_ФункцияGet_cookie() экспорт  
    Возврат " function get_cookie(cookie_name){results=document.cookie.match( '(^|;) ?' + cookie_name + '=([^;]*)(;|$)' ); "+
       "if(results) return (unescape(results[2]));else return null;} ";
КонецФункции

//?Вызов: СтрокаJS_ФункцииCookie()
//?Параметры: отсутствуют
//?Описание: Определяет JS-функции у клиента для работы с куками.
//?Поиск: JS Запись Клиент Input cookie
Функция СтрокаJS_ФункцииCookie() экспорт 
    Возврат СтрокаJS_ФункцияSet_cookie()+СтрокаJS_ФункцияDelete_cookie()+СтрокаJS_ФункцияGet_cookie()+
	    СтрокаJS_ФункцияМодальногоВводаСтроки("ModalEnterUserName","Введите ваше имя:")+
		СтрокаJS_ФункцияМодальногоВводаСтроки("ModalEnterMessage","Введите сообщение:")+
		 СтрокаJS_ФункцияДобавитьКукСХранен1год();
КонецФункции
Функция Запись_ОпределениеФункцийCookie() экспорт 
    Запись.ЗаписатьСтроку("<script type=""text/javascript"">"+СтрокаJS_ФункцииCookie()+"</script>");
КонецФункции
	   
//?Вызов: Запись_ОпределениеФункцийРегистрация (Divобласть,Приветствие,Изменить)
//?Параметры: Divобласть- div-Область, в которой высвечивается приветствие, Приветствие - текст приветствия, 
//?Описание: Определяет JS-код у клиента для узнавания и регистрации имени клиента.
//?Поиск: JS Запись Клиент Input cookie
Функция Запись_ОпределениеФункцийРегистрация(Divобласть,Приветствие,Изменить) экспорт 
  Запись_ОпределениеФункцииВыводаВКонсоль("print_username",Divобласть);
  Запись.ЗаписатьСтроку("<script type=""text/javascript""> "+  
   " if(!get_cookie(""username"")){var username=ModalEnterUserName();InsertCookieNa1God(""username"",username);}"+
   "else{var username=get_cookie(""username"");print_username("+Приветствие+");"+
   "print_username(""<br><a href=\""javascript:delete_cookie('username');document.location.reload();\"">"+Изменить+"</a>"");}</script>");
КонецФункции  

//?Вызов: СтрокаJS_ФункцияМодальногоВводаСтроки(НаимФунк,Текст)
//?Параметры: НаимФунк-наименование создаваемой JS-функции, Текст - строка комментария 
//?Описание: Определяет JS-функцию у клиента для ввода строки от пользователя.
//?Поиск: JS Строка Клиент Input
Функция СтрокаJS_ФункцияМодальногоВводаСтроки(НаимФунк,Текст) экспорт 
   Возврат " function "+НаимФунк+"(){return prompt("""+Текст+""","""");} "; 
КонецФункции   // ------------------------------------------------------------------

//?Вызов: СтрокаJS_ФункцияДобавитьКукСХранен1год()
//?Параметры: параметры только e JS-функции JS(namcook-наименование кука,datacook-записываемые данные в кук) 
//?Описание: Определяет JS-функцию у клиента для записи кука с длительностью хранения 1год. Возвращает строку с кодом JS-функции.
//?Поиск: JS Строка Клиент Cookie
Функция СтрокаJS_ФункцияДобавитьКукСХранен1год() экспорт 
   Возврат " function InsertCookieNa1God(namcook,datacook){if(datacook){var current_date=new Date;var cookie_year=current_date.getFullYear()+1;"+
     "var cookie_month=current_date.getMonth();var cookie_day=current_date.getDate();set_cookie(namcook,datacook,"+
	 "cookie_year,cookie_month,cookie_day);}} "; 
КонецФункции   // ------------------------------------------------------------------

//?Вызов: AjaxJS_ИнициализироватьAjaxGET(ОбработкаОтвета,Знач МассивИнфо=0)
//?Параметры: ОбработкаОтвета(с)-Текст JS-функции обрабатывающей ответ от сервера, МассивИнфо(м,c)-список JS-функций для 
//?Далее:       обработки этапов готовности ответа и ошибок сервера.
//?Описание: Определяет функции у клиента для формирования GET-запросов к серверу
//?Поиск: JS Запись Клиент GET-запрос
Функция AjaxJS_ИнициализироватьAjaxGET(ОбработкаОтвета,Знач МассивИнфо=0) экспорт
  Если МассивИнфо=0 Тогда    Error404="";  State1="";  State2="";  State3=""; НетОбработки="";  
  ИначеЕсли МассивИнфо.Количество()>0 Тогда Error404=МассивИнфо[0]; 
     Если МассивИнфо.Количество()>1 Тогда  State1=МассивИнфо[1]; КонецЕсли;
     Если МассивИнфо.Количество()>2 Тогда  State2=МассивИнфо[2]; КонецЕсли;
     Если МассивИнфо.Количество()>3 Тогда  State3=МассивИнфо[3]; КонецЕсли;
     Если МассивИнфо.Количество()>4 Тогда  НетОбработки=МассивИнфо[4]; КонецЕсли;
  КонецЕсли;
  Строка = "<script type=""text/javascript""> function AjaxGET(Zapros){ "+СтрокаAjaxJS_СоздатьRequest()+
    СтрокаAjaxJS_ОтветОтСервера(State1,State2,State3,ОбработкаОтвета,Error404)+СтрокаAjaxJS_GETЗапрос("""Zapros""")+" } </script>";
  Запись.ЗаписатьСтроку(Строка);
КонецФункции   //------------------------------------------------------------------------

//?Вызов: СтрокаJS_ФункцияjspsGetProgramInfo()
//?Параметры: отсутствуют
//?Описание: Строка для записи JS-функции jspsGetProgramInfo() выдающей сведения о программе Web-обозревателя "JS народные советы" стр.112
//?Поиск: JS Строка Клиент 
Функция СтрокаJS_ФункцияjspsGetProgramInfo() экспорт  //стр.112
  Строка = "var JSPS_GPI_MSIE=""Microsoft Internet Explorer""; var JSPS_GPI_OPERA=""Opera""; var JSPS_GPI_MOZILLA=""Mozilla""; "+
  "var JSPS_GPI_FIREFOX=""Firefox""; var JSPS_GPI_NAVIGATOR=""Navigator""; function ProgramInfo(){this.programName=""""; "+
  "this.programVersion=""""; this.OperaCompatibilityMode=""""; this.programPlatform=""""; this.programLanguage=""""; "+
  "this.systemLanguage=""""; } function jspsGetProgramInfo(){var piObj=new ProgramInfo(); var ua=navigator.userAgent;"+
  "var an=navigator.appName; var isntOpera=(ua.indexOf(JSPS_GPI_OPERA)==-1); var n1,n2; switch (an) {"+
  "case JSPS_GPI_MSIE: piObj.programLanguage=navigator.browserLanguage; if (isntOpera){piObj.programName=an; n1=ua.IndexOf(""MSIE"")+5; "+
  "n2=ua.IndexOf("";"",n1); piObj.programVersion=ua.substring(n1,n2); n1=n2+2; n2=ua.indexOf("";"",n1); piObj.programPlatform="+
  "ua.substring(n1,n2); piObj.systemLanguage=navigator.systemLanguage; } else { piObj.programName=JSPS_GPI_OPERA; n1=ua.lastIndexOf("" "")+1; "+
  "n2=ua.length; piObj.programVersion=ua.substring(n1,n2); piObj.OperaCompatibilityMode=""MSIE 6.0""; n1=ua.indexOf(""MSIE"")+10; "+
  "n2=ua.indexOf("";"",n1); piObj.programPlatform=ua.substring(n1,n2);} break; "+
  "case ""Netscape"": if (isntOpera) {n1=ua.indexOf("";"")+1; n1=ua.indexOf("";"",n1)+2; n2=ua.indexOf("";"",n1); "+
  "piObj.programPlatform=ua.substring(n1,n2);if (ua.indexOf(JSPS_GPI_FIREFOX)!=-1) {piObj.programName=JSPS_GPI_FOREFOX; "+
  "n1=ua.lastIndexOf(""/"")+1; n2=ua.length; piObj.programVersion=ua.substring(n1,n2); piObj.programLanguage=navigator.language; "+
  "} else {piObj.programLanguage=navigator.language.substring(0,2); if (ua.indexOf(""Netscape"")!=-1){piObj.programName="+
  "JSPS_GPI_NAVIGATOR; n1=ua.lastIndexOf(""/"")+1; n2=ua.length; piObj.programVersion=ua.substring(n1,n2); } else {piObj.programName="+
  "JSPS_GPI_MOZILLA; n1=ua.indexOf(""rv:"")+3; n2=ua.indexOf("")""); piObj.programVersion=ua.substring(n1,n2); }}} else {piObj.programName="+
  "JSPS_GPI_OPERA; n1=ua.lastIndexOf("" "")+1; n2=ua.length; piObj.programVersion=ua.substring(n1,n2); piObj.OperaCompatibilityMode="+
  " ""Mozila 5.0""; n1=ua.indexOf(""("")+1; n2=ua.indexOf("";"",n1); piObj.programPlatform=ua.substring(n1,n2); piObj=programLanguage="+
  "navigator.browserLanguage; } break; case JSPS_GPI_OPERA: piObj.programName=an; n1=ua.indexOf(""/"")+1; n2=ua.indexOf("" "",n1); "+
  "piObj.programVersion=ua.substring(n1,n2); piObj.OperaCompatibilityMode=an; n1=n2+2; n2=ua.IndexOf("";"",n1); "+
  "piObj.programPlatform=ua.substring(n1,n2); piObj.programLanguage=navigator.browserLanguage; break; } return piObj; }";
  Возврат Строка; 
КонецФункции   //------------------------------------------------------------------------

//?Вызов: СтрокаAjaxJS_СоздатьRequest()
//?Параметры: отсутствуют
//?Описание: Создает и инициализирует переменную request1 для Ajax
//?Поиск: JS Строка Клиент Ajax
Функция СтрокаAjaxJS_СоздатьRequest() экспорт
  Возврат " var request1; if (window.XMLHttpRequest) { request1 = new XMLHttpRequest(); } else "+
      "if (window.ActiveXObject) {  request1 = new ActiveXObject(""Microsoft.XMLHTTP""); } else { return; } ";
КонецФункции  // ------------------------------------------------------------------

Функция СтрокаAjaxJS_ОтветОтСервера(State1,State2,State3,State4,Error404) экспорт
  Возврат " request1.onreadystatechange = function() { switch (request1.readyState) { case 1: "+State1+" break; case 2: "+State2+" break; "+
     "case 3: "+State3+" break; case 4: {if (request1.status==200) { "+State4+"; } else if (request1.status==404) { "+Error404+"; } "+
     " else alert(""Ошибка: сервер вернул статус: ""+ request1.status); break;  }}};";
КонецФункции   

Функция СтрокаAjaxJS_POSTЗапрос(url,Данные) экспорт
   Возврат " request1.open(""POST"",""Content.php"",true);  "+
     "request1.setRequestHeader(""Content-type"",""application/x-www-form-urlencoded""); request1.send(""param1=1&param2=2"");";
   
   
    //request.open(""POST"",""+url+"",true); request.setRequestHeader(""Content-type"",""application/x-www-form-urlencoded""); "+
    //  " request.send(""+Данные+"");";    (""POST"",url,true)  request1.send(""param1=1&param2=2"");
КонецФункции

Функция СтрокаAjaxJS_GETЗапрос(url) экспорт
   Возврат " request1.open(""GET"",""Content.php?a1=1&a2=2"",true); "+
     "request1.setRequestHeader(""Content-type"",""application/x-www-form-urlencoded""); request1.send("" "");";
КонецФункции


//---------------------  Функции Ajax (конец) ------------------------------------------------------------------

//---------------------  Функции JavaScript ------------------------------------------------------------------
//?Вызов: Запись_JSКод(Код)
//?Параметры: Код - записываемый JS-Код
//?Описание: Записывает в файл указанный JS-Код 
//?Поиск: JS Запись Клиент 
Функция Запись_JSКод(Код) экспорт
  Запись.ЗаписатьСтроку("<script type=""text/javascript"">"+Код+"</script>");
КонецФункции  //------------------------------------------------------------------------

//?Вызов: Строка_JSКод(Код)
//?Параметры: Код - записываемый JS-Код
//?Описание: Обертка для JS-Кода.  
//?Поиск: JS Запись Клиент 
Функция Строка_JSКод(Код) экспорт
   Возврат "<script type=""text/javascript"">"+Код+"</script>";
КонецФункции  //------------------------------------------------------------------------

//?Вызов: Строка_CSSКод(Код)
//?Параметры: Код - записываемый CSS-Код
//?Описание: Обертка для CSS-Кода.  
//?Поиск: CSS Строка Клиент 
Функция Строка_CSSКод(Код) экспорт
   Возврат "<style type=""text/css"">"+Код+"</style>";
КонецФункции  //------------------------------------------------------------------------

//?Вызов: Запись_ЗапускатьФункцJSПриОбновлении(Функ)
//?Параметры: Функ - Имя JS-функции, которая будет запускаться после загрузки страницы в браузере
//?Описание: Устанавливает функцию для разового запуска после загрузки страницы клиента
//?Поиск: JS Запись Клиент 
Функция Запись_ЗапускатьФункцJSПриОбновлении(Функ) экспорт
  Запись.ЗаписатьСтроку("<script type=""text/javascript"">window.onload="+Функ+";</script>");
КонецФункции  //------------------------------------------------------------------------


//-------------------- Функции JavaScript Динамичная таблица DynTable -----------------------------------------------
Функция ОбразОбъектJSТаблица(М)      
   М=ОбразОбъектHTMLБазовый(М);   
   М.Добавить("Перем ФайлСервера экспорт; Перем Метод экспорт;");
   М.Добавить("Функция Конструктор() экспорт Метод=""post""; ФайлСервера=""Server.php""; КонецФункции ");

   Возврат М;
КонецФункции

Функция СоздатьОбъектJSТаблица() экспорт      
  Об=СоздатьООПОбъектИзМассива("",ОбразОбъектJSТаблица(Новый Массив)); Возврат Об;
КонецФункции

Функция Строка_ФункцииconstructorTable(Заголовок) экспорт
  Строка=Строка_JSКод("function constructorTable(pRowNumber,pColNumber,pSectionCode){switch(pSectionCode){"+
  "case JSPS_DT_TS_CAPTION: return '"+Заголовок+"'; break; case JSPS_DT_TS_HEAD: return tableHead[0][pColNumber]; break; "+
  "case JSPS_DT_TS_FOOT: return tableFoot[0][pColNumber];; break; case JSPS_DT_TS_BODY: return tableBody[pRowNumber][pColNumber]; break; }}");  
  Возврат Строка;
КонецФункции

Функция Строка_ФункцииDynamicTable() экспорт
  Строка="<script type=""text/javascript"">var JSPS_DT_SPANNED_HORZ=""!!!JSPS_DT_SPANNED_HORZ!!!""; var JSPS_DT_SPANNED_VERT=""!!!JSPS_DT_SPANNED_VERT!!!""; "+
  "var JSPS_DT_TS_CAPTION=0; var JSPS_DT_TS_HEAD=1; var JSPS_DT_TS_BODY=2; var JSPS_DT_TS_FOOT=3; var JSPS_DT_TS_FILTER="""";"+
  "function DynamicTable(pElement,pID,pClassName){ this.element=pElement; this.id=(pID) ? pID: ""tab""+this; this.table=null; "+
    "this.className=(pClassName) ? pClassName : """"; this.createTable=mjspsDTCreateTable; this.createTableAdvanced=mjspsCreateTableAdvanced; "+
    "this.showTable=mjspsDTShowTable; this.removeTable=mjspsDTRemoveTable; this.createTableTag=mjspsDTCreateTableTag; "+
    "this.createTableCaption=mjspsDTCreateTableCaption; this.createTableSection=mjspsDTCreateSection;} "+
  "function mjspsDTCreateTableTag(){this.table=document.createElement(""ТАВLE""); this.table.id=this.id; if (this.className) "+
    "this.table.className=this.className; } "+
  "function jspsDTGetCellValue(pRowNumber,pColNumber,pSectionCode,pAdditional){if (pSectionCode==JSPS_DT_TS_CAPTION) { return pAdditional; } "+
    "else return pAdditional[pRowNumber][pColNumber]; } "+
  "function mjspsDTCreateTableCaption(pFunction, pAdditional){var captionText=pFunction(0,0,JSPS_DT_TS_CAPTION,pAdditional); "+
    "if (captionText){var captionObject=document.createElement(""CAPTION""); var captionTextObject=document.createTextNode(captionText); "+
    "captionObject.appendChild(captionTextObject); this.table.appendChild(captionObject);}} "+
  "function mjspsDTCreateSection(pSectionCode, pFunction,pRowCount,pCellCount,pFirstElementIndex,pLastElementIndex,pAdditional)"+
    "{if (pRowCount>0){if (typeof(pFirstElementIndex)==""undefined"") pFirstElementIndex=0; if (typeof(pLastElementIndex)==""undefined"") "+
	"pLastElementIndex=pRowCount-1; switch (pSectionCode) {case JSPS_DT_TS_HEAD: var sectionTag=""THEAD""; var cellTag='TH'; break; "+
	"case JSPS_DT_TS_BODY: var sectionTag=""TBODY""; var cellTag='TD'; break; case JSPS_DT_TS_FOOT: var sectionTag=""TFOOT""; var cellTag='TD'; break; } "+
	"var sectionObject = document.createElement(sectionTag); var rowObject=null; var cellObject=null; var cellContentObject=null; var leftCall=null; "+
	"var horzSpannedCellCount=1; var topCells=new Array(); var vertSpannedCellCounts=new Array(); for (var i=pFirstElementIndex; i<=pLastElementIndex; i++)"+
	"{rowObject=document.createElement(""TR""); for (var j=0; j<pCellCount; j++) { cellObject=document.createElement(cellTag); "+
	"var cellContent=pFunction(i,j,pSectionCode,pAdditional); if (cellContent==JSPS_DT_SPANNED_HORZ) "+
	"{horzSpannedCellCount++; leftCell.colSpan=horzSpannedCellCount;} else if (cellContent==JSPS_DT_SPANNED_VERT){vertSpannedCellCounts[j]++; "+
	"topCells[j].rowSpan=vertSpannedCellCounts[j];} else {switch (typeof(cellContent)) {case ""object"": cellContentObject=cellContent; break; "+
	"case ""string"": if (cellContent=="""") cellContent="" ""; cellContentObject=document.createTextNode(cellContent); break; "+
	"case ""number"": cellContentObject=document.CreateTextNode(cellContent.toString()); break; default: cellContentObject=document.createTextNode("" ""); "+
	"break; } leftCell=cellObject; horzSpannedCellCount=1; topCells[j]=cellObject; vertSpannedCellCounts[j]=1; cellObject.appendChild(cellContentObject); "+
	"rowObject.appendChild(cellObject);}} sectionObject.appendChild(rowObject);} this.table.appendChild(sectionObject); } } "+
  "function mjspsDTCreateTable(pBodyArray, pHeadArray, pFootArray, pCaption, pFirstElementIndex,pLastElementIndex) { this.removeTable(); "+
    "this.createTableTag(); if (pCaption) this.createTableCaption(jspsDTGetCellValue,pCaption); if (pHeadArray) "+
    "this.createTableSection(JSPS_DT_TS_HEAD,jspsDTGetCellValue,pHeadArray.length,pHeadArray[0].length,0,pHeadArray.langth-1,pHeadArray); "+
    "this.createTableSection(JSPS_DT_TS_BODY,jspsDTGetCellValue,pBodyArray.length,pBodyArray[0].length,pFirstElementIndex,pLastElementIndex,pBodyArray); "+
    "if (pFootArray) this.createTableSection(JSPS_DT_TS_FOOT,jspsDTGetCellValue,pFootArray.length,pFootArray[0].length,0,pFootArray.length-1,pFootArray); }"+
  "function mjspsCreateTableAdvanced(pFunction,pBodyRowCount,pCellCount,pHeadRowCount,pFootRowCount,pFirstElementIndex,pLastElementIndex,pAdditional) "+
     "{this.removeTable(); this.createTableTag(); this.createTableCaption(pFunction); "+
	 "if (pHeadRowCount>0) this.createTableSection(JSPS_DT_TS_HEAD,pFunction,pHeadRowCount,pCellCount);"+
	 "if (pBodyRowCount>0) this.createTableSection(JSPS_DT_TS_BODY,pFunction,pBodyRowCount,pCellCount,pFirstElementIndex,pLastElementIndex); "+
	 "if (pFootRowCount>0) this.createTableSection(JSPS_DT_TS_FOOT,pFunction,pFootRowCount,pCellCount); } "+
  "function mjspsDTShowTable() { if (this.table) this.element.appendChild(this.table); } "+
  "function mjspsDTRemoveTable() { if (this.table) {this.element.removeChild(this.table); this.table=null; }} "+
  "function putTable(pFirstRowNumber,StepRow) {if (pFirstRowNumber<0) pFirstRowNumber=0; if (pFirstRowNumber>tableBody.length-1) pFirstRowNumber=tableBody.length-1; "+
      "topRowNumber=pFirstRowNumber; var lastRowNumber=pFirstRowNumber+StepRow-1; if (lastRowNumber>tableBody.length-1) "+
	  "lastRowNumber=tableBody.length-1; tableObject.createTableAdvanced(constructorTable,tableBody.length,tableHead[0].length,1,1,pFirstRowNumber,lastRowNumber); "+
	  "tableObject.showTable();  } "+
  "function jspsFilterTable(pTable,pFilterFunction,pAdditional){var piObject=jspsGetProgramInfo(); "+
      "var isIE=(piObject.ProgramName==JSPS_GPI_MSIE);var bodySectionObject=pTable.getElementsByTagName(""TBODY"");bodySectionObject=bodySectionObject[0]; "+
      "maxrow=bodySectionObject.childNodes.length; for (var i=0;i<maxrow; i++){var rowObject=bodySectionObject.childNodes[i];"+
	  "rowObject.style.display=(pFilterFunction(rowObject,pAdditional))?((isIE)?""block"":""table-row""):""none"";}} "+
  "function jspsClearFilterTable(pTable){var piObject=jspsGetProgramInfo();var isIE=(piObject.programName==JSPS_GPI_MSIE); "+
      "var bodySectionObject=bodySectionObject[0];for(var i=0;i<bodySectionObject.childNodes.length;i++) bodySectionObject.childNodes[i].style.display="+
      "(isIE)?""block"":""table-row"";}"+
  "function jspsFilterNewTable(pTable,pFilterFunction,pAdditional){var i2=0; tableBody.splice(0,tableBody.length);maxrow=tableCopy.length;"+
      "for(var i=0;i<maxrow; i++){if(pFilterFunction(tableCopy[i],pAdditional)){table1=new Array();for(var i1=0;i1<tableCopy[i].length;i1++)"+
	  "{table1[i1]=tableCopy[i][i1];}tableBody[i2]=table1;i2++;}}putTable(0,JSPS_PAGE_SIZE);} "+ 
  "function jspsNewRowArray(pRow){var pNewRow=new Array();for(var i=0;i<pRow.length;i++){pNewRow[i]=pRow[i];}return pNewRow} "+ 
  "function filterTable(pRowObject,pAdditional){retfind=false;var arr=pAdditional.split('==>');pAdditional=arr[0];"+
      "if(arr.length>1){i=arr[1]-1; if(i>pRowObject.childNodes.length-1){alert('Нет такого номера колонки');return true;} "+
	  "reg=pRowObject.childNodes[i].firstChild.nodeValue; if(reg.indexOf(pAdditional)+1>0){retfind=true;}return retfind;}"+
      "for(var i=0;i<pRowObject.childNodes.length;i++){reg=pRowObject.childNodes[i].firstChild.nodeValue; if(reg.indexOf(pAdditional)>=0){retfind=true;}} "+
	  "return retfind;}"+ 
  "function filterNewTable(pRowObject,pAdditional){retfind=false;var arr=pAdditional.split('==>');pAdditional=arr[0];"+
      "if(arr.length>1){i=arr[1]-1; if(i>pRowObject.length-1){alert('Нет такого номера колонки');return true;} "+
	  "reg=pRowObject[i]; if(reg.indexOf(pAdditional)+1>0){retfind=true;}return retfind;}"+
      "for(var i=0;i<pRowObject.length;i++){reg=pRowObject[i];  if(reg.indexOf(pAdditional)>=0){retfind=true;}} "+
	  "return retfind;}"+ 
   СтрокаJS_ФункцияjspsGetProgramInfo()+СтрокаJS_ФункцияМодальногоВводаСтроки("ModalSetKolStr","Ведите количество записей на одной странице")+
   СтрокаJS_ФункцияМодальногоВводаСтроки("ModalSetFilter","Ведите строку поиска")+
      "</script>";  Возврат Строка;
КонецФункции   // reg.test(pRowObject.childNodes[i].firstChild.nodeValue)   pRowObject.childNodes[i].firstChild.nodeValue==pAdditional

Функция ФормируемКолонки(М)
  Строка="'"+М[0]+"'";  Для сч=1 По М.Количество()-1 Цикл   Строка = Строка+",'"+М[сч]+"'";  КонецЦикла;  Возврат Строка;
КонецФункции

//?Вызов: СтрокаJS_ArrayNamTable(М2,NamTable)
//?Параметры: М2 - двухмерный массив таблицы, NamTable - имя JS-таблицы (английскими буквами)
//?Описание: Формирует JS-строку для создания двухмерной таблицы на JavaScript
//?Поиск: JS Клиент Таблица 
Функция СтрокаJS_ArrayNamTable(М2,NamTable)  экспорт
  Строка="";  Для сч=0 По М2.Количество()-1 Цикл  Строка = Строка+" "+NamTable+"["+сч+"]=new Array("+ФормируемКолонки(М2[сч])+"); ";  КонецЦикла;
  Возврат Строка;
КонецФункции

//?Вызов: СоздатьДвухмерныйМассивДляHelp(ИмяФайла)
//?Параметры: ИмяФайла - файл, из которого будет формироваться двухмерный массив 
//?Описание: Возвращает двухмерный массив, сформированный из файла по ключевым символам "//?" (используется для создание справки по функциям)
//?Поиск: OneScript Массив
Функция СоздатьДвухмерныйМассивДляHelp(ИмяФайла) экспорт
  Текст = Новый ЧтениеТекста(ИмяФайла, КодировкаТекста.UTF8);
  МассивФункций = Новый Массив;  сч=0;  K=0; N=0;
  Стр = Текст.ПрочитатьСтроку();  K=K+1;
  Пока Стр <> Неопределено  Цикл 
      Стр = СокрЛП(ЗаменаОдинарныхКавычек(Стр));
      Если СтрНачинаетсяС(Стр,"//?") Тогда 
	     Если СтрНачинаетсяС(Стр,"//?Вызов: ") Тогда СубМассив=Новый Массив; сч=0; МассивФункций.Добавить(СубМассив); N=N+1;
	             СубМассив.Добавить(N); СубМассив.Добавить(K); Стр=СокрЛП(СтрЗаменить(Стр,"//?Вызов: ",""));  СубМассив.Добавить(Стр);  сч=сч+2;  
	     ИначеЕсли СтрНачинаетсяС(Стр,"//?Далее: ")     Тогда Стр=СокрЛП(СтрЗаменить(Стр,"//?Далее: ",""));     СубМассив[сч] = СубМассив[сч]+Стр; 
	     ИначеЕсли СтрНачинаетсяС(Стр,"//?Параметры: ") Тогда Стр=СокрЛП(СтрЗаменить(Стр,"//?Параметры: ","")); СубМассив.Добавить(Стр);  сч=сч+1;  
	     ИначеЕсли СтрНачинаетсяС(Стр,"//?Описание: ")  Тогда Стр=СокрЛП(СтрЗаменить(Стр,"//?Описание: ",""));  СубМассив.Добавить(Стр);  сч=сч+1;  
	     ИначеЕсли СтрНачинаетсяС(Стр,"//?Поиск: ")     Тогда Стр=СокрЛП(СтрЗаменить(Стр,"//?Поиск: ",""));     СубМассив.Добавить(Стр);  сч=сч+1;  
	     КонецЕсли;
	  КонецЕсли;
      Стр = Текст.ПрочитатьСтроку(); K=K+1;  
  КонецЦикла;
  Текст.Закрыть();  Возврат МассивФункций;  
КонецФункции

//?Вызов: Строка_СозданиеJSТаблицы (МассивТаблицы,МассивЗаголовков)
//?Параметры: МассивТаблицы - двухмерный массив содержимого таблицы, МассивЗаголовков - двухмерный массив заголовка таблицы
//?Описание: Формирует JS-строку и CSS-строку для создания двухмерной таблицы на JavaScript
//?Поиск: JS Клиент Таблица CSS
Функция Строка_СозданиеJSТаблицы(МассивТаблицы,МассивЗаголовков)  экспорт
  Таблица="<style type=""text/css""> .mytable {border: thin solid #CCCCCC;} .mytable td {border: thin solid #CCCCCC; .found {background:#89DAD0;} } </style>"+
    "<script type=""text/javascript"">var tableBody=new Array(); "+СтрокаJS_ArrayNamTable(МассивТаблицы,"tableBody")+"var tableCopy=tableBody.concat();</script>"+
    Строка_ФункцииDynamicTable()+Строка_ФункцииconstructorTable("")+"<script type=""text/javascript"">var topRowNumber=0; var JSPS_PAGE_SIZE=7000; "+
    "var tableHead=new Array(); "+СтрокаJS_ArrayNamTable(МассивЗаголовков,"tableHead")+
    "var tableFoot=new Array(); tableFoot[0]=new Array(""Итого"","" ""); var tableObject=new DynamicTable(document.body,""Tabl"",""mytable""); "+
    " putTable(0,JSPS_PAGE_SIZE);</script>";
  Возврат Таблица;
КонецФункции

// Функции для поиска в таблице (не отлажены)
//  "function jspsSearchCell(pTable,pSubstring,pClassName,pColumnNumber) {var columnNumber=(pColumnNumber) ? pColumnNumber.join("" "") : """"; "+
//  "pSubstring=pSubstring.toLowerCase(); var resultCells=new Array();  var bodySectionObject=pTable.getElementsByTagName(""TBODY""); "+
//  "bodySectionObject=bodySectionObject[0]; for (var i=0; i<bodySectionObject.childNodes.length; i++) {var rowObject=bodySectionObject.childNodes[i]; "+
//  "for (var j=0; j<rowObject.childNodes.length; j++) if ((columnNumber=="""") || (columnNumber.IndexOf(j.toString())!=-1)){var cellObject="+
//  "rowObject.childNodes[j]; cellObject.className=""""; var cellText=cellObject.firstChild.nodeValue; if (cellText){ cellText=cellText.toLowerCase(); "+
//  "if (cellText.indexOf(pSubstring)!=-1){cellObject.className=pClassName; resultCells[resultCells.length]=cellObject;}}}} return resultCells;}"+
  
//  "function jspsClearSearchCell(pTable){var bodySectionObject=pTable.getElementsByTagName(""TBODY""); bodySectionObject=bodySectionObject[0]; "+
//  "for (var i=0; i<bodySectionObject.childNodes.length; i++) {var rowObject=bodySectionObject.childNodes[i]; for (var j=0; j<rowObject.childNodes.length; j++)"+
//  "{rowObject.childNodes[j].className="""";}} } "+

//  "function searchCell(){var txtSearchObject=document.all[""txtSearch""]; var txtSubstring=txtSearchObject.value;  "+
//  "if (txtSubstring) var foundCells=jspsSearchCell(tableObject.table,txtSubstring,""found""); "+
//  " }</script>"+
//  "<FORM><INPUT TYPE=""text"" ID=""txtSearch""><INPUT TYPE=""button"" VALUE=""Найти"" ONCLICK=""searchCell();""><INPUT TYPE=""BUTTON"" "+
//  "VALUE=""Убрать выделение"" ONCLICK=""jspsClearSearchCell(tableObject.table);""></FORM>"; 

Функция Запись_ФункцииDynamicTableДемо() экспорт
  Запись.ЗаписатьСтроку("<HTML><HEAD><TITLE>Языки программирования</TITLE><script type=""text/javascript""> "+
  "</script>");
КонецФункции

Функция НастройкаКнопокНавигации(Об)
  Об.ОтступСверхуСнизу=3;  Об.ОтступОтТекстаСверху=3; Об.ОтступОтТекстаПоКраям=3; Об.ОтступПоКраям=3; Об.ЦветФона="#6CE11E";  Возврат Об;
КонецФункции

Функция ГенераторHTMLДокументации(ИмяФайла,ИмяСоздаваемогоФайла,Заголовок) экспорт
  МассивФункций =СоздатьДвухмерныйМассивДляHelp(ИмяФайла); 
  МассивЗаголовков = Новый Массив;  СубМассив=Новый Массив; СубМассив.Добавить("Номер");
  СубМассив.Добавить("Строка"); СубМассив.Добавить("Вызов"); СубМассив.Добавить("Параметры"); СубМассив.Добавить("Описание"); СубМассив.Добавить("Слова"); 
  МассивЗаголовков.Добавить(СубМассив);
  КнопкаЗаголовок   = СоздатьОбъектHTMLКнопка("Zag");  НастройкаКнопокНавигации(КнопкаЗаголовок);  
  КнопкаЗаголовок.ПравыйЦветГрадиента="#8DEBE1";  КнопкаЗаголовок.ЛевыйЦветГрадиента="#F0FAD3";  КнопкаЗаголовок.ЦентрЦветГрадиента="#FCCFFE";
  Заголовок1  = КнопкаЗаголовок.СтрокаДляAjax(Заголовок,1,"","");
  КнопкиНавигации   = СоздатьОбъектHTMLКнопка("Nav");  НастройкаКнопокНавигации(КнопкиНавигации);
  КнНачало = КнопкиНавигации.СтрокаДляAjax("<< В начало",5,"","putTable(0,JSPS_PAGE_SIZE);");  // Строка для Ajax может использоваться и без Ajax
  КнНазад  = КнопкиНавигации.СтрокаAjaxHTML("< Назад",5,"","putTable(topRowNumber-JSPS_PAGE_SIZE,JSPS_PAGE_SIZE);");
  КнВперед = КнопкиНавигации.СтрокаAjaxHTML("Вперед >",5,"","putTable(topRowNumber+JSPS_PAGE_SIZE,JSPS_PAGE_SIZE);");  
  КнВКонец = КнопкиНавигации.СтрокаAjaxHTML("В конец >>",5,"","putTable(tableBody.length-JSPS_PAGE_SIZE,JSPS_PAGE_SIZE);");  
  КнопкиНастроек   = СоздатьОбъектHTMLКнопка("Op");  НастройкаКнопокНавигации(КнопкиНастроек); КнопкиНастроек.ЦветФона="#50C0D8";
  КолЗаписей="document.getElementById('KolZap').innerHTML=JSPS_PAGE_SIZE;"; 
  КнНаСтранице = КнопкиНастроек.СтрокаДляAjax("Количество записей на странице<div id=KolZap></div>",5,"",
            "k=ModalSetKolStr(); JSPS_PAGE_SIZE=parseInt(k);  putTable(0,JSPS_PAGE_SIZE);"+КолЗаписей);
  КнопкиФильтра=СоздатьОбъектHTMLКнопка("Filt");  НастройкаКнопокНавигации(КнопкиФильтра); КнопкиФильтра.ЦветФона="#83DCF5";
  КнФильтр=КнопкиФильтра.СтрокаДляAjax("Фильтровать",5,"","JSPS_DT_TS_FILTER=ModalSetFilter(); jspsFilterNewTable(tableObject.table,filterNewTable,JSPS_DT_TS_FILTER);");
  DivHeader=СоздатьОбъектCSSDiv("Header",Заголовок1);                 
    Divheader.ТипВысота=1;  Divheader.Высота=40; Divheader.ЦветФона="#eefdfd"; Divheader.ТипШирина=2; Divheader.Ширина=100;
  DivNav=СоздатьОбъектCSSDiv("Nav",КнНачало+КнНазад+КнВперед+КнВКонец+КнНаСтранице+КнФильтр);
  DivTabl=СоздатьОбъектCSSDiv("Tabl");  DivTabl.ЦветФона="#FCCDFA";
  DivBaza=СоздатьОбъектCSSDiv("Baza",Divheader.СтрокаHTML()+DivNav.СтрокаHTML()+Строка_СозданиеJSТаблицы(МассивФункций,МассивЗаголовков)+
      Строка_JSКод(КолЗаписей));      
  DivBaza.ТипШирина=2; DivBaza.Ширина=100; 
  Шаблон=СоздатьОбъектHTMLШаблонCSSDiv();         Шаблон.ИмяФайла=ИмяСоздаваемогоФайла;
  Шаблон.Div(DivBaza).Div(DivHeader).Div(DivNav).Div(DivTabl);
  Шаблон.Инициализация();
  ПРОЦЕСС_Окончание();
КонецФункции

//---------------------  Функции JavaScript (конец) ------------------------------------------------------------------

//---------------------  Функции для OneScript-сервера  ------------------------------------------------------------------

//?Вызов: СтартСерверТранслятора (Joomla=Ложь, ЗадержкаВOneScript1=1000, ЗадержкаВPHPСервере1=1000, ЗадержкаВJSКлиенте1=2000)
//?Параметры: Joomla - для Joomla или нет, Задержка - задержки в микросекундах между запросами.
//?Описание: Создает страницу клиента и запускает сервер-транслятор запросов к внешнему серверу и передачи ответов от него клиенту
//?Поиск: PHP Сервер  
Функция СтартСерверТранслятора(Joomla=Ложь,ЗадержкаВOneScript1=1000,ЗадержкаВPHPСервере1=1000,ЗадержкаВJSКлиенте1=2000) экспорт 
   ИнициализацияСерверТранслятора(ЗадержкаВOneScript1,ЗадержкаВPHPСервере1,ЗадержкаВJSКлиенте1);
   СерверТранслятор(Joomla,ЗадержкаВPHPСервере1);
   КлиентБазовыйШаблон(ЗадержкаВJSКлиенте1);
КонецФункции

//?Вызов: ОбработчикЗапросов(Каталог)
//?Параметры: Каталог - Каталог временных файлов обмена с PHP-сервером транслятором.
//?Описание: Заносит значимые запросы от PHP-сервера в массив на обработку и корректирует список активных клиентов 
//?Поиск: OneScript Сервер  
Функция ОбработчикЗапросов(Каталог) экспорт 
   ДобавитьЗапросыОтPHPСервера(Каталог);
   счКонец = МассивЗапросовОтКлиентов.Количество()-1;
   Для сч=0 По счКонец Цикл
	 M=СтрРазделить(МассивЗапросовОтКлиентов[счКонец-сч],"==>");  // если запрос не пустой, то запоминаем
	 Если M.Количество()>4 Тогда  МассивОтложенныхЗапросовОтКлиентов.Добавить(МассивЗапросовОтКлиентов[счКонец-сч]); 
	 ИначеЕсли M.Количество()<5 Тогда МассивОтветовКлиентам_Добавить(M[0]); КонецЕсли;
	 ДобавитьВСписокАктивныхКлиентов(M,МассивАктивныхКлиентов);
   КонецЦикла;
   МассивЗапросовОтКлиентов.Очистить();
   ОтправитьОтветыВPHPСервер(Каталог);
КонецФункции


//?Вызов:  Строка_СформироватьКомандыКлиенту (Строка,Разделитель="||")
//?Параметры: Строка - строка с элементами команд, элементы разделены символом Разделитель
//?Описание: Формирует строку команд для клиента, которую посылает сервер 
//?Поиск: OneScript Сервер Клиент 
Функция Строка_СформироватьКомандыКлиенту(Строка,Разделитель="||") экспорт 
  М=СтрРазделить(Строка,Разделитель);  Строка2="==>vv==>ListCommand";
  Для сч=0 По М.Количество()-1 Цикл
     Строка2=Строка2+"==>"+М[сч];
  КонецЦикла;
  Возврат Строка2+"==>";
КонецФункции

//?Вызов:  МассивОтветовКлиентам_Добавить (КодКлиента,ОтветСервера="")
//?Параметры: КодКлиента,  ОтветСервера=""
//?Описание: Добавляет ответ клиенту
//?Поиск: OneScript Сервер Клиент 
Функция МассивОтветовКлиентам_Добавить(КодКлиента,ОтветСервера="") экспорт 
   Для сч=0 По МассивОтветовКлиентам.Количество()-1 Цикл
      Если СтрНачинаетсяС(МассивОтветовКлиентам[сч],КодКлиента) Тогда 
	     МассивОтветовКлиентам[сч]=МассивОтветовКлиентам[сч]+ОтветСервера; Возврат Истина;
	  КонецЕсли;	 
   КонецЦикла;
   МассивОтветовКлиентам.Добавить(КодКлиента+ОтветСервера); Возврат Истина;
КонецФункции

//?Вызов:  ОтладкаСерверТранслятора()
//?Параметры: Отсутствуют.
//?Описание: Показывает содержимое массивов:  МассивАктивныхКлиентов, МассивОтложенныхЗапросовОтКлиентов, МассивОтветовКлиентам
//?Поиск: OneScript Сервер  
Функция ОтладкаСерверТранслятора() экспорт 
    Сообщить("--------- Активные клиенты ---------------------------");
    Для сч=0 По МассивАктивныхКлиентов.Количество()-1 Цикл
	               // Код соединения                  Имя клиента                           Время соединения               Время последнего выхода на связь
      Сообщить(МассивАктивныхКлиентов[сч][0]+" - "+МассивАктивныхКлиентов[сч][2]+" - "+МассивАктивныхКлиентов[сч][4]+" - "+МассивАктивныхКлиентов[сч][5]+
	    " - "+МассивАктивныхКлиентов[сч][6] );
    КонецЦикла;    
    Сообщить("--------- МассивОтложенныхЗапросовОтКлиентов ---------------------------");
    Для сч=0 По МассивОтложенныхЗапросовОтКлиентов.Количество()-1 Цикл
      Сообщить(МассивОтложенныхЗапросовОтКлиентов[сч]);
    КонецЦикла;    
    Сообщить("--------- МассивОтветовКлиентам ---------------------------");
    Для сч=0 По МассивОтветовКлиентам.Количество()-1 Цикл
      Сообщить(МассивОтветовКлиентам[сч]);
    КонецЦикла;    
    Сообщить("========================================================================");
    Сообщить(" ");
КонецФункции

Функция ОтправитьОтветыВPHPСервер(Каталог)
   счКонец = МассивОтветовКлиентам.Количество()-1;
   Для сч=0 По счКонец Цикл
     Если сч<МассивОтветовКлиентам.Количество() Тогда
       Строка = МассивОтветовКлиентам[сч];     
       Пока НЕ ОтправитьОтветВPHPСервер(Каталог,Строка) Цикл Приостановить(ЗадержкаВOneScript); КонецЦикла;
	 КонецЕсли;  
   КонецЦикла;
   МассивОтветовКлиентам.Очистить();
КонецФункции

Функция НайтиОтветДляКлиента(КодКлиента,МассивОтветов)
   счКонец = МассивОтветов.Количество()-1;
   Для сч=0 По счКонец Цикл
       Если СтрНачинаетсяС(МассивОтветов[счКонец-сч],КодКлиента) Тогда Стр=МассивОтветов[счКонец-сч]; МассивОтветов.Удалить(счКонец-сч); Возврат Стр; КонецЕсли;
   КонецЦикла;   Возврат "";   // Если ответа для данного клиента нет, то пустая строка
КонецФункции
  
Функция ОтправитьОтветВPHPСервер(Каталог,ОтветОтOneScript);
  Если ОтветОтOneScript="" Тогда Возврат Истина; КонецЕсли;
  Поз = СтрНайти(ОтветОтOneScript,"==>"); 
  Если Поз>0 Тогда Ответ=Сред(ОтветОтOneScript,Поз+3,СтрДлина(ОтветОтOneScript)-Поз-2);
  ИначеЕсли Поз=0 Тогда Поз=СтрДлина(ОтветОтOneScript)+1; КонецЕсли;
  ИмяФайлаСОтветом=Лев(ОтветОтOneScript,Поз-1)+".otv";  
  Файл = Новый Файл(Каталог+ИмяФайлаСОтветом);
  Если НЕ Файл.Существует() Тогда          // Если файла с ответом нет, значит сервер прошлый ответ уже принял
    НайтиОтветДляКлиента(ИмяФайлаСОтветом,МассивОтветовКлиентам);
    Ф = Новый ЗаписьТекста;	Ф.Открыть(Каталог+ИмяФайлаСОтветом); 	Ф.ЗаписатьСтроку(Ответ); 
    Ф.Закрыть();  Возврат Истина;  // Ответ передан PHP-Серверу
  КонецЕсли;
  Возврат Ложь;   //  PHP-Сервер не готов принять ответ, так как предыдущий не принят
КонецФункции

Функция ИнициализацияСерверТранслятора(ЗадержкаВOneScript1=1000,ЗадержкаВPHPСервере1=1000,ЗадержкаВJSКлиенте1=2000) 
  МассивЗапросовОтКлиентов=Новый Массив;
  МассивОтложенныхЗапросовОтКлиентов=Новый Массив;
  МассивОтветовКлиентам=Новый Массив;
  МассивАктивныхКлиентов=Новый Массив;     
  ЗадержкаВOneScript=ЗадержкаВOneScript1;
  ЗадержкаВPHPСервере=ЗадержкаВPHPСервере1;
  ЗадержкаВJSКлиенте=ЗадержкаВJSКлиенте1;
КонецФункции

Функция СерверТранслятор(Joomla,Задержка)
  Запись=НачатьЗаписьСервера(Joomla);
  Каталог=КаталогВременныхФайлов; 
  Запись.ЗаписатьСтроку("<?php "+СтрокаPHP_ФункцииСервера()+      // запрос f=1 - разовое выполнение после загрузки
      СтрокаPHP_СерверВыполнитьКод(1, "$Cod=GeneratePassword(18); echo '==>ListCommand==>id==>InsertCookie==>'.$Cod.'==>username==>InsertCookie==>'.$data;")+ 
      СтрокаPHP_СерверВыполнитьКод(2, "echo ServerOneScript($data,2); ")+   // 
	  "function ServerOneScript($data,$Dop){$pos=strpos($data,'==>');$rest=substr($data,0,$pos);$data=$data.'==>'.$Dop;"+   
	  "$tmpdir='"+Каталог+"';$filename='09'.$rest.'.zap';  usleep_file_exists($tmpdir.$filename); $fp=fopen($tmpdir.$filename,'x'); "+
	  "$rez=fwrite($fp,$data);fclose($fp); $filename=$filename.'.otv'; while (!file_exists($tmpdir.$filename)) {usleep("+Задержка+");}  "+                    
      "$data=readfile($tmpdir.$filename);  deletefile($tmpdir.$filename); return $data;}"+
	  "function usleep_file_exists($filename){while (file_exists($filename)) {usleep("+Задержка+");}} "+
	  "?>");  
  Запись.Закрыть();  
КонецФункции

Функция КлиентБазовыйШаблон(Задержка)
  DivБаза=СоздатьОбъектCSSDiv("baza","Здесь будет страница для пользователя");    DivБаза.Ширина=100; DivБаза.ТипШирина=2;
  Шаблон=СоздатьОбъектHTMLШаблонCSSDiv();   Шаблон.Div(DivБаза);  Шаблон.Инициализация();
  Запись_ОпределениеФункцийAjax();
  Запись_ОпределениеФункцииCallBackRequest("SubCallBackRequest02(request.responseText);");   // alert(request.responseText); 
  Запись_JSКод("function update(){SendRequest('POST','Server.php','f=1&data='+username); "+              //  
	  "setInterval(function(){RegularFunc();},"+Задержка+");} function RegularFunc(){ id=get_cookie('id');username=get_cookie(""username"");"+  
	      "SendRequest('POST','Server.php','f=2&data='+id+'==>'+username);} "+
		  "function PressButton(Nom){SendRequest('POST','Server.php','f=2&data='+id+'==>'+username+'==>'+Nom);}");   
  Запись_ЗапускатьФункцJSПриОбновлении("update");  
  Запись_ОпределениеФункцийCookie();
  Запись_ОпределениеФункцийРегистрация("username","'Здравствуйте, <b>'+username+',</b> добро пожаловать в программу OneScript!'","Изменить имя");
  ПРОЦЕСС_Окончание();
КонецФункции

Функция ДобавитьВСписокАктивныхКлиентов(MЗапрос,МассивАктивных)
   Для сч=0 По МассивАктивных.Количество()-1 Цикл
     Если МассивАктивных[сч][0]=MЗапрос[0] Тогда МассивАктивных[сч][5]=ТекущаяДата(); Возврат Истина; КонецЕсли;
   КонецЦикла;   
   MЗапрос.Добавить(ТекущаяДата());   MЗапрос.Добавить(ТекущаяДата()); 
   MЗапрос.Добавить(0); // 6 - Количество отправленных запросов данному клиенту
   MЗапрос.Добавить(0); // 7 - Код алгоритма загрузки объектов на страницу для клиента
   МассивАктивных.Добавить(MЗапрос);
   Возврат Ложь; 
КонецФункции

Функция ДобавитьЗапросыОтPHPСервера(Каталог) 
  М1=НайтиФайлы(Каталог,"*.zap");   // Файлы с запросами от клиентов
  Для сч=0 По М1.Количество()-1 Цикл
    ДобавитьЗапросОтPHPСервера(Каталог,М1[сч].Имя);     // Добавляем в массив запросов
  КонецЦикла;
КонецФункции

Функция ДобавитьЗапросОтPHPСервера(Каталог,ИмяФайлаСЗапросом)
  М=ЗагрузитьСтрокиИзФайлаВМассив(Каталог+ИмяФайлаСЗапросом);
  МассивЗапросовОтКлиентов.Добавить(ИмяФайлаСЗапросом+"==>"+М[0]);
  УдалитьФайлы(Каталог+ИмяФайлаСЗапросом);
КонецФункции


//---------------------  Функции для OneScript-сервера (конец) ------------------------------------------------------------------


Функция AjaxPHP_СоздатьAjax() экспорт
  Если НЕ ФайлСуществует("xajax_core/xajax.inc.php") Тогда
     Сообщить("Вы не установили библиотеку xajax.inc.php для Ajax."); Возврат Ложь;
  КонецЕсли;
  Строка = "<?php require_once(""xajax_core/xajax.inc.php""); $xajax=new xajax(); ?>";
  Запись.ЗаписатьСтроку(Строка);  Возврат Истина;
КонецФункции

Функция AjaxPHP_РегистрироватьФункцию(Имя,Код) экспорт
  Строка = "<?php $xajax->register(XAJAX_FUNCTION,"""+Имя+"""); function "+Имя+"() "+
    "{ $objResponse=new xajaxResponse(); "+Код+" return $objResponse; } ?> ";
  Запись.ЗаписатьСтроку(Строка);  Возврат Истина;
КонецФункции

Функция СтрокаAjaxPHP_РазрешитьОбработкуАсинхронныхЗапросов() экспорт
  Строка = "<?php $xajax->processRequest(); ?>";  Возврат Строка;
КонецФункции

// установить новое содержимое элемента с id=div1
Функция СтрокаAjaxPHP_УстановитьСодержимое(div1,Свойство,Значение) экспорт
  Строка=" $objResponse->assign("""+div1+""","""+Свойство+""","""+Значение+"""); "; Возврат Строка;
КонецФункции

// Добавить новое содержимое элемента id=div1 в конец
Функция СтрокаAjaxPHP_ДобавитьСодержимоеВКонец(div1,Значение) экспорт
  Строка=" $objResponse->append("""+div1+""",""innerHtml"","""+Значение+"""); "; Возврат Строка;
КонецФункции

// Добавить новое содержимое элемента id=div1 в начало
Функция СтрокаAjaxPHP_ДобавитьСодержимоеВНачало(div1,Значение) экспорт
  Строка=" $objResponse->prepend("""+div1+""",""innerHtml"","""+Значение+"""); "; Возврат Строка;
КонецФункции

// Заменяет подстроку в содержимом элемента id=div1 
Функция СтрокаAjaxPHP_ЗаменитьПодСтроку(div1,Строка,Замена) экспорт
  Строка=" $objResponse->replace("""+div1+""",""innerHtml"","""+Строка+""","""+Замена+"""); "; Возврат Строка;
КонецФункции

// Уничтожает элемент id=div1 
Функция СтрокаAjaxPHP_УдалитьЭлемент(div1,Строка,Замена) экспорт
  Строка=" $objResponse->remove("""+div1+"""); "; Возврат Строка;
КонецФункции

// Создает новый элемент внутри элемента id=div1 
Функция СтрокаAjaxPHP_СоздатьЭлемент(div1,НовыйТег,НовыйId) экспорт
  Строка=" $objResponse->create("""+div1+""","""+НовыйТег+""","""+НовыйId+"""); "; Возврат Строка;
КонецФункции

// Создает новый элемент перед элементом id=div1 
Функция СтрокаAjaxPHP_СоздатьДоЭлемента(div1,НовыйТег,НовыйId) экспорт
  Строка=" $objResponse->insert("""+div1+""","""+НовыйТег+""","""+НовыйId+"""); "; Возврат Строка;
КонецФункции

// Создает новый элемент после элемента id=div1 
Функция СтрокаAjaxPHP_СоздатьПослеЭлемента(div1,НовыйТег,НовыйId) экспорт
  Строка=" $objResponse->insertAfter("""+div1+""","""+НовыйТег+""","""+НовыйId+"""); "; Возврат Строка;
КонецФункции

// Очистить содержимое элемента id=div1 
Функция СтрокаAjaxPHP_ОчиститьЭлемент(div1,Свойство) экспорт
  Строка=" $objResponse->clear("""+div1+""","""+Свойство+"""); "; Возврат Строка;
КонецФункции


